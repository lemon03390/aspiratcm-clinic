(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{3528:function(e,s,a){Promise.resolve().then(a.bind(a,1176))},1176:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var n=a(3827),t=a(4090),l=a(3107);let r=[{name:"前端測試API",url:"/api/v1/test"},{name:"前端測試API (後端連接)",url:"/api/v1/test?endpoint=backend"},{name:"預約API (GET)",url:"/api/v1/appointments"}];function i(){let[e,s]=(0,t.useState)({}),[a,i]=(0,t.useState)({}),[d,c]=(0,t.useState)({}),[o,m]=(0,t.useState)({patient_name:"API測試用戶",phone_number:"12345678",doctor_name:"測試醫師",appointment_time:new Date().toISOString().replace("Z",""),status:"未應診"}),[x,h]=(0,t.useState)(null),[p,u]=(0,t.useState)(""),[b,g]=(0,t.useState)(!1),[j,v]=(0,t.useState)(null);(0,t.useEffect)(()=>{l.Z.get("/api/v1/test").then(e=>{var s;(null===(s=e.data)||void 0===s?void 0:s.config)&&v(e.data.config)}).catch(e=>console.error("無法取得環境配置",e)),r.forEach(e=>{N(e.name,e.url)})},[]);let N=async(e,a)=>{i(s=>({...s,[e]:!0})),c(s=>({...s,[e]:""}));try{let n=await l.Z.get(a);s(s=>({...s,[e]:n.data}))}catch(s){console.error("測試 ".concat(e," 失敗:"),s),c(a=>{var n,t;return{...a,[e]:(null===(t=s.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.detail)||s.message||"未知錯誤"}})}finally{i(s=>({...s,[e]:!1}))}},f=async()=>{g(!0),u(""),h(null);try{let e=await l.Z.post("/api/v1/appointments",o,{headers:{"Content-Type":"application/json","X-Test-Header":"API測試"}});h(e.data)}catch(e){console.error("POST測試失敗:",e),e.response?u("錯誤狀態碼: ".concat(e.response.status,", 訊息: ").concat(JSON.stringify(e.response.data||{}))):e.request?u("未收到伺服器回應，請檢查網絡連接和伺服器狀態"):u(e.message||"未知錯誤")}finally{g(!1)}};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API 測試診斷頁面"}),(0,n.jsxs)("div",{className:"mb-8 bg-white p-4 rounded-lg shadow",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"環境配置"}),j?(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)("pre",{className:"bg-gray-50 p-4 rounded text-sm",children:JSON.stringify(j,null,2)})}):(0,n.jsx)("p",{className:"text-gray-500",children:"載入中..."})]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"GET 測試結果"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(s=>(0,n.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"font-medium",children:s.name}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("span",{className:"text-xs text-gray-500",children:s.url}),(0,n.jsx)("button",{onClick:()=>N(s.name,s.url),className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:a[s.name],children:a[s.name]?"測試中...":"重新測試"})]})]}),a[s.name]?(0,n.jsx)("p",{className:"text-gray-500",children:"測試中..."}):d[s.name]?(0,n.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:(0,n.jsxs)("p",{className:"text-red-700",children:["錯誤: ",d[s.name]]})}):e[s.name]?(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)("pre",{className:"bg-gray-50 p-2 rounded text-xs",children:JSON.stringify(e[s.name],null,2)})}):(0,n.jsx)("p",{className:"text-gray-500",children:"尚未測試"})]},s.name))})]}),(0,n.jsxs)("div",{className:"mb-8 bg-white p-4 rounded-lg shadow",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"POST 測試"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"測試資料:"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)("pre",{className:"bg-gray-50 p-2 rounded text-xs",children:JSON.stringify(o,null,2)})})]}),(0,n.jsx)("div",{className:"flex justify-start",children:(0,n.jsx)("button",{onClick:f,disabled:b,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-green-300",children:b?"測試中...":"POST 測試 /api/v1/appointments"})}),p&&(0,n.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:(0,n.jsxs)("p",{className:"text-red-700",children:["錯誤: ",p]})}),x&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium mb-2",children:"測試結果:"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)("pre",{className:"bg-green-50 p-2 rounded text-xs",children:JSON.stringify(x,null,2)})})]})]})]}),(0,n.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Curl 測試指令"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium mb-2",children:"測試 GET /api/v1/appointments:"}),(0,n.jsx)("div",{className:"bg-gray-800 text-green-400 p-3 rounded overflow-x-auto",children:(0,n.jsx)("code",{children:"curl -X GET /api/v1/appointments"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium mb-2",children:"測試 POST /api/v1/appointments:"}),(0,n.jsx)("div",{className:"bg-gray-800 text-green-400 p-3 rounded overflow-x-auto",children:(0,n.jsx)("code",{dangerouslySetInnerHTML:{__html:'curl -X POST /api/v1/appointments <br/>\n  -H "Content-Type: application/json" <br/>\n  -d \'{"patient_name":"測試患者", "phone_number":"12345678", "appointment_time":"2023-04-01T10:00:00", "doctor_name":"陳醫師"}\'\n'}})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium mb-2",children:"直接測試後端 API:"}),(0,n.jsx)("div",{className:"bg-gray-800 text-green-400 p-3 rounded overflow-x-auto",children:(0,n.jsx)("code",{children:"curl -X GET /api/v1/appointments"})})]})]})]})]})}}},function(e){e.O(0,[107,971,69,744],function(){return e(e.s=3528)}),_N_E=e.O()}]);