(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[647],{304:function(e,s,t){Promise.resolve().then(t.bind(t,3642))},3642:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var r=t(3827),a=t(4090),l=t(3107),n=t(5585);function c(){let[e,s]=(0,a.useState)(null),[t,c]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null),[i,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{c(!0);let e=await l.Z.get("/api/v1/test-api-config");s(e.data.config),d(null)}catch(e){d(e.message||"獲取配置數據失敗"),console.error("獲取配置數據錯誤:",e)}finally{c(!1)}})()},[]);let h=async()=>{try{x(!0);let e=await l.Z.get((0,n.l9)("/doctors"));m({success:!0,message:"連接後端成功",data:e.data,status:e.status})}catch(s){var e;console.error("測試連接失敗:",s),m({success:!1,message:"連接後端失敗",error:s.message,response:null===(e=s.response)||void 0===e?void 0:e.data})}finally{x(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto px-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API 配置測試"}),t?(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,r.jsx)("p",{className:"text-gray-500",children:"正在載入配置數據..."})}):o?(0,r.jsxs)("div",{className:"bg-red-50 p-6 rounded-lg shadow-md border border-red-200",children:[(0,r.jsx)("h2",{className:"text-red-600 font-semibold mb-2",children:"載入失敗"}),(0,r.jsx)("p",{className:"text-red-700",children:o})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"環境變數"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"border rounded-md p-4 bg-gray-50",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"NEXT_PUBLIC_API_BASE_URL"}),(0,r.jsx)("div",{className:"bg-black rounded-md text-green-400 font-mono p-3 text-sm break-all",children:(null==e?void 0:e.processEnv.NEXT_PUBLIC_API_BASE_URL)||"未設置"})]}),(0,r.jsxs)("div",{className:"border rounded-md p-4 bg-gray-50",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"NODE_ENV"}),(0,r.jsx)("div",{className:"bg-black rounded-md text-yellow-400 font-mono p-3 text-sm",children:(null==e?void 0:e.processEnv.NODE_ENV)||"未設置"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"API URL 生成測試"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white rounded-lg",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 border-b",children:[(0,r.jsx)("th",{className:"py-2 px-4 text-left",children:"路徑"}),(0,r.jsx)("th",{className:"py-2 px-4 text-left",children:"生成的 URL"})]})}),(0,r.jsx)("tbody",{children:e&&Object.entries(e.apiUrls).map(e=>{let[s,t]=e;return(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{className:"py-2 px-4 font-mono",children:s}),(0,r.jsx)("td",{className:"py-2 px-4 font-mono text-blue-600 break-all",children:t})]},s)})})]})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"後端連接測試"}),(0,r.jsx)("button",{onClick:h,disabled:u,className:"px-4 py-2 rounded-md text-white ".concat(u?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"),children:u?"測試中...":"測試連接後端"}),i&&(0,r.jsxs)("div",{className:"mt-4 p-4 rounded-md ".concat(i.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,r.jsx)("h3",{className:"font-semibold ".concat(i.success?"text-green-700":"text-red-700"),children:i.message}),i.success?(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("p",{className:"text-green-700",children:["狀態碼: ",i.status]}),(0,r.jsxs)("details",{className:"mt-2",children:[(0,r.jsx)("summary",{className:"cursor-pointer text-green-800 hover:text-green-600",children:"顯示返回數據"}),(0,r.jsx)("pre",{className:"mt-2 p-3 bg-black text-green-400 rounded-md overflow-auto text-xs",children:JSON.stringify(i.data,null,2)})]})]}):(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("p",{className:"text-red-700",children:["錯誤: ",i.error]}),i.response&&(0,r.jsxs)("details",{className:"mt-2",children:[(0,r.jsx)("summary",{className:"cursor-pointer text-red-800 hover:text-red-600",children:"顯示錯誤詳情"}),(0,r.jsx)("pre",{className:"mt-2 p-3 bg-black text-red-400 rounded-md overflow-auto text-xs",children:JSON.stringify(i.response,null,2)})]})]})]})]})]})]})})}},5585:function(e,s,t){"use strict";t.d(s,{l9:function(){return a}});var r=t(3107);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=e.startsWith("/")?e:"/".concat(e);return"".concat("https://clinic.aspiratcm.com/api/v1").concat(s)},l=r.Z.create({baseURL:a(),headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3});l.interceptors.request.use(e=>{var s;if(console.log("[API請求] ".concat(null===(s=e.method)||void 0===s?void 0:s.toUpperCase()," ").concat(e.url)),e.params&&console.log("[請求參數] ".concat(JSON.stringify(e.params))),e.data&&"string"!=typeof e.data)try{console.log("[請求數據] ".concat(JSON.stringify(e.data)))}catch(e){console.log("[請求數據] 無法序列化")}return e},e=>(console.error("[API請求錯誤]",e),Promise.reject(e))),l.interceptors.response.use(e=>(console.log("[API響應] ".concat(e.status," ").concat(e.config.url)),e),e=>{var s,t,r,a;let l=null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.status,n=null==e?void 0:null===(t=e.config)||void 0===t?void 0:t.url,c=null==e?void 0:null===(a=e.config)||void 0===a?void 0:null===(r=a.method)||void 0===r?void 0:r.toUpperCase();return l?console.error("[".concat(c," ").concat(n,"] 錯誤 ").concat(l),e.response.data):console.error("[API錯誤]",e.message),Promise.reject(e)})}},function(e){e.O(0,[107,971,69,744],function(){return e(e.s=304)}),_N_E=e.O()}]);