(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[140],{6909:function(e,t,s){Promise.resolve().then(s.bind(s,2427))},2427:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(3827),a=s(4090),n=s(3107);let l=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}),i=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}),d=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}),c=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}),o=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}),m=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}),u=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}),x=[{key:"modern_chinese_disease_name",title:"現代病名",description:"現代疾病名稱對照表"},{key:"cm_syndrome",title:"中醫辨證",description:"中醫辨證分類及描述"},{key:"tcm_treatment_rule",title:"中醫治則",description:"中醫治療原則"},{key:"tcm_treatment_method",title:"中醫療法",description:"中醫治療方法"},{key:"tcm_single_herb",title:"中藥資料",description:"中藥單方資料庫"}];function h(){let[e,t]=(0,a.useState)("modern_chinese_disease_name"),[s,h]=(0,a.useState)([]),[p,b]=(0,a.useState)(!1),[g,y]=(0,a.useState)(""),[f,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(null),[N,k]=(0,a.useState)(new Set(["modern_chinese_disease_name"])),[_,E]=(0,a.useState)({visible:!1,id:null}),[C,L]=(0,a.useState)({category:"modern_chinese_disease_name",name:"",aliases:""}),S=async e=>{b(!0);try{let t=await n.Z.get("/api/v1/settings/".concat(e).concat(g?"?search=".concat(g):""));h(t.data)}catch(e){console.error("讀取設定失敗:",e),O("無法讀取設定資料","error")}finally{b(!1)}},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=document.createElement("div");s.className="fixed top-4 right-4 p-4 rounded-md z-50 ".concat("success"===t?"bg-green-500":"bg-red-500"," text-white transition-opacity duration-500"),s.textContent=e,document.body.appendChild(s),setTimeout(()=>{s.style.opacity="0",setTimeout(()=>document.body.removeChild(s),500)},3e3)};(0,a.useEffect)(()=>{N.has(e)&&S(e)},[e,g,N]);let B=e=>{t(e),L({...C,category:e})},R=e=>{let t=new Set(N);t.has(e)?t.delete(e):(t.add(e),B(e)),k(t)},W=(e,t)=>{L({...C,[e]:t})},M=async t=>{if(t.preventDefault(),!C.name)return O("名稱為必填項","error");b(!0);try{w?(await n.Z.put("/api/v1/settings/".concat(e,"/").concat(w.id),C),O("設定已更新")):(await n.Z.post("/api/v1/settings/".concat(e),C),O("設定已新增")),S(e),j(!1),z()}catch(e){console.error("儲存設定失敗:",e),O("無法儲存設定","error")}finally{b(!1)}},Z=async e=>{E({visible:!0,id:e})},A=async()=>{if(_.id){b(!0);try{await n.Z.delete("/api/v1/settings/".concat(e,"/").concat(_.id)),O("設定已刪除"),S(e)}catch(e){console.error("刪除設定失敗:",e),O("無法刪除設定","error")}finally{b(!1),E({visible:!1,id:null})}}},F=e=>{v(e),L({category:e.category,name:e.name,aliases:e.aliases||"",parent_id:e.parent_id}),j(!0)},T=()=>{z(),j(!0)},z=()=>{v(null),L({category:e,name:"",aliases:"",parent_id:void 0})};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"TCM 參考資料管理"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"管理中醫辨證、病名、治則等參考資料"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y(new FormData(e.currentTarget).get("search"))},className:"flex max-w-lg",children:[(0,r.jsx)("input",{type:"search",name:"search",placeholder:"搜尋設定...",className:"flex-grow px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700",children:"搜尋"})]})}),(0,r.jsx)("div",{className:"space-y-4",children:x.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 cursor-pointer",onClick:()=>R(e.key),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[N.has(e.key)?(0,r.jsx)(l,{className:"h-5 w-5 mr-2"}):(0,r.jsx)(i,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-medium",children:e.title})]}),(0,r.jsxs)("button",{type:"button",className:"flex items-center px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700",onClick:t=>{t.stopPropagation(),B(e.key),T()},children:[(0,r.jsx)(d,{className:"h-4 w-4 mr-1"}),"新增",e.title]})]}),N.has(e.key)&&(0,r.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"bg-white rounded-md shadow-sm",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,r.jsx)("p",{className:"text-gray-700",children:e.description}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["總計: ",s.length," 筆資料"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{type:"button",className:"flex items-center px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50",children:[(0,r.jsx)(c,{className:"h-4 w-4 mr-1"}),"匯出 JSON"]}),(0,r.jsxs)("button",{type:"button",className:"flex items-center px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50",children:[(0,r.jsx)(o,{className:"h-4 w-4 mr-1"}),"匯入 JSON"]})]})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:p?(0,r.jsx)("div",{className:"flex justify-center items-center p-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-700"})}):(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"代碼"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"名稱"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"別名"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"操作"})]})}),(0,r.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[s.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.code||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.aliases?(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:e.aliases.split(",").map((e,t)=>(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:e.trim()},t))}):"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{onClick:()=>F(e),className:"text-blue-600 hover:text-blue-900",title:"編輯",children:(0,r.jsx)(m,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>Z(e.id),className:"text-red-600 hover:text-red-900",title:"刪除",children:(0,r.jsx)(u,{className:"h-5 w-5"})})]})})]},e.id)),0===s.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-8 text-center text-sm text-gray-500",children:"沒有資料"})})]})]})})]})})]},e.key))}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:w?"編輯設定":"新增設定"}),(0,r.jsxs)("button",{type:"button",onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-500",children:[(0,r.jsx)("span",{className:"sr-only",children:"關閉"}),"\xd7"]})]}),(0,r.jsxs)("form",{onSubmit:M,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["名稱 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"name",type:"text",value:C.name,onChange:e=>W("name",e.target.value),placeholder:"輸入名稱（必填）",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"aliases",className:"block text-sm font-medium text-gray-700 mb-1",children:"別名（逗號分隔）"}),(0,r.jsx)("input",{id:"aliases",type:"text",value:C.aliases,onChange:e=>W("aliases",e.target.value),placeholder:"輸入別名，多個請用逗號分隔",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"parent_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"上級類別"}),(0,r.jsxs)("select",{id:"parent_id",value:C.parent_id||"",onChange:e=>W("parent_id",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"- 無上級類別 -"}),s.filter(e=>e.id!==(null==w?void 0:w.id)).map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:p,children:"取消"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 ".concat(p?"opacity-70 cursor-not-allowed":""),disabled:p,children:p?"處理中...":"確定"})]})]})]})}),_.visible&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"確認刪除"}),(0,r.jsx)("p",{className:"mb-6 text-gray-600",children:"確定要刪除此設定嗎？此操作無法復原。"}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>E({visible:!1,id:null}),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:p,children:"取消"}),(0,r.jsx)("button",{type:"button",onClick:A,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 ".concat(p?"opacity-70 cursor-not-allowed":""),disabled:p,children:p?"處理中...":"確定刪除"})]})]})})]})}}},function(e){e.O(0,[107,971,69,744],function(){return e(e.s=6909)}),_N_E=e.O()}]);