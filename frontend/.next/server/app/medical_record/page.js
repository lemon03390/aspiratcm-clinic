(()=>{var e={};e.id=8142,e.ids=[8142],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},98201:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>c});var n=r(50482),o=r(69108),s=r(62563),a=r.n(s),i=r(68300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["medical_record",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,37244)),"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/medical_record/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,3794)),"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/medical_record/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61334)),"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/medical_record/page.tsx"],d="/medical_record/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/medical_record/page",pathname:"/medical_record",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},13654:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,26840,23)),Promise.resolve().then(r.t.bind(r,38771,23)),Promise.resolve().then(r.t.bind(r,13225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,43982,23))},77721:(e,t,r)=>{Promise.resolve().then(r.bind(r,85927))},89551:(e,t,r)=>{Promise.resolve().then(r.bind(r,29058))},35303:()=>{},34998:(e,t,r)=>{"use strict";var n=r(99619),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};function l(e){return n.isMemo(e)?a:i[e.$$typeof]||o}i[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i[n.Memo]=a;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(f){var o=m(r);o&&o!==f&&e(t,o,n)}var a=u(r);d&&(a=a.concat(d(r)));for(var i=l(t),h=l(r),g=0;g<a.length;++g){var b=a[g];if(!s[b]&&!(n&&n[b])&&!(h&&h[b])&&!(i&&i[b])){var v=p(r,b);try{c(t,b,v)}catch(e){}}}}return t}},46377:(e,t,r)=>{"use strict";var n=r(67598).Symbol;e.exports=n},65945:(e,t,r)=>{"use strict";var n=r(46377),o=r(51370),s=r(33517),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):s(e)}},62894:(e,t,r)=>{"use strict";var n=r(69575),o=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e}},22335:e=>{"use strict";var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},51370:(e,t,r)=>{"use strict";var n=r(46377),o=Object.prototype,s=o.hasOwnProperty,a=o.toString,i=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,i),r=e[i];try{e[i]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[i]=r:delete e[i]),o}},33517:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},67598:(e,t,r)=>{"use strict";var n=r(22335),o="object"==typeof self&&self&&self.Object===Object&&self,s=n||o||Function("return this")();e.exports=s},69575:e=>{"use strict";var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},63908:(e,t,r)=>{"use strict";var n=r(60986),o=r(120),s=r(29155),a=Math.max,i=Math.min;e.exports=function(e,t,r){var l,c,u,d,p,m,f=0,h=!1,g=!1,b=!0;if("function"!=typeof e)throw TypeError("Expected a function");function v(t){var r=l,n=c;return l=c=void 0,f=t,d=e.apply(n,r)}function y(e){var r=e-m,n=e-f;return void 0===m||r>=t||r<0||g&&n>=u}function x(){var e,r,n,s=o();if(y(s))return _(s);p=setTimeout(x,(e=s-m,r=s-f,n=t-e,g?i(n,u-r):n))}function _(e){return(p=void 0,b&&l)?v(e):(l=c=void 0,d)}function w(){var e,r=o(),n=y(r);if(l=arguments,c=this,m=r,n){if(void 0===p)return f=e=m,p=setTimeout(x,t),h?v(e):d;if(g)return clearTimeout(p),p=setTimeout(x,t),v(m)}return void 0===p&&(p=setTimeout(x,t)),d}return t=s(t)||0,n(r)&&(h=!!r.leading,u=(g="maxWait"in r)?a(s(r.maxWait)||0,t):u,b="trailing"in r?!!r.trailing:b),w.cancel=function(){void 0!==p&&clearTimeout(p),f=0,l=m=c=p=void 0},w.flush=function(){return void 0===p?d:_(o())},w}},60986:e=>{"use strict";e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},12111:e=>{"use strict";e.exports=function(e){return null!=e&&"object"==typeof e}},56381:(e,t,r)=>{"use strict";var n=r(65945),o=r(12111);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},120:(e,t,r)=>{"use strict";var n=r(67598);e.exports=function(){return n.Date.now()}},29155:(e,t,r)=>{"use strict";var n=r(62894),o=r(60986),s=r(56381),a=0/0,i=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return a;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=l.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):i.test(e)?a:+e}},41864:(e,t)=>{"use strict";/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,i=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,m=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,h=r?Symbol.for("react.memo"):60115,g=r?Symbol.for("react.lazy"):60116,b=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,x=r?Symbol.for("react.scope"):60119;function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case d:case s:case i:case a:case m:return e;default:switch(e=e&&e.$$typeof){case c:case p:case g:case h:case l:return e;default:return t}}case o:return t}}}function w(e){return _(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=p,t.Fragment=s,t.Lazy=g,t.Memo=h,t.Portal=o,t.Profiler=i,t.StrictMode=a,t.Suspense=m,t.isAsyncMode=function(e){return w(e)||_(e)===u},t.isConcurrentMode=w,t.isContextConsumer=function(e){return _(e)===c},t.isContextProvider=function(e){return _(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return _(e)===p},t.isFragment=function(e){return _(e)===s},t.isLazy=function(e){return _(e)===g},t.isMemo=function(e){return _(e)===h},t.isPortal=function(e){return _(e)===o},t.isProfiler=function(e){return _(e)===i},t.isStrictMode=function(e){return _(e)===a},t.isSuspense=function(e){return _(e)===m},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===d||e===i||e===a||e===m||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===h||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===v||e.$$typeof===y||e.$$typeof===x||e.$$typeof===b)},t.typeOf=_},99619:(e,t,r)=>{"use strict";e.exports=r(41864)},85927:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(95344),o=r(56506),s=r(8428);function a(){let e=(0,s.usePathname)();return n.jsx("nav",{className:"bg-white shadow-md",children:n.jsx("div",{className:"container mx-auto px-4",children:(0,n.jsxs)("div",{className:"flex justify-between h-16",children:[n.jsx("div",{className:"flex items-center",children:n.jsx(o.default,{href:"/dashboard",children:(0,n.jsxs)("div",{className:"flex items-center",children:[n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-blue-600 mr-2",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"})}),n.jsx("span",{className:"font-bold text-lg text-gray-800",children:"診所管理系統"})]})})}),n.jsx("div",{className:"flex space-x-4",children:[{href:"/dashboard",label:"儀表板"},{href:"/appointments",label:"預約管理"},{href:"/member",label:"診所會員"},{href:"/patient_registration",label:"患者登記"},{href:"/medical_record",label:"病歷系統"},{href:"/admin/settings",label:"設定管理"}].map(t=>n.jsx(o.default,{href:t.href,className:`inline-flex items-center px-3 py-2 border-b-2 text-sm font-medium leading-5 transition duration-150 ease-in-out ${e===t.href?"border-blue-500 text-blue-600 focus:outline-none focus:border-blue-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300"}`,children:t.label},t.href))})]})})})}},29058:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>nX});var n,o,s,a,i=r(95344),l=r(3729),c=r.n(l);let u={data:""},d=e=>e||u,p=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,m=/\/\*[^]*?\*\/|  +/g,f=/\n+/g,h=(e,t)=>{let r="",n="",o="";for(let s in e){let a=e[s];"@"==s[0]?"i"==s[1]?r=s+" "+a+";":n+="f"==s[1]?h(a,s):s+"{"+h(a,"k"==s[1]?"":t)+"}":"object"==typeof a?n+=h(a,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=a&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),o+=h.p?h.p(s,a):s+":"+a+";")}return r+(t&&o?t+"{"+o+"}":o)+n},g={},b=e=>{if("object"==typeof e){let t="";for(let r in e)t+=r+b(e[r]);return t}return e},v=(e,t,r,n,o)=>{let s=b(e),a=g[s]||(g[s]=(e=>{let t=0,r=11;for(;t<e.length;)r=101*r+e.charCodeAt(t++)>>>0;return"go"+r})(s));if(!g[a]){let t=s!==e?e:(e=>{let t,r,n=[{}];for(;t=p.exec(e.replace(m,""));)t[4]?n.shift():t[3]?(r=t[3].replace(f," ").trim(),n.unshift(n[0][r]=n[0][r]||{})):n[0][t[1]]=t[2].replace(f," ").trim();return n[0]})(e);g[a]=h(o?{["@keyframes "+a]:t}:t,r?"":"."+a)}let i=r&&g.g?g.g:null;return r&&(g.g=g[a]),((e,t,r,n)=>{n?t.data=t.data.replace(n,e):-1===t.data.indexOf(e)&&(t.data=r?e+t.data:t.data+e)})(g[a],t,n,i),a},y=(e,t,r)=>e.reduce((e,n,o)=>{let s=t[o];if(s&&s.call){let e=s(r),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":h(e,""):!1===e?"":e}return e+n+(null==s?"":s)},"");function x(e){let t=this||{},r=e.call?e(t.p):e;return v(r.unshift?r.raw?y(r,[].slice.call(arguments,1),t.p):r.reduce((e,r)=>Object.assign(e,r&&r.call?r(t.p):r),{}):r,d(t.target),t.g,t.o,t.k)}x.bind({g:1});let _,w,j,N=x.bind({k:1});function O(e,t){let r=this||{};return function(){let n=arguments;function o(s,a){let i=Object.assign({},s),l=i.className||o.className;r.p=Object.assign({theme:w&&w()},i),r.o=/ *go\d+/.test(l),i.className=x.apply(r,n)+(l?" "+l:""),t&&(i.ref=a);let c=e;return e[0]&&(c=i.as||e,delete i.as),j&&c[0]&&j(i),_(c,i)}return t?t(o):o}}var S=e=>"function"==typeof e,C=(e,t)=>S(e)?e(t):e,P=(()=>{let e=0;return()=>(++e).toString()})(),I=((()=>{let e;return()=>e})(),(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:r}=t;return I(e,{type:e.toasts.find(e=>e.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let o=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+o}))}}}),M=[],k={toasts:[],pausedAt:void 0},D=e=>{k=I(k,e),M.forEach(e=>{e(k)})},$={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},A=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(null==r?void 0:r.id)||P()}),E=e=>(t,r)=>{let n=A(t,e,r);return D({type:2,toast:n}),n.id},L=(e,t)=>E("blank")(e,t);L.error=E("error"),L.success=E("success"),L.loading=E("loading"),L.custom=E("custom"),L.dismiss=e=>{D({type:3,toastId:e})},L.remove=e=>D({type:4,toastId:e}),L.promise=(e,t,r)=>{let n=L.loading(t.loading,{...r,...null==r?void 0:r.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let o=t.success?C(t.success,e):void 0;return o?L.success(o,{id:n,...r,...null==r?void 0:r.success}):L.dismiss(n),e}).catch(e=>{let o=t.error?C(t.error,e):void 0;o?L.error(o,{id:n,...r,...null==r?void 0:r.error}):L.dismiss(n)}),e};var V=new Map,R=1e3,F=N`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,T=N`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,H=N`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,U=(O("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${F} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${T} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${H} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,N`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`),z=(O("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${U} 1s linear infinite;
`,N`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`),q=N`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,B=(O("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${z} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${q} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,O("div")`
  position: absolute;
`,O("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,N`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`);O("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${B} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,O("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,O("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,n=l.createElement,h.p=void 0,_=n,w=void 0,j=void 0,x`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;let W=({isFirstTime:e=0,isTroublesome:t=0,isContagious:r=0,specialNote:n})=>(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 my-1",children:[1===e&&i.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-md bg-blue-100 text-blue-800",children:"初診"}),1===t&&i.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-md bg-orange-100 text-orange-800",children:"⚠️ 特殊情況"}),1===r&&i.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-md bg-red-100 text-red-800",children:"⚠️ 傳染病風險"}),n&&(0,i.jsxs)("span",{className:"px-2 py-1 text-xs font-medium rounded-md bg-yellow-100 text-yellow-800 max-w-xs truncate",title:n,children:["\uD83D\uDCDD ",n]})]}),J=({isTroublesome:e=0,isContagious:t=0,specialNote:r="",onUpdate:n})=>{let[o,s]=(0,l.useState)(1===e),[a,c]=(0,l.useState)(1===t),[u,d]=(0,l.useState)(r||"");return(0,i.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow",children:[i.jsx("h3",{className:"text-lg font-medium mb-4",children:"特殊患者標記"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[i.jsx("input",{type:"checkbox",id:"troublesome",checked:o,onChange:e=>s(e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),i.jsx("label",{htmlFor:"troublesome",className:"ml-2 text-sm font-medium text-gray-700",children:"特殊情況患者"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"contagious",checked:a,onChange:e=>c(e.target.checked),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),i.jsx("label",{htmlFor:"contagious",className:"ml-2 text-sm font-medium text-gray-700",children:"傳染病風險"})]})]}),(0,i.jsxs)("div",{className:"mb-4",children:[i.jsx("label",{htmlFor:"specialNote",className:"block text-sm font-medium text-gray-700 mb-1",children:"特殊註記"}),i.jsx("textarea",{id:"specialNote",value:u,onChange:e=>d(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"輸入特殊情況註記..."})]}),i.jsx("button",{type:"button",onClick:()=>{n({is_troublesome:o?1:0,is_contagious:a?1:0,special_note:u})},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"更新標記"})]})},G=(0,l.createContext)(null),Y={didCatch:!1,error:null};class Z extends l.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Y}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,r,n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];null===(t=(r=this.props).onReset)||void 0===t||t.call(r,{args:o,reason:"imperative-api"}),this.setState(Y)}}componentDidCatch(e,t){var r,n;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t)}componentDidUpdate(e,t){let{didCatch:r}=this.state,{resetKeys:n}=this.props;if(r&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,r)=>!Object.is(e,t[r]))}(e.resetKeys,n)){var o,s;null===(o=(s=this.props).onReset)||void 0===o||o.call(s,{next:n,prev:e.resetKeys,reason:"keys"}),this.setState(Y)}}render(){let{children:e,fallbackRender:t,FallbackComponent:r,fallback:n}=this.props,{didCatch:o,error:s}=this.state,a=e;if(o){let e={error:s,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)a=t(e);else if(r)a=(0,l.createElement)(r,e);else if(void 0!==n)a=n;else throw s}return(0,l.createElement)(G.Provider,{value:{didCatch:o,error:s,resetErrorBoundary:this.resetErrorBoundary}},a)}}let X=e=>{if(!e||!Array.isArray(e)||0===e.length)return[];let t=new Map,r=[];e.forEach(e=>{let n={label:e.name+(e.notes?` （${e.notes}）`:""),value:e.code,notes:e.notes,originalName:e.name,isAlias:!1},o=e.category_name||"未分類";o&&"未分類"!==o?(t.has(o)||t.set(o,[]),t.get(o)?.push(n)):r.push(n),e.aliases&&e.aliases.length>0&&e.aliases.forEach(n=>{let s={label:`${n} (又名: ${e.name})`+(e.notes?` （${e.notes}）`:""),value:e.code,notes:e.notes,originalName:e.name,isAlias:!0};o&&"未分類"!==o?t.get(o)?.push(s):r.push(s)})});let n=[];if(Array.from(t.keys()).sort().forEach(e=>{let r=t.get(e)||[];if(r.length>0){let t=r.sort((e,t)=>e.label.localeCompare(t.label,"zh-Hant"));n.push({label:e,options:t})}}),r.length>0){let e=r.sort((e,t)=>e.label.localeCompare(t.label,"zh-Hant"));n.push({label:"未分類",options:e})}return n},K=e=>{if(!e||!Array.isArray(e)||0===e.length)return[];let t=[];return e.forEach(e=>{t.push({label:e.name+(e.notes?` （${e.notes}）`:""),value:e.code,notes:e.notes,originalName:e.name,isAlias:!1,category:e.category_name,categoryCode:e.category_code,parent:e.parent}),e.aliases&&e.aliases.length>0&&e.aliases.forEach(r=>{t.push({label:`${r} (又名: ${e.name})`+(e.notes?` （${e.notes}）`:""),value:e.code,notes:e.notes,originalName:e.name,isAlias:!0,category:e.category_name,categoryCode:e.category_code,parent:e.parent})})}),t.sort((e,t)=>e.label.localeCompare(t.label,"zh-Hant"))},Q=(e,t,r)=>{if(!e||e.length<2)return r;let n=e.toLowerCase(),o=t.filter(e=>{let t=e.label.toLowerCase().includes(n),r=!!e.notes&&e.notes.toLowerCase().includes(n),o=!!e.originalName&&e.originalName.toLowerCase().includes(n);return t||r||o}),s=new Set(o.map(e=>e.value));return r.map(e=>{let t=e.options.filter(e=>s.has(e.value));return t.length>0?{label:e.label,options:t}:null}).filter(Boolean)},ee=e=>({groupedOptions:X(e),searchableList:K(e)}),et=async()=>{try{let e=await fetch("/data/modern_chinese_disease_name.json");if(!e.ok)throw Error("Failed to load modern diseases data");return await e.json()}catch(e){return console.error("Error loading modern diseases data:",e),[]}},er=async()=>{try{let e=await fetch("/data/tcm_codes_fung_version_full.json");if(!e.ok)throw Error("Failed to load TCM syndromes data");return await e.json()}catch(e){return console.error("Error loading TCM syndromes data:",e),[]}},en=async()=>{try{let e=await fetch("/data/tcm_treatment_rule.json");if(!e.ok)throw Error("Failed to load TCM principles data");return await e.json()}catch(e){return console.error("Error loading TCM principles data:",e),[]}},eo=async()=>{let[e,t,r]=await Promise.all([et(),er(),en()]);return{modernDiseases:ee(e),cmSyndromes:ee(t),cmPrinciples:ee(r)}};function es(e){return(es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ea(e){var t=function(e,t){if("object"!=es(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=es(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==es(t)?t:t+""}function ei(e,t,r){return(t=ea(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function el(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ec(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?el(Object(r),!0).forEach(function(t){ei(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):el(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eu(){return(eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}var ed=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){if(this.ctr%(this.isSpeedy?65e3:1)==0){var t;this._insertTag(((t=document.createElement("style")).setAttribute("data-emotion",this.key),void 0!==this.nonce&&t.setAttribute("nonce",this.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t))}var r=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(r);try{n.insertRule(e,n.cssRules.length)}catch(e){}}else r.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),ep=Math.abs,em=String.fromCharCode,ef=Object.assign;function eh(e,t,r){return e.replace(t,r)}function eg(e,t){return e.indexOf(t)}function eb(e,t){return 0|e.charCodeAt(t)}function ev(e,t,r){return e.slice(t,r)}function ey(e){return e.length}function ex(e,t){return t.push(e),e}var e_=1,ew=1,ej=0,eN=0,eO=0,eS="";function eC(e,t,r,n,o,s,a){return{value:e,root:t,parent:r,type:n,props:o,children:s,line:e_,column:ew,length:a,return:""}}function eP(e,t){return ef(eC("",null,null,"",null,null,0),e,{length:-e.length},t)}function eI(){return eO=eN<ej?eb(eS,eN++):0,ew++,10===eO&&(ew=1,e_++),eO}function eM(){return eb(eS,eN)}function ek(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function eD(e){return e_=ew=1,ej=ey(eS=e),eN=0,[]}function e$(e){var t,r;return(t=eN-1,r=function e(t){for(;eI();)switch(eO){case t:return eN;case 34:case 39:34!==t&&39!==t&&e(eO);break;case 40:41===t&&e(t);break;case 92:eI()}return eN}(91===e?e+2:40===e?e+1:e),ev(eS,t,r)).trim()}var eA="-ms-",eE="-moz-",eL="-webkit-",eV="comm",eR="rule",eF="decl",eT="@keyframes";function eH(e,t){for(var r="",n=e.length,o=0;o<n;o++)r+=t(e[o],o,e,t)||"";return r}function eU(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case eF:return e.return=e.return||e.value;case eV:return"";case eT:return e.return=e.value+"{"+eH(e.children,n)+"}";case eR:e.value=e.props.join(",")}return ey(r=eH(e.children,n))?e.return=e.value+"{"+r+"}":""}function ez(e){var t=e.length;return function(r,n,o,s){for(var a="",i=0;i<t;i++)a+=e[i](r,n,o,s)||"";return a}}function eq(e){var t;return t=function e(t,r,n,o,s,a,i,l,c){for(var u,d=0,p=0,m=i,f=0,h=0,g=0,b=1,v=1,y=1,x=0,_="",w=s,j=a,N=o,O=_;v;)switch(g=x,x=eI()){case 40:if(108!=g&&58==eb(O,m-1)){-1!=eg(O+=eh(e$(x),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:O+=e$(x);break;case 9:case 10:case 13:case 32:O+=function(e){for(;eO=eM();)if(eO<33)eI();else break;return ek(e)>2||ek(eO)>3?"":" "}(g);break;case 92:O+=function(e,t){for(var r;--t&&eI()&&!(eO<48)&&!(eO>102)&&(!(eO>57)||!(eO<65))&&(!(eO>70)||!(eO<97)););return r=eN+(t<6&&32==eM()&&32==eI()),ev(eS,e,r)}(eN-1,7);continue;case 47:switch(eM()){case 42:case 47:ex(eC(u=function(e,t){for(;eI();)if(e+eO===57)break;else if(e+eO===84&&47===eM())break;return"/*"+ev(eS,t,eN-1)+"*"+em(47===e?e:eI())}(eI(),eN),r,n,eV,em(eO),ev(u,2,-2),0),c);break;default:O+="/"}break;case 123*b:l[d++]=ey(O)*y;case 125*b:case 59:case 0:switch(x){case 0:case 125:v=0;case 59+p:-1==y&&(O=eh(O,/\f/g,"")),h>0&&ey(O)-m&&ex(h>32?eW(O+";",o,n,m-1):eW(eh(O," ","")+";",o,n,m-2),c);break;case 59:O+=";";default:if(ex(N=eB(O,r,n,d,p,s,l,_,w=[],j=[],m),a),123===x){if(0===p)e(O,r,N,N,w,a,m,l,j);else switch(99===f&&110===eb(O,3)?100:f){case 100:case 108:case 109:case 115:e(t,N,N,o&&ex(eB(t,N,N,0,0,s,l,_,s,w=[],m),j),s,j,m,l,o?w:j);break;default:e(O,N,N,N,[""],j,0,l,j)}}}d=p=h=0,b=y=1,_=O="",m=i;break;case 58:m=1+ey(O),h=g;default:if(b<1){if(123==x)--b;else if(125==x&&0==b++&&125==(eO=eN>0?eb(eS,--eN):0,ew--,10===eO&&(ew=1,e_--),eO))continue}switch(O+=em(x),x*b){case 38:y=p>0?1:(O+="\f",-1);break;case 44:l[d++]=(ey(O)-1)*y,y=1;break;case 64:45===eM()&&(O+=e$(eI())),f=eM(),p=m=ey(_=O+=function(e){for(;!ek(eM());)eI();return ev(eS,e,eN)}(eN)),x++;break;case 45:45===g&&2==ey(O)&&(b=0)}}return a}("",null,null,null,[""],e=eD(e),0,[0],e),eS="",t}function eB(e,t,r,n,o,s,a,i,l,c,u){for(var d=o-1,p=0===o?s:[""],m=p.length,f=0,h=0,g=0;f<n;++f)for(var b=0,v=ev(e,d+1,d=ep(h=a[f])),y=e;b<m;++b)(y=(h>0?p[b]+" "+v:eh(v,/&\f/g,p[b])).trim())&&(l[g++]=y);return eC(e,t,r,0===o?eR:i,l,c,u)}function eW(e,t,r,n){return eC(e,t,r,eF,ev(e,0,n),ev(e,n+1,-1),n)}function eJ(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var eG="undefined"!=typeof document,eY=function(e,t,r){for(var n=0,o=0;n=o,o=eM(),38===n&&12===o&&(t[r]=1),!ek(o);)eI();return ev(eS,e,eN)},eZ=function(e,t){var r=-1,n=44;do switch(ek(n)){case 0:38===n&&12===eM()&&(t[r]=1),e[r]+=eY(eN-1,t,r);break;case 2:e[r]+=e$(n);break;case 4:if(44===n){e[++r]=58===eM()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=em(n)}while(n=eI());return e},eX=function(e,t){var r;return r=eZ(eD(e),t),eS="",r},eK=new WeakMap,eQ=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||eK.get(r))&&!n){eK.set(e,!0);for(var o=[],s=eX(t,o),a=r.props,i=0,l=0;i<s.length;i++)for(var c=0;c<a.length;c++,l++)e.props[l]=o[i]?s[i].replace(/&\f/g,a[c]):a[c]+" "+s[i]}}},e0=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},e1=eG?void 0:function(e){var t=new WeakMap;return function(r){if(t.has(r))return t.get(r);var n=e(r);return t.set(r,n),n}}(function(){return eJ(function(){return{}})}),e2=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case eF:e.return=function e(t,r){switch(45^eb(t,0)?(((r<<2^eb(t,0))<<2^eb(t,1))<<2^eb(t,2))<<2^eb(t,3):0){case 5103:return eL+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return eL+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return eL+t+eE+t+eA+t+t;case 6828:case 4268:return eL+t+eA+t+t;case 6165:return eL+t+eA+"flex-"+t+t;case 5187:return eL+t+eh(t,/(\w+).+(:[^]+)/,eL+"box-$1$2"+eA+"flex-$1$2")+t;case 5443:return eL+t+eA+"flex-item-"+eh(t,/flex-|-self/,"")+t;case 4675:return eL+t+eA+"flex-line-pack"+eh(t,/align-content|flex-|-self/,"")+t;case 5548:return eL+t+eA+eh(t,"shrink","negative")+t;case 5292:return eL+t+eA+eh(t,"basis","preferred-size")+t;case 6060:return eL+"box-"+eh(t,"-grow","")+eL+t+eA+eh(t,"grow","positive")+t;case 4554:return eL+eh(t,/([^-])(transform)/g,"$1"+eL+"$2")+t;case 6187:return eh(eh(eh(t,/(zoom-|grab)/,eL+"$1"),/(image-set)/,eL+"$1"),t,"")+t;case 5495:case 3959:return eh(t,/(image-set\([^]*)/,eL+"$1$`$1");case 4968:return eh(eh(t,/(.+:)(flex-)?(.*)/,eL+"box-pack:$3"+eA+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+eL+t+t;case 4095:case 3583:case 4068:case 2532:return eh(t,/(.+)-inline(.+)/,eL+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ey(t)-1-r>6)switch(eb(t,r+1)){case 109:if(45!==eb(t,r+4))break;case 102:return eh(t,/(.+:)(.+)-([^]+)/,"$1"+eL+"$2-$3$1"+eE+(108==eb(t,r+3)?"$3":"$2-$3"))+t;case 115:return~eg(t,"stretch")?e(eh(t,"stretch","fill-available"),r)+t:t}break;case 4949:if(115!==eb(t,r+1))break;case 6444:switch(eb(t,ey(t)-3-(~eg(t,"!important")&&10))){case 107:return eh(t,":",":"+eL)+t;case 101:return eh(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+eL+(45===eb(t,14)?"inline-":"")+"box$3$1"+eL+"$2$3$1"+eA+"$2box$3")+t}break;case 5936:switch(eb(t,r+11)){case 114:return eL+t+eA+eh(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return eL+t+eA+eh(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return eL+t+eA+eh(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return eL+t+eA+t+t}return t}(e.value,e.length);break;case eT:return eH([eP(e,{value:eh(e.value,"@","@"+eL)})],n);case eR:if(e.length)return e.props.map(function(t){var r;switch(r=t,(r=/(::plac\w+|:read-\w+)/.exec(r))?r[0]:r){case":read-only":case":read-write":return eH([eP(e,{props:[eh(t,/:(read-\w+)/,":"+eE+"$1")]})],n);case"::placeholder":return eH([eP(e,{props:[eh(t,/:(plac\w+)/,":"+eL+"input-$1")]}),eP(e,{props:[eh(t,/:(plac\w+)/,":"+eE+"$1")]}),eP(e,{props:[eh(t,/:(plac\w+)/,eA+"input-$1")]})],n)}return""}).join("")}}],e5=function(e){var t=e.key;if(eG&&"css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var n=e.stylisPlugins||e2,o={},s=[];eG&&(d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)o[t[r]]=!0;s.push(e)}));var a=[eQ,e0];if(e1){var i=ez(a.concat(n,[eU])),l=e1(n)(t),c=function(e,t){var r=t.name;return void 0===l[r]&&(l[r]=eH(eq(e?e+"{"+t.styles+"}":t.styles),i)),l[r]};p=function(e,t,r,n){var o=t.name,s=c(e,t);return void 0===g.compat?(n&&(g.inserted[o]=!0),s):n?void(g.inserted[o]=s):s}}else{var u,d,p,m,f=[eU,(u=function(e){m.insert(e)},function(e){!e.root&&(e=e.return)&&u(e)})],h=ez(a.concat(n,f));p=function(e,t,r,n){m=r,eH(eq(e?e+"{"+t.styles+"}":t.styles),h),n&&(g.inserted[t.name]=!0)}}var g={key:t,sheet:new ed({key:t,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:p};return g.sheet.hydrate(s),g},e3="undefined"!=typeof document,e4=function(e,t,r){var n=e.key+"-"+t.name;(!1===r||!1===e3&&void 0!==e.compat)&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},e6=function(e,t,r){e4(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",s=t;do{var a=e.insert(t===s?"."+n:"",s,e.sheet,!0);e3||void 0===a||(o+=a),s=s.next}while(void 0!==s);if(!e3&&0!==o.length)return o}},e7={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},e8=/[A-Z]|^ms/g,e9=/_EMO_([^_]+?)_([^]*?)_EMO_/g,te=function(e){return 45===e.charCodeAt(1)},tt=function(e){return null!=e&&"boolean"!=typeof e},tr=eJ(function(e){return te(e)?e:e.replace(e8,"-$&").toLowerCase()}),tn=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(e9,function(e,t,r){return o={name:t,styles:r,next:o},t})}return 1===e7[e]||te(e)||"number"!=typeof t||0===t?t:t+"px"};function to(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return o={name:r.name,styles:r.styles,next:o},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)o={name:n.name,styles:n.styles,next:o},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var o=0;o<r.length;o++)n+=to(e,t,r[o])+";";else for(var s in r){var a=r[s];if("object"!=typeof a)null!=t&&void 0!==t[a]?n+=s+"{"+t[a]+"}":tt(a)&&(n+=tr(s)+":"+tn(s,a)+";");else if(Array.isArray(a)&&"string"==typeof a[0]&&(null==t||void 0===t[a[0]]))for(var i=0;i<a.length;i++)tt(a[i])&&(n+=tr(s)+":"+tn(s,a[i])+";");else{var l=to(e,t,a);switch(s){case"animation":case"animationName":n+=tr(s)+":"+l+";";break;default:n+=s+"{"+l+"}"}}}return n}(e,t,r);case"function":if(void 0!==e){var s=o,a=r(e);return o=s,to(e,t,a)}}if(null==t)return r;var i=t[r];return void 0!==i?i:r}var ts=/label:\s*([^\s;{]+)\s*(;|$)/g;function ta(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n,s=!0,a="";o=void 0;var i=e[0];null==i||void 0===i.raw?(s=!1,a+=to(r,t,i)):a+=i[0];for(var l=1;l<e.length;l++)a+=to(r,t,e[l]),s&&(a+=i[l]);ts.lastIndex=0;for(var c="";null!==(n=ts.exec(a));)c+="-"+n[1];return{name:function(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))*1540483477+((t>>>16)*59797<<16),t^=t>>>24,r=(65535&t)*1540483477+((t>>>16)*59797<<16)^(65535&r)*1540483477+((r>>>16)*59797<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r^=255&e.charCodeAt(n),r=(65535&r)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,(((r=(65535&r)*1540483477+((r>>>16)*59797<<16))^r>>>15)>>>0).toString(36)}(a)+c,styles:a,next:o}}var ti="undefined"!=typeof document,tl=!!l.useInsertionEffect&&l.useInsertionEffect,tc=ti&&tl||function(e){return e()};tl||l.useLayoutEffect;var tu="undefined"!=typeof document,td=l.createContext("undefined"!=typeof HTMLElement?e5({key:"css"}):null);td.Provider;var tp=function(e){return(0,l.forwardRef)(function(t,r){return e(t,(0,l.useContext)(td),r)})};tu||(tp=function(e){return function(t){var r=(0,l.useContext)(td);return null===r?(r=e5({key:"css"}),l.createElement(td.Provider,{value:r},e(t,r))):e(t,r)}});var tm=l.createContext({}),tf={}.hasOwnProperty,th="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",tg=function(e,t){var r={};for(var n in t)tf.call(t,n)&&(r[n]=t[n]);return r[th]=e,r},tb=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;e4(t,r,n);var o=tc(function(){return e6(t,r,n)});if(!tu&&void 0!==o){for(var s,a=r.name,i=r.next;void 0!==i;)a+=" "+i.name,i=i.next;return l.createElement("style",((s={})["data-emotion"]=t.key+" "+a,s.dangerouslySetInnerHTML={__html:o},s.nonce=t.sheet.nonce,s))}return null},tv=tp(function(e,t,r){var n,o,s,a=e.css;"string"==typeof a&&void 0!==t.registered[a]&&(a=t.registered[a]);var i=e[th],c=[a],u="";"string"==typeof e.className?(n=t.registered,o=e.className,s="",o.split(" ").forEach(function(e){void 0!==n[e]?c.push(n[e]+";"):e&&(s+=e+" ")}),u=s):null!=e.className&&(u=e.className+" ");var d=ta(c,void 0,l.useContext(tm));u+=t.key+"-"+d.name;var p={};for(var m in e)tf.call(e,m)&&"css"!==m&&m!==th&&(p[m]=e[m]);return p.className=u,r&&(p.ref=r),l.createElement(l.Fragment,null,l.createElement(tb,{cache:t,serialized:d,isStringTag:"string"==typeof i}),l.createElement(i,p))});r(47821),r(34998);var ty=function(e,t){var r=arguments;if(null==t||!tf.call(t,"css"))return l.createElement.apply(void 0,r);var n=r.length,o=Array(n);o[0]=tv,o[1]=tg(e,t);for(var s=2;s<n;s++)o[s]=r[s];return l.createElement.apply(null,o)};function tx(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ta(t)}function t_(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function tw(e,t){if(e){if("string"==typeof e)return t_(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t_(e,t):void 0}}function tj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,s,a,i=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(e,t)||tw(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tN(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(ty||(ty={}));var tO=r(81202),tS=r(58951),tC="undefined"!=typeof document?l.useLayoutEffect:l.useEffect,tP=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],tI=function(){};function tM(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var s=[].concat(n);if(t&&e)for(var a in t)t.hasOwnProperty(a)&&t[a]&&s.push("".concat(a?"-"===a[0]?e+a:e+"__"+a:e));return s.filter(function(e){return e}).map(function(e){return String(e).trim()}).join(" ")}var tk=function(e){return Array.isArray(e)?e.filter(Boolean):"object"===es(e)&&null!==e?[e]:[]},tD=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,ec({},tN(e,tP))},t$=function(e,t,r){var n=e.cx,o=e.getStyles,s=e.getClassNames,a=e.className;return{css:o(t,e),className:n(null!=r?r:{},s(t,e),a)}};function tA(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function tE(e){return tA(e)?window.pageYOffset:e.scrollTop}function tL(e,t){if(tA(e)){window.scrollTo(0,t);return}e.scrollTop=t}function tV(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tI,o=tE(e),s=t-o,a=0;!function t(){var i;a+=10,tL(e,s*((i=(i=a)/r-1)*i*i+1)+o),a<r?window.requestAnimationFrame(t):n(e)}()}function tR(e,t){var r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=t.offsetHeight/3;n.bottom+o>r.bottom?tL(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+o,e.scrollHeight)):n.top-o<r.top&&tL(e,Math.max(t.offsetTop-o,0))}function tF(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}var tT=!1,tH={};tH.addEventListener&&tH.removeEventListener&&(tH.addEventListener("p",tI,{get passive(){return tT=!0}}),tH.removeEventListener("p",tI,!1));var tU=tT;function tz(e){return null!=e}var tq=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Object.entries(e).filter(function(e){var t=tj(e,1)[0];return!r.includes(t)}).reduce(function(e,t){var r=tj(t,2),n=r[0],o=r[1];return e[n]=o,e},{})},tB=["children","innerProps"],tW=["children","innerProps"],tJ=function(e){return"auto"===e?"bottom":e},tG=(0,l.createContext)(null),tY=function(e){var t=e.children,r=e.minMenuHeight,n=e.maxMenuHeight,o=e.menuPlacement,s=e.menuPosition,a=e.menuShouldScrollIntoView,i=e.theme,c=((0,l.useContext)(tG)||{}).setPortalPlacement,u=(0,l.useRef)(null),d=tj((0,l.useState)(n),2),p=d[0],m=d[1],f=tj((0,l.useState)(null),2),h=f[0],g=f[1],b=i.spacing.controlHeight;return tC(function(){var e=u.current;if(e){var t="fixed"===s,i=function(e){var t=e.maxHeight,r=e.menuEl,n=e.minHeight,o=e.placement,s=e.shouldScroll,a=e.isFixedPosition,i=e.controlHeight,l=function(e){var t=getComputedStyle(e),r="absolute"===t.position,n=/(auto|scroll)/;if("fixed"===t.position)return document.documentElement;for(var o=e;o=o.parentElement;)if(t=getComputedStyle(o),(!r||"static"!==t.position)&&n.test(t.overflow+t.overflowY+t.overflowX))return o;return document.documentElement}(r),c={placement:"bottom",maxHeight:t};if(!r||!r.offsetParent)return c;var u=l.getBoundingClientRect().height,d=r.getBoundingClientRect(),p=d.bottom,m=d.height,f=d.top,h=r.offsetParent.getBoundingClientRect().top,g=a?window.innerHeight:tA(l)?window.innerHeight:l.clientHeight,b=tE(l),v=parseInt(getComputedStyle(r).marginBottom,10),y=parseInt(getComputedStyle(r).marginTop,10),x=h-y,_=g-f,w=x+b,j=u-b-f,N=p-g+b+v,O=b+f-y;switch(o){case"auto":case"bottom":if(_>=m)return{placement:"bottom",maxHeight:t};if(j>=m&&!a)return s&&tV(l,N,160),{placement:"bottom",maxHeight:t};if(!a&&j>=n||a&&_>=n)return s&&tV(l,N,160),{placement:"bottom",maxHeight:a?_-v:j-v};if("auto"===o||a){var S=t,C=a?x:w;return C>=n&&(S=Math.min(C-v-i,t)),{placement:"top",maxHeight:S}}if("bottom"===o)return s&&tL(l,N),{placement:"bottom",maxHeight:t};break;case"top":if(x>=m)return{placement:"top",maxHeight:t};if(w>=m&&!a)return s&&tV(l,O,160),{placement:"top",maxHeight:t};if(!a&&w>=n||a&&x>=n){var P=t;return(!a&&w>=n||a&&x>=n)&&(P=a?x-y:w-y),s&&tV(l,O,160),{placement:"top",maxHeight:P}}return{placement:"bottom",maxHeight:t};default:throw Error('Invalid placement provided "'.concat(o,'".'))}return c}({maxHeight:n,menuEl:e,minHeight:r,placement:o,shouldScroll:a&&!t,isFixedPosition:t,controlHeight:b});m(i.maxHeight),g(i.placement),null==c||c(i.placement)}},[n,o,s,a,r,c,b]),t({ref:u,placerProps:ec(ec({},e),{},{placement:h||tJ(o),maxHeight:p})})},tZ=function(e,t){var r=e.theme,n=r.spacing.baseUnit,o=r.colors;return ec({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(2*n,"px ").concat(3*n,"px")})},tX=["size"],tK=["innerProps","isRtl","size"],tQ={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},t0=function(e){var t=e.size,r=tN(e,tX);return ty("svg",eu({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:tQ},r))},t1=function(e){return ty(t0,eu({size:20},e),ty("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},t2=function(e){return ty(t0,eu({size:20},e),ty("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},t5=function(e,t){var r=e.isFocused,n=e.theme,o=n.spacing.baseUnit,s=n.colors;return ec({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?s.neutral60:s.neutral20,padding:2*o,":hover":{color:r?s.neutral80:s.neutral40}})},t3=function(){var e=tx.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(s||(s=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"]))),t4=function(e){var t=e.delay,r=e.offset;return ty("span",{css:tx({animation:"".concat(t3," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},t6=["data"],t7=["innerRef","isDisabled","isHidden","inputClassName"],t8={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},t9={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":ec({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},t8)},re=function(e){var t=e.children,r=e.innerProps;return ty("div",r,t)},rt={ClearIndicator:function(e){var t=e.children,r=e.innerProps;return ty("div",eu({},t$(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||ty(t1,null))},Control:function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,o=e.innerRef,s=e.innerProps,a=e.menuIsOpen;return ty("div",eu({ref:o},t$(e,"control",{control:!0,"control--is-disabled":r,"control--is-focused":n,"control--menu-is-open":a}),s,{"aria-disabled":r||void 0}),t)},DropdownIndicator:function(e){var t=e.children,r=e.innerProps;return ty("div",eu({},t$(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||ty(t2,null))},DownChevron:t2,CrossIcon:t1,Group:function(e){var t=e.children,r=e.cx,n=e.getStyles,o=e.getClassNames,s=e.Heading,a=e.headingProps,i=e.innerProps,l=e.label,c=e.theme,u=e.selectProps;return ty("div",eu({},t$(e,"group",{group:!0}),i),ty(s,eu({},a,{selectProps:u,theme:c,getStyles:n,getClassNames:o,cx:r}),l),ty("div",null,t))},GroupHeading:function(e){var t=tD(e);t.data;var r=tN(t,t6);return ty("div",eu({},t$(e,"groupHeading",{"group-heading":!0}),r))},IndicatorsContainer:function(e){var t=e.children,r=e.innerProps;return ty("div",eu({},t$(e,"indicatorsContainer",{indicators:!0}),r),t)},IndicatorSeparator:function(e){var t=e.innerProps;return ty("span",eu({},t,t$(e,"indicatorSeparator",{"indicator-separator":!0})))},Input:function(e){var t=e.cx,r=e.value,n=tD(e),o=n.innerRef,s=n.isDisabled,a=n.isHidden,i=n.inputClassName,l=tN(n,t7);return ty("div",eu({},t$(e,"input",{"input-container":!0}),{"data-value":r||""}),ty("input",eu({className:t({input:!0},i),ref:o,style:ec({label:"input",color:"inherit",background:0,opacity:a?0:1,width:"100%"},t8),disabled:s},l)))},LoadingIndicator:function(e){var t=e.innerProps,r=e.isRtl,n=e.size,o=tN(e,tK);return ty("div",eu({},t$(ec(ec({},o),{},{innerProps:t,isRtl:r,size:void 0===n?4:n}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),ty(t4,{delay:0,offset:r}),ty(t4,{delay:160,offset:!0}),ty(t4,{delay:320,offset:!r}))},Menu:function(e){var t=e.children,r=e.innerRef,n=e.innerProps;return ty("div",eu({},t$(e,"menu",{menu:!0}),{ref:r},n),t)},MenuList:function(e){var t=e.children,r=e.innerProps,n=e.innerRef,o=e.isMulti;return ty("div",eu({},t$(e,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:n},r),t)},MenuPortal:function(e){var t=e.appendTo,r=e.children,n=e.controlElement,o=e.innerProps,s=e.menuPlacement,a=e.menuPosition,i=(0,l.useRef)(null),c=(0,l.useRef)(null),u=tj((0,l.useState)(tJ(s)),2),d=u[0],p=u[1],m=(0,l.useMemo)(function(){return{setPortalPlacement:p}},[]),f=tj((0,l.useState)(null),2),h=f[0],g=f[1],b=(0,l.useCallback)(function(){if(n){var e,t={bottom:(e=n.getBoundingClientRect()).bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width},r="fixed"===a?0:window.pageYOffset,o=t[d]+r;(o!==(null==h?void 0:h.offset)||t.left!==(null==h?void 0:h.rect.left)||t.width!==(null==h?void 0:h.rect.width))&&g({offset:o,rect:t})}},[n,a,d,null==h?void 0:h.offset,null==h?void 0:h.rect.left,null==h?void 0:h.rect.width]);tC(function(){b()},[b]);var v=(0,l.useCallback)(function(){"function"==typeof c.current&&(c.current(),c.current=null),n&&i.current&&(c.current=(0,tS.Me)(n,i.current,b,{elementResize:"ResizeObserver"in window}))},[n,b]);tC(function(){v()},[v]);var y=(0,l.useCallback)(function(e){i.current=e,v()},[v]);if(!t&&"fixed"!==a||!h)return null;var x=ty("div",eu({ref:y},t$(ec(ec({},e),{},{offset:h.offset,position:a,rect:h.rect}),"menuPortal",{"menu-portal":!0}),o),r);return ty(tG.Provider,{value:m},t?(0,tO.createPortal)(x,t):x)},LoadingMessage:function(e){var t=e.children,r=void 0===t?"Loading...":t,n=e.innerProps,o=tN(e,tW);return ty("div",eu({},t$(ec(ec({},o),{},{children:r,innerProps:n}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),r)},NoOptionsMessage:function(e){var t=e.children,r=void 0===t?"No options":t,n=e.innerProps,o=tN(e,tB);return ty("div",eu({},t$(ec(ec({},o),{},{children:r,innerProps:n}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),r)},MultiValue:function(e){var t=e.children,r=e.components,n=e.data,o=e.innerProps,s=e.isDisabled,a=e.removeProps,i=e.selectProps,l=r.Container,c=r.Label,u=r.Remove;return ty(l,{data:n,innerProps:ec(ec({},t$(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":s})),o),selectProps:i},ty(c,{data:n,innerProps:ec({},t$(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:i},t),ty(u,{data:n,innerProps:ec(ec({},t$(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},a),selectProps:i}))},MultiValueContainer:re,MultiValueLabel:re,MultiValueRemove:function(e){var t=e.children,r=e.innerProps;return ty("div",eu({role:"button"},r),t||ty(t1,{size:14}))},Option:function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,o=e.isSelected,s=e.innerRef,a=e.innerProps;return ty("div",eu({},t$(e,"option",{option:!0,"option--is-disabled":r,"option--is-focused":n,"option--is-selected":o}),{ref:s,"aria-disabled":r},a),t)},Placeholder:function(e){var t=e.children,r=e.innerProps;return ty("div",eu({},t$(e,"placeholder",{placeholder:!0}),r),t)},SelectContainer:function(e){var t=e.children,r=e.innerProps,n=e.isDisabled,o=e.isRtl;return ty("div",eu({},t$(e,"container",{"--is-disabled":n,"--is-rtl":o}),r),t)},SingleValue:function(e){var t=e.children,r=e.isDisabled,n=e.innerProps;return ty("div",eu({},t$(e,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),n),t)},ValueContainer:function(e){var t=e.children,r=e.innerProps,n=e.isMulti,o=e.hasValue;return ty("div",eu({},t$(e,"valueContainer",{"value-container":!0,"value-container--is-multi":n,"value-container--has-value":o}),r),t)}},rr=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function rn(e){var t=e.defaultInputValue,r=e.defaultMenuIsOpen,n=e.defaultValue,o=e.inputValue,s=e.menuIsOpen,a=e.onChange,i=e.onInputChange,c=e.onMenuClose,u=e.onMenuOpen,d=e.value,p=tN(e,rr),m=tj((0,l.useState)(void 0!==o?o:void 0===t?"":t),2),f=m[0],h=m[1],g=tj((0,l.useState)(void 0!==s?s:void 0!==r&&r),2),b=g[0],v=g[1],y=tj((0,l.useState)(void 0!==d?d:void 0===n?null:n),2),x=y[0],_=y[1],w=(0,l.useCallback)(function(e,t){"function"==typeof a&&a(e,t),_(e)},[a]),j=(0,l.useCallback)(function(e,t){var r;"function"==typeof i&&(r=i(e,t)),h(void 0!==r?r:e)},[i]),N=(0,l.useCallback)(function(){"function"==typeof u&&u(),v(!0)},[u]),O=(0,l.useCallback)(function(){"function"==typeof c&&c(),v(!1)},[c]),S=void 0!==o?o:f,C=void 0!==s?s:b,P=void 0!==d?d:x;return ec(ec({},p),{},{inputValue:S,menuIsOpen:C,onChange:w,onInputChange:j,onMenuClose:O,onMenuOpen:N,value:P})}function ro(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ea(n.key),n)}}function rs(e,t){return(rs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ra(e){return(ra=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ri(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ri=function(){return!!e})()}function rl(e){return function(e){if(Array.isArray(e))return t_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||tw(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var rc=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function ru(e,t){if(e.length!==t.length)return!1;for(var r,n,o=0;o<e.length;o++)if(!((r=e[o])===(n=t[o])||rc(r)&&rc(n)))return!1;return!0}for(var rd={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},rp=function(e){return ty("span",eu({css:rd},e))},rm={guidance:function(e){var t=e.isSearchable,r=e.isMulti,n=e.tabSelectsValue,o=e.context,s=e.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(n?", press Tab to select the option and exit the menu":"",".");case"input":return s?"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,r=e.label,n=void 0===r?"":r,o=e.labels,s=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return s?"option ".concat(n," is disabled. Select another option."):"option ".concat(n,", selected.");default:return""}},onFocus:function(e){var t=e.context,r=e.focused,n=e.options,o=e.label,s=void 0===o?"":o,a=e.selectValue,i=e.isDisabled,l=e.isSelected,c=e.isAppleDevice,u=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&a)return"value ".concat(s," focused, ").concat(u(a,r),".");if("menu"===t&&c){var d="".concat(l?" selected":"").concat(i?" disabled":"");return"".concat(s).concat(d,", ").concat(u(n,r),".")}return""},onFilter:function(e){var t=e.inputValue,r=e.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},rf=function(e){var t=e.ariaSelection,r=e.focusedOption,n=e.focusedValue,o=e.focusableOptions,s=e.isFocused,a=e.selectValue,i=e.selectProps,c=e.id,u=e.isAppleDevice,d=i.ariaLiveMessages,p=i.getOptionLabel,m=i.inputValue,f=i.isMulti,h=i.isOptionDisabled,g=i.isSearchable,b=i.menuIsOpen,v=i.options,y=i.screenReaderStatus,x=i.tabSelectsValue,_=i.isLoading,w=i["aria-label"],j=i["aria-live"],N=(0,l.useMemo)(function(){return ec(ec({},rm),d||{})},[d]),O=(0,l.useMemo)(function(){var e="";if(t&&N.onChange){var r=t.option,n=t.options,o=t.removedValue,s=t.removedValues,i=t.value,l=o||r||(Array.isArray(i)?null:i),c=l?p(l):"",u=n||s||void 0,d=u?u.map(p):[],m=ec({isDisabled:l&&h(l,a),label:c,labels:d},t);e=N.onChange(m)}return e},[t,N,h,a,p]),S=(0,l.useMemo)(function(){var e="",t=r||n,s=!!(r&&a&&a.includes(r));if(t&&N.onFocus){var i={focused:t,label:p(t),isDisabled:h(t,a),isSelected:s,options:o,context:t===r?"menu":"value",selectValue:a,isAppleDevice:u};e=N.onFocus(i)}return e},[r,n,p,h,N,o,a,u]),C=(0,l.useMemo)(function(){var e="";if(b&&v.length&&!_&&N.onFilter){var t=y({count:o.length});e=N.onFilter({inputValue:m,resultsMessage:t})}return e},[o,m,b,N,v,y,_]),P=(null==t?void 0:t.action)==="initial-input-focus",I=(0,l.useMemo)(function(){var e="";if(N.guidance){var t=n?"value":b?"menu":"input";e=N.guidance({"aria-label":w,context:t,isDisabled:r&&h(r,a),isMulti:f,isSearchable:g,tabSelectsValue:x,isInitialFocus:P})}return e},[w,r,n,f,h,g,b,N,a,x,P]),M=ty(l.Fragment,null,ty("span",{id:"aria-selection"},O),ty("span",{id:"aria-focused"},S),ty("span",{id:"aria-results"},C),ty("span",{id:"aria-guidance"},I));return ty(l.Fragment,null,ty(rp,{id:c},P&&M),ty(rp,{"aria-live":j,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},s&&!P&&M))},rh=[{base:"A",letters:"AⒶＡ\xc0\xc1\xc2ẦẤẪẨ\xc3ĀĂẰẮẴẲȦǠ\xc4ǞẢ\xc5ǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"\xc6ǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČ\xc7ḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥ\xc8\xc9\xcaỀẾỄỂẼĒḔḖĔĖ\xcbẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩ\xcc\xcd\xceĨĪĬİ\xcfḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃ\xd1ṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯ\xd2\xd3\xd4ỒỐỖỔ\xd5ṌȬṎŌṐṒŎȮȰ\xd6ȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬ\xd8ǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵ\xd9\xda\xdbŨṸŪṺŬ\xdcǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲ\xddŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚ\xe0\xe1\xe2ầấẫẩ\xe3āăằắẵẳȧǡ\xe4ǟả\xe5ǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"\xe6ǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċč\xe7ḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅ\xe8\xe9\xeaềếễểẽēḕḗĕė\xebẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉ\xec\xed\xeeĩīĭ\xefḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹń\xf1ṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏ\xf2\xf3\xf4ồốỗổ\xf5ṍȭṏōṑṓŏȯȱ\xf6ȫỏőǒȍȏơờớỡởợọộǫǭ\xf8ǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓ\xdfśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕ\xf9\xfa\xfbũṹūṻŭ\xfcǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳ\xfdŷỹȳẏ\xffỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],rg=RegExp("["+rh.map(function(e){return e.letters}).join("")+"]","g"),rb={},rv=0;rv<rh.length;rv++)for(var ry=rh[rv],rx=0;rx<ry.letters.length;rx++)rb[ry.letters[rx]]=ry.base;var r_=function(e){return e.replace(rg,function(e){return rb[e]})},rw=function(e,t){void 0===t&&(t=ru);var r=null;function n(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(r&&r.lastThis===this&&t(n,r.lastArgs))return r.lastResult;var s=e.apply(this,n);return r={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){r=null},n}(r_),rj=function(e){return e.replace(/^\s+|\s+$/g,"")},rN=function(e){return"".concat(e.label," ").concat(e.value)},rO=["innerRef"];function rS(e){var t=e.innerRef,r=tq(tN(e,rO),"onExited","in","enter","exit","appear");return ty("input",eu({ref:t},r,{css:tx({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var rC=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()},rP=function(e){var t=e.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},rI={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function rM(e){var t,r,n,o,s,a,i,c,u,d,p,m,f,h,g,b,v,y,x,_,w,j,N,O=e.children,S=e.lockEnabled,C=e.captureEnabled,P=(r=(t={isEnabled:void 0===C||C,onBottomArrive:e.onBottomArrive,onBottomLeave:e.onBottomLeave,onTopArrive:e.onTopArrive,onTopLeave:e.onTopLeave}).isEnabled,n=t.onBottomArrive,o=t.onBottomLeave,s=t.onTopArrive,a=t.onTopLeave,i=(0,l.useRef)(!1),c=(0,l.useRef)(!1),u=(0,l.useRef)(0),d=(0,l.useRef)(null),p=(0,l.useCallback)(function(e,t){if(null!==d.current){var r=d.current,l=r.scrollTop,u=r.scrollHeight,p=r.clientHeight,m=d.current,f=t>0,h=u-p-l,g=!1;h>t&&i.current&&(o&&o(e),i.current=!1),f&&c.current&&(a&&a(e),c.current=!1),f&&t>h?(n&&!i.current&&n(e),m.scrollTop=u,g=!0,i.current=!0):!f&&-t>l&&(s&&!c.current&&s(e),m.scrollTop=0,g=!0,c.current=!0),g&&rC(e)}},[n,o,s,a]),m=(0,l.useCallback)(function(e){p(e,e.deltaY)},[p]),f=(0,l.useCallback)(function(e){u.current=e.changedTouches[0].clientY},[]),h=(0,l.useCallback)(function(e){var t=u.current-e.changedTouches[0].clientY;p(e,t)},[p]),g=(0,l.useCallback)(function(e){if(e){var t=!!tU&&{passive:!1};e.addEventListener("wheel",m,t),e.addEventListener("touchstart",f,t),e.addEventListener("touchmove",h,t)}},[h,f,m]),b=(0,l.useCallback)(function(e){e&&(e.removeEventListener("wheel",m,!1),e.removeEventListener("touchstart",f,!1),e.removeEventListener("touchmove",h,!1))},[h,f,m]),(0,l.useEffect)(function(){if(r){var e=d.current;return g(e),function(){b(e)}}},[r,g,b]),function(e){d.current=e}),I=(y=(v={isEnabled:S}).isEnabled,_=void 0===(x=v.accountForScrollbars)||x,(0,l.useRef)({}),w=(0,l.useRef)(null),j=(0,l.useCallback)(function(e){},[_]),N=(0,l.useCallback)(function(e){},[_]),(0,l.useEffect)(function(){if(y){var e=w.current;return j(e),function(){N(e)}}},[y,j,N]),function(e){w.current=e});return ty(l.Fragment,null,S&&ty("div",{onClick:rP,css:rI}),O(function(e){P(e),I(e)}))}var rk={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},rD=function(e){var t=e.name,r=e.onFocus;return ty("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:rk,value:"",onChange:function(){}})};function r$(){return!1}var rA=function(e){return e.label},rE=function(e){return e.value},rL={clearIndicator:t5,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},control:function(e,t){var r=e.isDisabled,n=e.isFocused,o=e.theme,s=o.colors,a=o.borderRadius;return ec({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:o.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?s.neutral5:s.neutral0,borderColor:r?s.neutral10:n?s.primary:s.neutral20,borderRadius:a,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(s.primary):void 0,"&:hover":{borderColor:n?s.primary:s.neutral30}})},dropdownIndicator:t5,group:function(e,t){var r=e.theme.spacing;return t?{}:{paddingBottom:2*r.baseUnit,paddingTop:2*r.baseUnit}},groupHeading:function(e,t){var r=e.theme,n=r.colors,o=r.spacing;return ec({label:"group",cursor:"default",display:"block"},t?{}:{color:n.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*o.baseUnit,paddingRight:3*o.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e,t){var r=e.isDisabled,n=e.theme,o=n.spacing.baseUnit,s=n.colors;return ec({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?s.neutral10:s.neutral20,marginBottom:2*o,marginTop:2*o})},input:function(e,t){var r=e.isDisabled,n=e.value,o=e.theme,s=o.spacing,a=o.colors;return ec(ec({visibility:r?"hidden":"visible",transform:n?"translateZ(0)":""},t9),t?{}:{margin:s.baseUnit/2,paddingBottom:s.baseUnit/2,paddingTop:s.baseUnit/2,color:a.neutral80})},loadingIndicator:function(e,t){var r=e.isFocused,n=e.size,o=e.theme,s=o.colors,a=o.spacing.baseUnit;return ec({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?s.neutral60:s.neutral20,padding:2*a})},loadingMessage:tZ,menu:function(e,t){var r,n=e.placement,o=e.theme,s=o.borderRadius,a=o.spacing,i=o.colors;return ec((ei(r={label:"menu"},n?({bottom:"top",top:"bottom"})[n]:"bottom","100%"),ei(r,"position","absolute"),ei(r,"width","100%"),ei(r,"zIndex",1),r),t?{}:{backgroundColor:i.neutral0,borderRadius:s,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:a.menuGutter,marginTop:a.menuGutter})},menuList:function(e,t){var r=e.maxHeight,n=e.theme.spacing.baseUnit;return ec({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:n,paddingTop:n})},menuPortal:function(e){var t=e.rect,r=e.offset,n=e.position;return{left:t.left,position:n,top:r,width:t.width,zIndex:1}},multiValue:function(e,t){var r=e.theme,n=r.spacing,o=r.borderRadius,s=r.colors;return ec({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:s.neutral10,borderRadius:o/2,margin:n.baseUnit/2})},multiValueLabel:function(e,t){var r=e.theme,n=r.borderRadius,o=r.colors,s=e.cropWithEllipsis;return ec({overflow:"hidden",textOverflow:s||void 0===s?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:n/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(e,t){var r=e.theme,n=r.spacing,o=r.borderRadius,s=r.colors,a=e.isFocused;return ec({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:a?s.dangerLight:void 0,paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:s.dangerLight,color:s.danger}})},noOptionsMessage:tZ,option:function(e,t){var r=e.isDisabled,n=e.isFocused,o=e.isSelected,s=e.theme,a=s.spacing,i=s.colors;return ec({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?i.primary:n?i.primary25:"transparent",color:r?i.neutral20:o?i.neutral0:"inherit",padding:"".concat(2*a.baseUnit,"px ").concat(3*a.baseUnit,"px"),":active":{backgroundColor:r?void 0:o?i.primary:i.primary50}})},placeholder:function(e,t){var r=e.theme,n=r.spacing,o=r.colors;return ec({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2})},singleValue:function(e,t){var r=e.isDisabled,n=e.theme,o=n.spacing,s=n.colors;return ec({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?s.neutral40:s.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},valueContainer:function(e,t){var r=e.theme.spacing,n=e.isMulti,o=e.hasValue,s=e.selectProps.controlShouldRenderValue;return ec({alignItems:"center",display:n&&o&&s?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(2*r.baseUnit,"px")})}},rV={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},rR={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:tF(),captureMenuScroll:!tF(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e,t){if(e.data.__isNew__)return!0;var r=ec({ignoreCase:!0,ignoreAccents:!0,stringify:rN,trim:!0,matchFrom:"any"},void 0),n=r.ignoreCase,o=r.ignoreAccents,s=r.stringify,a=r.trim,i=r.matchFrom,l=a?rj(t):t,c=a?rj(s(e)):s(e);return n&&(l=l.toLowerCase(),c=c.toLowerCase()),o&&(l=rw(l),c=r_(c)),"start"===i?c.substr(0,l.length)===l:c.indexOf(l)>-1},formatGroupLabel:function(e){return e.label},getOptionLabel:rA,getOptionValue:rE,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(e){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function rF(e,t,r,n){var o=rJ(e,t,r),s=rG(e,t,r),a=rB(e,t),i=rW(e,t);return{type:"option",data:t,isDisabled:o,isSelected:s,label:a,value:i,index:n}}function rT(e,t){return e.options.map(function(r,n){if("options"in r){var o=r.options.map(function(r,n){return rF(e,r,t,n)}).filter(function(t){return rz(e,t)});return o.length>0?{type:"group",data:r,options:o,index:n}:void 0}var s=rF(e,r,t,n);return rz(e,s)?s:void 0}).filter(tz)}function rH(e){return e.reduce(function(e,t){return"group"===t.type?e.push.apply(e,rl(t.options.map(function(e){return e.data}))):e.push(t.data),e},[])}function rU(e,t){return e.reduce(function(e,r){return"group"===r.type?e.push.apply(e,rl(r.options.map(function(e){return{data:e.data,id:"".concat(t,"-").concat(r.index,"-").concat(e.index)}}))):e.push({data:r.data,id:"".concat(t,"-").concat(r.index)}),e},[])}function rz(e,t){var r=e.inputValue,n=t.data,o=t.isSelected,s=t.label,a=t.value;return(!rZ(e)||!o)&&rY(e,{label:s,value:a,data:n},void 0===r?"":r)}var rq=function(e,t){var r;return(null===(r=e.find(function(e){return e.data===t}))||void 0===r?void 0:r.id)||null},rB=function(e,t){return e.getOptionLabel(t)},rW=function(e,t){return e.getOptionValue(t)};function rJ(e,t,r){return"function"==typeof e.isOptionDisabled&&e.isOptionDisabled(t,r)}function rG(e,t,r){if(r.indexOf(t)>-1)return!0;if("function"==typeof e.isOptionSelected)return e.isOptionSelected(t,r);var n=rW(e,t);return r.some(function(t){return rW(e,t)===n})}function rY(e,t,r){return!e.filterOption||e.filterOption(t,r)}var rZ=function(e){var t=e.hideSelectedOptions,r=e.isMulti;return void 0===t?r:t},rX=1,rK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rs(e,t)}(s,e);var t,r,n,o=(t=ri(),function(){var e,r=ra(s);if(t){var n=ra(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return function(e,t){if(t&&("object"==es(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){if(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},t.blockOptionHover=!1,t.isComposing=!1,t.commonProps=void 0,t.initialTouchX=0,t.initialTouchY=0,t.openAfterFocus=!1,t.scrollToFocusedOptionOnUpdate=!1,t.userIsDragging=void 0,t.isAppleDevice=!1,t.controlRef=null,t.getControlRef=function(e){t.controlRef=e},t.focusedOptionRef=null,t.getFocusedOptionRef=function(e){t.focusedOptionRef=e},t.menuListRef=null,t.getMenuListRef=function(e){t.menuListRef=e},t.inputRef=null,t.getInputRef=function(e){t.inputRef=e},t.focus=t.focusInput,t.blur=t.blurInput,t.onChange=function(e,r){var n=t.props,o=n.onChange,s=n.name;r.name=s,t.ariaOnChange(e,r),o(e,r)},t.setValue=function(e,r,n){var o=t.props,s=o.closeMenuOnSelect,a=o.isMulti,i=o.inputValue;t.onInputChange("",{action:"set-value",prevInputValue:i}),s&&(t.setState({inputIsHiddenAfterUpdate:!a}),t.onMenuClose()),t.setState({clearFocusValueOnUpdate:!0}),t.onChange(e,{action:r,option:n})},t.selectOption=function(e){var r=t.props,n=r.blurInputOnSelect,o=r.isMulti,s=r.name,a=t.state.selectValue,i=o&&t.isOptionSelected(e,a),l=t.isOptionDisabled(e,a);if(i){var c=t.getOptionValue(e);t.setValue(a.filter(function(e){return t.getOptionValue(e)!==c}),"deselect-option",e)}else if(l){t.ariaOnChange(e,{action:"select-option",option:e,name:s});return}else o?t.setValue([].concat(rl(a),[e]),"select-option",e):t.setValue(e,"select-option");n&&t.blurInput()},t.removeValue=function(e){var r,n=t.props.isMulti,o=t.state.selectValue,s=t.getOptionValue(e),a=o.filter(function(e){return t.getOptionValue(e)!==s}),i=(r=a[0]||null,n?a:r);t.onChange(i,{action:"remove-value",removedValue:e}),t.focusInput()},t.clearValue=function(){var e=t.state.selectValue;t.onChange(t.props.isMulti?[]:null,{action:"clear",removedValues:e})},t.popValue=function(){var e,r=t.props.isMulti,n=t.state.selectValue,o=n[n.length-1],s=n.slice(0,n.length-1),a=(e=s[0]||null,r?s:e);o&&t.onChange(a,{action:"pop-value",removedValue:o})},t.getFocusedOptionId=function(e){return rq(t.state.focusableOptionsWithIds,e)},t.getFocusableOptionsWithIds=function(){return rU(rT(t.props,t.state.selectValue),t.getElementId("option"))},t.getValue=function(){return t.state.selectValue},t.cx=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return tM.apply(void 0,[t.props.classNamePrefix].concat(r))},t.getOptionLabel=function(e){return rB(t.props,e)},t.getOptionValue=function(e){return rW(t.props,e)},t.getStyles=function(e,r){var n=t.props.unstyled,o=rL[e](r,n);o.boxSizing="border-box";var s=t.props.styles[e];return s?s(o,r):o},t.getClassNames=function(e,r){var n,o;return null===(n=(o=t.props.classNames)[e])||void 0===n?void 0:n.call(o,r)},t.getElementId=function(e){return"".concat(t.state.instancePrefix,"-").concat(e)},t.getComponents=function(){var e;return e=t.props,ec(ec({},rt),e.components)},t.buildCategorizedOptions=function(){return rT(t.props,t.state.selectValue)},t.getCategorizedOptions=function(){return t.props.menuIsOpen?t.buildCategorizedOptions():[]},t.buildFocusableOptions=function(){return rH(t.buildCategorizedOptions())},t.getFocusableOptions=function(){return t.props.menuIsOpen?t.buildFocusableOptions():[]},t.ariaOnChange=function(e,r){t.setState({ariaSelection:ec({value:e},r)})},t.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),t.focusInput())},t.onMenuMouseMove=function(e){t.blockOptionHover=!1},t.onControlMouseDown=function(e){if(!e.defaultPrevented){var r=t.props.openMenuOnClick;t.state.isFocused?t.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&t.onMenuClose():r&&t.openMenu("first"):(r&&(t.openAfterFocus=!0),t.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()}},t.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!t.props.isDisabled){var r=t.props,n=r.isMulti,o=r.menuIsOpen;t.focusInput(),o?(t.setState({inputIsHiddenAfterUpdate:!n}),t.onMenuClose()):t.openMenu("first"),e.preventDefault()}},t.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(t.clearValue(),e.preventDefault(),t.openAfterFocus=!1,"touchend"===e.type?t.focusInput():setTimeout(function(){return t.focusInput()}))},t.onScroll=function(e){"boolean"==typeof t.props.closeMenuOnScroll?e.target instanceof HTMLElement&&tA(e.target)&&t.props.onMenuClose():"function"==typeof t.props.closeMenuOnScroll&&t.props.closeMenuOnScroll(e)&&t.props.onMenuClose()},t.onCompositionStart=function(){t.isComposing=!0},t.onCompositionEnd=function(){t.isComposing=!1},t.onTouchStart=function(e){var r=e.touches,n=r&&r.item(0);n&&(t.initialTouchX=n.clientX,t.initialTouchY=n.clientY,t.userIsDragging=!1)},t.onTouchMove=function(e){var r=e.touches,n=r&&r.item(0);if(n){var o=Math.abs(n.clientX-t.initialTouchX),s=Math.abs(n.clientY-t.initialTouchY);t.userIsDragging=o>5||s>5}},t.onTouchEnd=function(e){t.userIsDragging||(t.controlRef&&!t.controlRef.contains(e.target)&&t.menuListRef&&!t.menuListRef.contains(e.target)&&t.blurInput(),t.initialTouchX=0,t.initialTouchY=0)},t.onControlTouchEnd=function(e){t.userIsDragging||t.onControlMouseDown(e)},t.onClearIndicatorTouchEnd=function(e){t.userIsDragging||t.onClearIndicatorMouseDown(e)},t.onDropdownIndicatorTouchEnd=function(e){t.userIsDragging||t.onDropdownIndicatorMouseDown(e)},t.handleInputChange=function(e){var r=t.props.inputValue,n=e.currentTarget.value;t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange(n,{action:"input-change",prevInputValue:r}),t.props.menuIsOpen||t.onMenuOpen()},t.onInputFocus=function(e){t.props.onFocus&&t.props.onFocus(e),t.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(t.openAfterFocus||t.props.openMenuOnFocus)&&t.openMenu("first"),t.openAfterFocus=!1},t.onInputBlur=function(e){var r=t.props.inputValue;if(t.menuListRef&&t.menuListRef.contains(document.activeElement)){t.inputRef.focus();return}t.props.onBlur&&t.props.onBlur(e),t.onInputChange("",{action:"input-blur",prevInputValue:r}),t.onMenuClose(),t.setState({focusedValue:null,isFocused:!1})},t.onOptionHover=function(e){if(!t.blockOptionHover&&t.state.focusedOption!==e){var r=t.getFocusableOptions().indexOf(e);t.setState({focusedOption:e,focusedOptionId:r>-1?t.getFocusedOptionId(e):null})}},t.shouldHideSelectedOptions=function(){return rZ(t.props)},t.onValueInputFocus=function(e){e.preventDefault(),e.stopPropagation(),t.focus()},t.onKeyDown=function(e){var r=t.props,n=r.isMulti,o=r.backspaceRemovesValue,s=r.escapeClearsValue,a=r.inputValue,i=r.isClearable,l=r.isDisabled,c=r.menuIsOpen,u=r.onKeyDown,d=r.tabSelectsValue,p=r.openMenuOnFocus,m=t.state,f=m.focusedOption,h=m.focusedValue,g=m.selectValue;if(!l){if("function"==typeof u&&(u(e),e.defaultPrevented))return;switch(t.blockOptionHover=!0,e.key){case"ArrowLeft":if(!n||a)return;t.focusValue("previous");break;case"ArrowRight":if(!n||a)return;t.focusValue("next");break;case"Delete":case"Backspace":if(a)return;if(h)t.removeValue(h);else{if(!o)return;n?t.popValue():i&&t.clearValue()}break;case"Tab":if(t.isComposing||e.shiftKey||!c||!d||!f||p&&t.isOptionSelected(f,g))return;t.selectOption(f);break;case"Enter":if(229===e.keyCode)break;if(c){if(!f||t.isComposing)return;t.selectOption(f);break}return;case"Escape":c?(t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange("",{action:"menu-close",prevInputValue:a}),t.onMenuClose()):i&&s&&t.clearValue();break;case" ":if(a)return;if(!c){t.openMenu("first");break}if(!f)return;t.selectOption(f);break;case"ArrowUp":c?t.focusOption("up"):t.openMenu("last");break;case"ArrowDown":c?t.focusOption("down"):t.openMenu("first");break;case"PageUp":if(!c)return;t.focusOption("pageup");break;case"PageDown":if(!c)return;t.focusOption("pagedown");break;case"Home":if(!c)return;t.focusOption("first");break;case"End":if(!c)return;t.focusOption("last");break;default:return}e.preventDefault()}},t.state.instancePrefix="react-select-"+(t.props.instanceId||++rX),t.state.selectValue=tk(e.value),e.menuIsOpen&&t.state.selectValue.length){var t,r=t.getFocusableOptionsWithIds(),n=t.buildFocusableOptions(),a=n.indexOf(t.state.selectValue[0]);t.state.focusableOptionsWithIds=r,t.state.focusedOption=n[a],t.state.focusedOptionId=rq(r,n[a])}return t}return r=[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&tR(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.isDisabled,n=t.menuIsOpen,o=this.state.isFocused;(o&&!r&&e.isDisabled||o&&n&&!e.menuIsOpen)&&this.focusInput(),o&&r&&!e.isDisabled?this.setState({isFocused:!1},this.onMenuClose):o||r||!e.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(tR(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,r=this.state,n=r.selectValue,o=r.isFocused,s=this.buildFocusableOptions(),a="first"===e?0:s.length-1;if(!this.props.isMulti){var i=s.indexOf(n[0]);i>-1&&(a=i)}this.scrollToFocusedOptionOnUpdate=!(o&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:s[a],focusedOptionId:this.getFocusedOptionId(s[a])},function(){return t.onMenuOpen()})}},{key:"focusValue",value:function(e){var t=this.state,r=t.selectValue,n=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var o=r.indexOf(n);n||(o=-1);var s=r.length-1,a=-1;if(r.length){switch(e){case"previous":a=0===o?0:-1===o?s:o-1;break;case"next":o>-1&&o<s&&(a=o+1)}this.setState({inputIsHidden:-1!==a,focusedValue:r[a]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,r=this.state.focusedOption,n=this.getFocusableOptions();if(n.length){var o=0,s=n.indexOf(r);r||(s=-1),"up"===e?o=s>0?s-1:n.length-1:"down"===e?o=(s+1)%n.length:"pageup"===e?(o=s-t)<0&&(o=0):"pagedown"===e?(o=s+t)>n.length-1&&(o=n.length-1):"last"===e&&(o=n.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:n[o],focusedValue:null,focusedOptionId:this.getFocusedOptionId(n[o])})}}},{key:"getTheme",value:function(){return this.props.theme?"function"==typeof this.props.theme?this.props.theme(rV):ec(ec({},rV),this.props.theme):rV}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,r=this.getStyles,n=this.getClassNames,o=this.getValue,s=this.selectOption,a=this.setValue,i=this.props,l=i.isMulti,c=i.isRtl,u=i.options;return{clearValue:e,cx:t,getStyles:r,getClassNames:n,getValue:o,hasValue:this.hasValue(),isMulti:l,isRtl:c,options:u,selectOption:s,selectProps:i,setValue:a,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,r=e.isMulti;return void 0===t?r:t}},{key:"isOptionDisabled",value:function(e,t){return rJ(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return rG(this.props,e,t)}},{key:"filterOption",value:function(e,t){return rY(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"!=typeof this.props.formatOptionLabel)return this.getOptionLabel(e);var r=this.props.inputValue,n=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:r,selectValue:n})}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var e=this.props,t=e.isDisabled,r=e.isSearchable,n=e.inputId,o=e.inputValue,s=e.tabIndex,a=e.form,i=e.menuIsOpen,c=e.required,u=this.getComponents().Input,d=this.state,p=d.inputIsHidden,m=d.ariaSelection,f=this.commonProps,h=n||this.getElementId("input"),g=ec(ec(ec({"aria-autocomplete":"list","aria-expanded":i,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":c,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},i&&{"aria-controls":this.getElementId("listbox")}),!r&&{"aria-readonly":!0}),this.hasValue()?(null==m?void 0:m.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return r?l.createElement(u,eu({},f,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:h,innerRef:this.getInputRef,isDisabled:t,isHidden:p,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:s,form:a,type:"text",value:o},g)):l.createElement(rS,eu({id:h,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:tI,onFocus:this.onInputFocus,disabled:t,tabIndex:s,inputMode:"none",form:a,value:""},g))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,t=this.getComponents(),r=t.MultiValue,n=t.MultiValueContainer,o=t.MultiValueLabel,s=t.MultiValueRemove,a=t.SingleValue,i=t.Placeholder,c=this.commonProps,u=this.props,d=u.controlShouldRenderValue,p=u.isDisabled,m=u.isMulti,f=u.inputValue,h=u.placeholder,g=this.state,b=g.selectValue,v=g.focusedValue,y=g.isFocused;if(!this.hasValue()||!d)return f?null:l.createElement(i,eu({},c,{key:"placeholder",isDisabled:p,isFocused:y,innerProps:{id:this.getElementId("placeholder")}}),h);if(m)return b.map(function(t,a){var i=t===v,u="".concat(e.getOptionLabel(t),"-").concat(e.getOptionValue(t));return l.createElement(r,eu({},c,{components:{Container:n,Label:o,Remove:s},isFocused:i,isDisabled:p,key:u,index:a,removeProps:{onClick:function(){return e.removeValue(t)},onTouchEnd:function(){return e.removeValue(t)},onMouseDown:function(e){e.preventDefault()}},data:t}),e.formatOptionLabel(t,"value"))});if(f)return null;var x=b[0];return l.createElement(a,eu({},c,{data:x,isDisabled:p}),this.formatOptionLabel(x,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.getComponents().ClearIndicator,t=this.commonProps,r=this.props,n=r.isDisabled,o=r.isLoading,s=this.state.isFocused;if(!this.isClearable()||!e||n||!this.hasValue()||o)return null;var a={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return l.createElement(e,eu({},t,{innerProps:a,isFocused:s}))}},{key:"renderLoadingIndicator",value:function(){var e=this.getComponents().LoadingIndicator,t=this.commonProps,r=this.props,n=r.isDisabled,o=r.isLoading,s=this.state.isFocused;return e&&o?l.createElement(e,eu({},t,{innerProps:{"aria-hidden":"true"},isDisabled:n,isFocused:s})):null}},{key:"renderIndicatorSeparator",value:function(){var e=this.getComponents(),t=e.DropdownIndicator,r=e.IndicatorSeparator;if(!t||!r)return null;var n=this.commonProps,o=this.props.isDisabled,s=this.state.isFocused;return l.createElement(r,eu({},n,{isDisabled:o,isFocused:s}))}},{key:"renderDropdownIndicator",value:function(){var e=this.getComponents().DropdownIndicator;if(!e)return null;var t=this.commonProps,r=this.props.isDisabled,n=this.state.isFocused,o={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return l.createElement(e,eu({},t,{innerProps:o,isDisabled:r,isFocused:n}))}},{key:"renderMenu",value:function(){var e,t=this,r=this.getComponents(),n=r.Group,o=r.GroupHeading,s=r.Menu,a=r.MenuList,i=r.MenuPortal,c=r.LoadingMessage,u=r.NoOptionsMessage,d=r.Option,p=this.commonProps,m=this.state.focusedOption,f=this.props,h=f.captureMenuScroll,g=f.inputValue,b=f.isLoading,v=f.loadingMessage,y=f.minMenuHeight,x=f.maxMenuHeight,_=f.menuIsOpen,w=f.menuPlacement,j=f.menuPosition,N=f.menuPortalTarget,O=f.menuShouldBlockScroll,S=f.menuShouldScrollIntoView,C=f.noOptionsMessage,P=f.onMenuScrollToTop,I=f.onMenuScrollToBottom;if(!_)return null;var M=function(e,r){var n=e.type,o=e.data,s=e.isDisabled,a=e.isSelected,i=e.label,c=e.value,u=m===o,f=s?void 0:function(){return t.onOptionHover(o)},h=s?void 0:function(){return t.selectOption(o)},g="".concat(t.getElementId("option"),"-").concat(r),b={id:g,onClick:h,onMouseMove:f,onMouseOver:f,tabIndex:-1,role:"option","aria-selected":t.isAppleDevice?void 0:a};return l.createElement(d,eu({},p,{innerProps:b,data:o,isDisabled:s,isSelected:a,key:g,label:i,type:n,value:c,isFocused:u,innerRef:u?t.getFocusedOptionRef:void 0}),t.formatOptionLabel(e.data,"menu"))};if(this.hasOptions())e=this.getCategorizedOptions().map(function(e){if("group"===e.type){var r=e.data,s=e.options,a=e.index,i="".concat(t.getElementId("group"),"-").concat(a),c="".concat(i,"-heading");return l.createElement(n,eu({},p,{key:i,data:r,options:s,Heading:o,headingProps:{id:c,data:e.data},label:t.formatGroupLabel(e.data)}),e.options.map(function(e){return M(e,"".concat(a,"-").concat(e.index))}))}if("option"===e.type)return M(e,"".concat(e.index))});else if(b){var k=v({inputValue:g});if(null===k)return null;e=l.createElement(c,p,k)}else{var D=C({inputValue:g});if(null===D)return null;e=l.createElement(u,p,D)}var $={minMenuHeight:y,maxMenuHeight:x,menuPlacement:w,menuPosition:j,menuShouldScrollIntoView:S},A=l.createElement(tY,eu({},p,$),function(r){var n=r.ref,o=r.placerProps,i=o.placement,c=o.maxHeight;return l.createElement(s,eu({},p,$,{innerRef:n,innerProps:{onMouseDown:t.onMenuMouseDown,onMouseMove:t.onMenuMouseMove},isLoading:b,placement:i}),l.createElement(rM,{captureEnabled:h,onTopArrive:P,onBottomArrive:I,lockEnabled:O},function(r){return l.createElement(a,eu({},p,{innerRef:function(e){t.getMenuListRef(e),r(e)},innerProps:{role:"listbox","aria-multiselectable":p.isMulti,id:t.getElementId("listbox")},isLoading:b,maxHeight:c,focusedOption:m}),e)}))});return N||"fixed"===j?l.createElement(i,eu({},p,{appendTo:N,controlElement:this.controlRef,menuPlacement:w,menuPosition:j}),A):A}},{key:"renderFormField",value:function(){var e=this,t=this.props,r=t.delimiter,n=t.isDisabled,o=t.isMulti,s=t.name,a=t.required,i=this.state.selectValue;if(a&&!this.hasValue()&&!n)return l.createElement(rD,{name:s,onFocus:this.onValueInputFocus});if(s&&!n){if(o){if(r){var c=i.map(function(t){return e.getOptionValue(t)}).join(r);return l.createElement("input",{name:s,type:"hidden",value:c})}var u=i.length>0?i.map(function(t,r){return l.createElement("input",{key:"i-".concat(r),name:s,type:"hidden",value:e.getOptionValue(t)})}):l.createElement("input",{name:s,type:"hidden",value:""});return l.createElement("div",null,u)}var d=i[0]?this.getOptionValue(i[0]):"";return l.createElement("input",{name:s,type:"hidden",value:d})}}},{key:"renderLiveRegion",value:function(){var e=this.commonProps,t=this.state,r=t.ariaSelection,n=t.focusedOption,o=t.focusedValue,s=t.isFocused,a=t.selectValue,i=this.getFocusableOptions();return l.createElement(rf,eu({},e,{id:this.getElementId("live-region"),ariaSelection:r,focusedOption:n,focusedValue:o,isFocused:s,selectValue:a,focusableOptions:i,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var e=this.getComponents(),t=e.Control,r=e.IndicatorsContainer,n=e.SelectContainer,o=e.ValueContainer,s=this.props,a=s.className,i=s.id,c=s.isDisabled,u=s.menuIsOpen,d=this.state.isFocused,p=this.commonProps=this.getCommonProps();return l.createElement(n,eu({},p,{className:a,innerProps:{id:i,onKeyDown:this.onKeyDown},isDisabled:c,isFocused:d}),this.renderLiveRegion(),l.createElement(t,eu({},p,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:c,isFocused:d,menuIsOpen:u}),l.createElement(o,eu({},p,{isDisabled:c}),this.renderPlaceholderOrValue(),this.renderInput()),l.createElement(r,eu({},p,{isDisabled:c}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],n=[{key:"getDerivedStateFromProps",value:function(e,t){var r,n=t.prevProps,o=t.clearFocusValueOnUpdate,s=t.inputIsHiddenAfterUpdate,a=t.ariaSelection,i=t.isFocused,l=t.prevWasFocused,c=t.instancePrefix,u=e.options,d=e.value,p=e.menuIsOpen,m=e.inputValue,f=e.isMulti,h=tk(d),g={};if(n&&(d!==n.value||u!==n.options||p!==n.menuIsOpen||m!==n.inputValue)){var b,v=p?rH(rT(e,h)):[],y=p?rU(rT(e,h),"".concat(c,"-option")):[],x=o?function(e,t){var r=e.focusedValue,n=e.selectValue.indexOf(r);if(n>-1){if(t.indexOf(r)>-1)return r;if(n<t.length)return t[n]}return null}(t,h):null,_=(b=t.focusedOption)&&v.indexOf(b)>-1?b:v[0],w=rq(y,_);g={selectValue:h,focusedOption:_,focusedOptionId:w,focusableOptionsWithIds:y,focusedValue:x,clearFocusValueOnUpdate:!1}}var j=null!=s&&e!==n?{inputIsHidden:s,inputIsHiddenAfterUpdate:void 0}:{},N=a,O=i&&l;return i&&!O&&(N={value:(r=h[0]||null,f?h:r),options:h,action:"initial-input-focus"},O=!l),(null==a?void 0:a.action)==="initial-input-focus"&&(N=null),ec(ec(ec({},g),j),{},{prevProps:e,ariaSelection:N,prevWasFocused:O})}}],r&&ro(s.prototype,r),n&&ro(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}(l.Component);rK.defaultProps=rR,r(45455),r(13279),r(67738),r(78513),r(53388),r(82522),r(59335),r(81586),r(16347),r(8238),r(97307);var rQ=(0,l.forwardRef)(function(e,t){var r=rn(e);return l.createElement(rK,eu({ref:t},r))}),r0=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"],r1=(0,l.forwardRef)(function(e,t){var r,n,o,s,a,i,c,u,d,p,m,f,h,g,b,v,y,x,_,w,j,N,O,S,C,P,I,M,k,D,$,A,E,L,V,R,F,T,H,U,z,q,B=rn((n=void 0!==(r=e.defaultOptions)&&r,s=void 0!==(o=e.cacheOptions)&&o,a=e.loadOptions,e.options,i=e.isLoading,c=e.onInputChange,u=e.filterOption,p=(d=tN(e,r0)).inputValue,m=(0,l.useRef)(void 0),f=(0,l.useRef)(!1),g=(h=tj((0,l.useState)(Array.isArray(n)?n:void 0),2))[0],b=h[1],y=(v=tj((0,l.useState)(void 0!==p?p:""),2))[0],x=v[1],w=(_=tj((0,l.useState)(!0===n),2))[0],j=_[1],O=(N=tj((0,l.useState)(void 0),2))[0],S=N[1],P=(C=tj((0,l.useState)([]),2))[0],I=C[1],k=(M=tj((0,l.useState)(!1),2))[0],D=M[1],A=($=tj((0,l.useState)({}),2))[0],E=$[1],V=(L=tj((0,l.useState)(void 0),2))[0],R=L[1],T=(F=tj((0,l.useState)(void 0),2))[0],H=F[1],s!==T&&(E({}),H(s)),n!==V&&(b(Array.isArray(n)?n:void 0),R(n)),(0,l.useEffect)(function(){return f.current=!0,function(){f.current=!1}},[]),U=(0,l.useCallback)(function(e,t){if(!a)return t();var r=a(e,t);r&&"function"==typeof r.then&&r.then(t,function(){return t()})},[a]),(0,l.useEffect)(function(){!0===n&&U(y,function(e){f.current&&(b(e||[]),j(!!m.current))})},[]),z=(0,l.useCallback)(function(e,t){var r=function(e,t,r){if(r){var n=r(e,t);if("string"==typeof n)return n}return e}(e,t,c);if(!r){m.current=void 0,x(""),S(""),I([]),j(!1),D(!1);return}if(s&&A[r])x(r),S(r),I(A[r]),j(!1),D(!1);else{var n=m.current={};x(r),j(!0),D(!O),U(r,function(e){f&&n===m.current&&(m.current=void 0,j(!1),S(r),I(e||[]),D(!1),E(e?ec(ec({},A),{},ei({},r,e)):A))})}},[s,U,O,A,c]),q=k?[]:y&&O?P:g||[],ec(ec({},d),{},{options:q,isLoading:w||void 0!==i&&i,onInputChange:z,filterOption:void 0===u?null:u})));return l.createElement(rK,eu({ref:t},B))}),r2=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],r5=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=String(e).toLowerCase(),o=String(r.getOptionValue(t)).toLowerCase(),s=String(r.getOptionLabel(t)).toLowerCase();return o===n||s===n},r3={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,r,n){return!(!e||t.some(function(t){return r5(e,t,n)})||r.some(function(t){return r5(e,t,n)}))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}},r4=(0,l.forwardRef)(function(e,t){var r,n,o,s,a,i,c,u,d,p,m,f,h,g,b,v,y,x,_,w,j,N,O,S,C,P,I,M,k=(o=void 0!==(n=(r=rn(e)).allowCreateWhileLoading)&&n,a=void 0===(s=r.createOptionPosition)?"last":s,c=void 0===(i=r.formatCreateLabel)?r3.formatCreateLabel:i,d=void 0===(u=r.isValidNewOption)?r3.isValidNewOption:u,m=void 0===(p=r.getNewOptionData)?r3.getNewOptionData:p,f=r.onCreateOption,g=void 0===(h=r.options)?[]:h,b=r.onChange,x=void 0===(y=(v=tN(r,r2)).getOptionValue)?rE:y,w=void 0===(_=v.getOptionLabel)?rA:_,j=v.inputValue,N=v.isLoading,O=v.isMulti,S=v.value,C=v.name,P=(0,l.useMemo)(function(){return d(j,tk(S),g,{getOptionValue:x,getOptionLabel:w})?m(j,c(j)):void 0},[c,m,w,x,j,d,g,S]),I=(0,l.useMemo)(function(){return(o||!N)&&P?"first"===a?[P].concat(rl(g)):[].concat(rl(g),[P]):g},[o,a,N,P,g]),M=(0,l.useCallback)(function(e,t){if("select-option"!==t.action)return b(e,t);var r=Array.isArray(e)?e:[e];if(r[r.length-1]===P){if(f)f(j);else{var n,o=m(j,j);b((n=[].concat(rl(tk(S)),[o]),O?n:o),{action:"create-option",name:C,option:o})}return}b(e,t)},[m,j,O,C,P,f,b,S]),ec(ec({},v),{},{options:I,onChange:M}));return l.createElement(rK,eu({ref:t},k))});let r6=(e,t)=>{let r=t.toLowerCase().trim();if(!r)return!0;let n=e.label.toLowerCase(),o=e.data?.notes?.toLowerCase()||"",s=e.data?.originalName?.toLowerCase()||"";return n.includes(r)||o.includes(r)||s.includes(r)},r7=e=>{let{data:t}=e;return i.jsx(rt.Option,{...e,children:(0,i.jsxs)("div",{className:"flex flex-col",children:[i.jsx("div",{children:t.label}),t.notes&&i.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:t.notes})]})})},r8=e=>{let{data:t}=e;return i.jsx(rt.MultiValue,{...e,children:(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("span",{children:t.label}),t.notes&&(0,i.jsxs)("span",{className:"ml-1 text-xs text-gray-500",children:["（",t.notes,"）"]})]})})},r9=({placeholder:e,options:t=[],loadOptions:r,value:n=[],onChange:o,isMulti:s=!0,allowCreation:a=!1,isAsync:c=!1,isDisabled:u=!1,isLoading:d=!1,noOptionsMessage:p="無符合選項",className:m=""})=>{let[f,h]=(0,l.useState)(""),g=e=>(h(e),e),b=e=>{if(!e){o([]);return}Array.isArray(e)?o(e):o([e])},v=e=>{o([...n,{label:e,value:`custom-${Math.random().toString(36).substring(2,9)}`,originalName:e}]),h("")},y=async e=>{if(!e||e.length<2)return[];try{if(r)return await r(e);return[]}catch(e){return console.error("加載選項失敗",e),[]}},x={control:e=>({...e,padding:"2px",borderColor:"#d1d5db",borderRadius:"0.375rem",minHeight:"38px",boxShadow:"none","&:hover":{borderColor:"#9ca3af"}}),menu:e=>({...e,zIndex:9999,maxHeight:"400px"}),menuList:e=>({...e,maxHeight:"350px"}),group:e=>({...e,paddingTop:"8px",paddingBottom:"8px"}),groupHeading:e=>({...e,fontWeight:"bold",fontSize:"0.9rem",color:"#374151",backgroundColor:"#f9fafb",padding:"6px 12px",margin:"0"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"#e6f4ff":t.isFocused?"#f0f9ff":void 0,color:"#000",fontWeight:t.isSelected?500:400,padding:"8px 12px"}),multiValue:e=>({...e,backgroundColor:"#e6f4ff",borderRadius:"4px"}),multiValueLabel:e=>({...e,color:"#1f2937",fontWeight:500}),multiValueRemove:e=>({...e,color:"#6b7280",":hover":{backgroundColor:"#dbeafe",color:"#1f2937"}}),input:e=>({...e,color:"#1f2937"}),placeholder:e=>({...e,color:"#9ca3af"})};return i.jsx("div",{className:"w-full",children:(()=>{let r={placeholder:e,value:s?n:n[0]||null,onChange:b,isMulti:s,isDisabled:u||d,isLoading:d,className:`w-full ${m}`,classNamePrefix:"react-select",noOptionsMessage:()=>p,onInputChange:g,styles:x,filterOption:r6,components:{Option:r7,MultiValue:r8},ignoreAccents:!0,ignoreCase:!0};return c?i.jsx(r1,{...r,loadOptions:y,defaultOptions:t,cacheOptions:!0}):a?i.jsx(r4,{...r,options:t,onCreateOption:v,formatCreateLabel:e=>`新增: "${e}"`}):i.jsx(rQ,{...r,options:t})})()})},ne=({children:e})=>i.jsx(Z,{fallbackRender:({error:e,resetErrorBoundary:t})=>(0,i.jsxs)("div",{className:"bg-red-50 p-4 rounded-md border border-red-300",children:[i.jsx("h3",{className:"text-lg font-medium text-red-800",children:"診斷表單載入錯誤"}),i.jsx("p",{className:"mt-2 text-sm text-red-700",children:"資料異常，請重新載入頁面"}),i.jsx("button",{onClick:t,className:"mt-3 px-4 py-2 bg-red-100 text-red-800 rounded-md hover:bg-red-200",children:"重試"}),i.jsx("p",{className:"mt-2 text-xs text-red-600",children:e?.message||"未知錯誤"})]}),children:e}),nt=e=>{let t=(e,t)=>e?Array.isArray(e)?e.map(e=>"string"==typeof e?{code:`${t}-${Math.random().toString(36).substring(2,9)}`,name:e}:e&&"object"==typeof e?{code:e.code||`${t}-${Math.random().toString(36).substring(2,9)}`,name:e.name||""}:{code:`${t}-${Math.random().toString(36).substring(2,9)}`,name:String(e)}):"string"==typeof e&&e.trim()?[{code:`${t}-${Math.random().toString(36).substring(2,9)}`,name:e.trim()}]:e&&"object"==typeof e?[{code:e.code||`${t}-${Math.random().toString(36).substring(2,9)}`,name:e.name||""}]:[]:[];return{modernDiseases:t(e?.modernDiseases,"md"),cmSyndromes:t(e?.cmSyndromes,"cs"),cmPrinciple:t(e?.cmPrinciple,"cp")}},nr=e=>e.map(e=>({label:e.name,value:e.code})),nn=e=>e.map(e=>({code:e.value,name:e.originalName||e.label.split(" (又名:")[0].trim()})),no=({initialValues:e,onSave:t})=>{let r=(0,l.useMemo)(()=>nt(e),[e]),[n,o]=(0,l.useState)(r),[s,a]=(0,l.useState)(!0),[c,u]=(0,l.useState)({groupedOptions:[],searchableList:[]}),[d,p]=(0,l.useState)({groupedOptions:[],searchableList:[]}),[m,f]=(0,l.useState)({groupedOptions:[],searchableList:[]}),h=(0,l.useMemo)(()=>nr(n.modernDiseases),[n.modernDiseases]),g=(0,l.useMemo)(()=>nr(n.cmSyndromes),[n.cmSyndromes]),b=(0,l.useMemo)(()=>nr(n.cmPrinciple),[n.cmPrinciple]);(0,l.useEffect)(()=>{(async()=>{a(!0);try{let e=await eo();u(e.modernDiseases),p(e.cmSyndromes),f(e.cmPrinciples),console.log("診斷參考資料已載入並處理完成，共計：",{現代病名:e.modernDiseases.searchableList.length,中醫辨證:e.cmSyndromes.searchableList.length,中醫治則:e.cmPrinciples.searchableList.length})}catch(e){console.error("處理診斷參考資料時發生錯誤:",e)}finally{a(!1)}})()},[]),(0,l.useEffect)(()=>{o(r)},[r]);let v=async e=>!e||e.length<2?c.groupedOptions:Q(e,c.searchableList,c.groupedOptions),y=async e=>!e||e.length<2?d.groupedOptions:Q(e,d.searchableList,d.groupedOptions),x=async e=>!e||e.length<2?m.groupedOptions:Q(e,m.searchableList,m.groupedOptions);return i.jsx(ne,{children:(0,i.jsxs)("div",{className:"bg-white p-4 rounded-md shadow",children:[i.jsx("h2",{className:"text-lg font-semibold mb-3 text-gray-800 border-b pb-2",children:"中醫診斷"}),s?(0,i.jsxs)("div",{className:"py-4 flex justify-center",children:[(0,i.jsxs)("div",{className:"animate-pulse flex space-x-2",children:[i.jsx("div",{className:"h-3 w-3 bg-blue-500 rounded-full"}),i.jsx("div",{className:"h-3 w-3 bg-blue-500 rounded-full"}),i.jsx("div",{className:"h-3 w-3 bg-blue-500 rounded-full"})]}),i.jsx("span",{className:"ml-2 text-gray-500",children:"載入診斷選項中..."})]}):(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(n)},className:"space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"現代病名（多選）"}),i.jsx("div",{className:"border border-gray-300 rounded-md p-2 bg-gray-50",children:i.jsx(r9,{placeholder:"搜尋或選擇現代病名...",options:c.groupedOptions,loadOptions:v,value:h,onChange:e=>{o(t=>({...t,modernDiseases:nn(e)}))},isMulti:!0,allowCreation:!0,isAsync:!0,className:"w-full",noOptionsMessage:"無符合的現代病名，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"中醫辨證（多選）"}),i.jsx("div",{className:"border border-gray-300 rounded-md p-2 bg-gray-50",children:i.jsx(r9,{placeholder:"搜尋或選擇中醫辨證...",options:d.groupedOptions,loadOptions:y,value:g,onChange:e=>{o(t=>({...t,cmSyndromes:nn(e)}))},isMulti:!0,allowCreation:!0,isAsync:!0,className:"w-full",noOptionsMessage:"無符合的中醫辨證，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"中醫治則（多選）"}),i.jsx("div",{className:"border border-gray-300 rounded-md p-2 bg-gray-50",children:i.jsx(r9,{placeholder:"搜尋或選擇中醫治則...",options:m.groupedOptions,loadOptions:x,value:b,onChange:e=>{o(t=>({...t,cmPrinciple:nn(e)}))},isMulti:!0,allowCreation:!0,isAsync:!0,className:"w-full",noOptionsMessage:"無符合的中醫治則，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-300 rounded-md",children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[i.jsx("span",{className:"text-gray-700 font-medium",children:"\uD83E\uDD16 AI 推薦診斷"}),i.jsx("span",{className:"ml-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"即將推出"})]}),i.jsx("div",{className:"text-gray-500 text-sm italic",children:i.jsx("p",{children:"未來將根據患者主訴與觀察資料，自動推薦適合的診斷選項。"})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"儲存"})})]})]})})},ns=({options:e=[],placeholder:t,onSelect:r,onSearch:n,value:o,defaultValue:s="",className:a="",multiple:c=!1,selectedItems:u=[],onRemove:d,isLoading:p=!1})=>{let[m,f]=(0,l.useState)(o||s||""),[h,g]=(0,l.useState)([]),[b,v]=(0,l.useState)(!1),y=(0,l.useRef)(null),x=(0,l.useRef)(null);(0,l.useEffect)(()=>{void 0!==o&&f(o)},[o]),(0,l.useEffect)(()=>{if(""===m.trim()){g([]);return}n?g(n(m)):e.length>0&&g(e.filter(e=>e.toLowerCase().includes(m.toLowerCase())).map(e=>({key:e,value:e})))},[m,e,n]),(0,l.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&y.current&&!y.current.contains(e.target)&&v(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let _=e=>{c?(!u.includes(e.value)&&r&&r(e.value,e),f("")):(o||f(e.value),r&&r(e.value,e)),v(!1)};return(0,i.jsxs)("div",{className:"relative w-full",children:[(0,i.jsxs)("div",{className:`flex flex-wrap items-center border rounded-md ${a}`,children:[c&&u.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center m-1 px-2 py-1 bg-blue-100 rounded-md",children:[i.jsx("span",{className:"mr-1",children:e}),i.jsx("button",{type:"button",onClick:()=>d&&d(e),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]},`${e}-${t}`)),i.jsx("input",{ref:y,type:"text",value:m,onChange:e=>{f(e.target.value),v(!0)},placeholder:c&&u.length>0?"":t,className:`flex-grow p-2 outline-none ${c?"min-w-[100px]":"w-full"}`,onFocus:()=>m&&v(!0)}),p&&i.jsx("div",{className:"mr-2 h-4 w-4 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"})]}),b&&h.length>0&&i.jsx("div",{ref:x,className:"absolute z-10 w-full mt-1 bg-white shadow-lg rounded-md max-h-60 overflow-y-auto",children:h.map((e,t)=>i.jsx("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100",onClick:()=>_(e),children:e.value},`${e.key}-${t}`))})]})},na=({onSave:e,initialChiefComplaint:t=""})=>{let[r,n]=(0,l.useState)(t),[o,s]=(0,l.useState)(""),[a,c]=(0,l.useState)({chiefComplaint:"",presentIllness:""});(0,l.useEffect)(()=>{n(t)},[t]);let u=()=>{let e=!0,t={chiefComplaint:"",presentIllness:""};return r.trim()||(t.chiefComplaint="請填寫主訴",e=!1),c(t),e};return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-md shadow",children:[i.jsx("h2",{className:"text-lg font-semibold mb-3 text-gray-800 border-b pb-2",children:"主訴與現病史"}),(0,i.jsxs)("form",{onSubmit:t=>{t.preventDefault(),u()&&e({chiefComplaint:r,presentIllness:o})},className:"space-y-4",children:[(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"主訴"}),i.jsx("textarea",{value:r,onChange:e=>n(e.target.value),placeholder:"請輸入患者的主要症狀和不適",className:`w-full p-2 border ${a.chiefComplaint?"border-red-500":"border-gray-300"} rounded-md min-h-[80px]`}),a.chiefComplaint&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.chiefComplaint})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"現病史"}),i.jsx("textarea",{value:o,onChange:e=>s(e.target.value),placeholder:"請輸入患者的發病時間、經過、治療史等",className:`w-full p-2 border ${a.presentIllness?"border-red-500":"border-gray-300"} rounded-md min-h-[120px]`}),a.presentIllness&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.presentIllness})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"保存"})})]})]})};var ni=r(63908),nl=r.n(ni),nc=r(47665),nu=r(20984);function nd(e){if(null==e||"string"==typeof e&&""===e.trim()||"object"==typeof e&&(0===Object.keys(e).length||Array.isArray(e)&&0===e.length))return"";if("object"==typeof e&&!Array.isArray(e))try{return JSON.stringify(e)}catch(e){return console.warn("無法將物件轉為 JSON 字串:",e),""}if(Array.isArray(e))try{if(0===e.length)return"";if("string"==typeof e[0])return e.join("、");return JSON.stringify(e)}catch(e){return console.warn("無法將陣列轉為 JSON 字串:",e),""}return"string"==typeof e?e.trim():String(e)}function np(e){return Array.isArray(e)?e.filter(e=>null!=e):null==e||""===e?[]:[e]}let nm=[];nc.Z.create({baseURL:"https://clinic.aspiratcm.com/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}});let nf=async(e,t,r,n=3,o=1e3)=>{let s=0,a=null;for(;s<n;)try{let n;let o=(0,nu.l9)(t);if(console.log(`嘗試 ${e.toUpperCase()} 請求到: ${o}`),"get"===e.toLowerCase())n=await nc.Z.get(o,{params:r,timeout:1e4});else if("post"===e.toLowerCase())n=await nc.Z.post(o,r,{timeout:1e4});else if("put"===e.toLowerCase())n=await nc.Z.put(o,r,{timeout:1e4});else if("patch"===e.toLowerCase())n=await nc.Z.patch(o,r,{timeout:1e4});else if("delete"===e.toLowerCase())n=await nc.Z.delete(o,{timeout:1e4});else throw Error(`不支持的HTTP方法: ${e}`);return n.data}catch(e){if(a=e,e.response?.status===404){console.log(`資源不存在: ${t}`,e.response?.data);let r=e.response?.data,n=r?.detail||"資源不存在";throw Error(`找不到資源: ${n}`)}if(e.response?.status===400){console.log(`請求參數錯誤: ${t}`,e.response?.data);let r=e.response?.data,n=r?.detail||"請求參數錯誤";throw Error(`請求參數錯誤: ${n}`)}if(e.response?.status===401)throw console.log(`未授權訪問: ${t}`),Error("您的登錄狀態已過期，請重新登錄");if(e.response?.status&&e.response.status>=400&&e.response.status<500){console.log(`客戶端錯誤: ${t}`,e.response?.data);let r=e.response?.data,n=r?.detail||"請求出現錯誤";throw Error(`請求錯誤: ${n}`)}s++,console.log(`API請求失敗 (${s}/${n})...`,e),console.log(`請求URL: ${t}`),console.log(`錯誤詳情:`,e.response?.data||e.message),await new Promise(e=>setTimeout(e,o*Math.pow(2,s-1)))}let i="系統暫時無法連接，請稍後再試";throw a?.response?.status===500?i="系統內部錯誤，請聯繫技術支持":a?.code==="ECONNABORTED"?i="連接超時，請檢查網絡連接":a?.message&&(i=`請求失敗: ${a.message}`),console.error(`重試 ${n} 次後仍然失敗:`,t,a),Error(i)},nh={getPatientRecords:async e=>{try{return console.log("正在獲取患者病歷，患者ID:",e),await nf("get",`/medical-records/by-patient/${e}`)}catch(t){throw console.error(`獲取患者病歷失敗，患者ID: ${e}:`,t),t}},getRecordById:async e=>{try{console.log("正在獲取病歷詳情，記錄ID:",e);let t=await nf("get",`/medical-records/${e}`),r=function(e){if(!e)return{};let t={...e};if(["chief_complaint","present_illness","observation","left_pulse","right_pulse","tongue_quality","tongue_shape","tongue_color","tongue_coating"].forEach(e=>{e in t&&(null===t[e]||void 0===t[e])&&(t[e]="")}),t.observation)try{if("string"==typeof t.observation&&(t.observation.startsWith("{")||t.observation.startsWith("[")))try{let e=JSON.parse(t.observation);if(e&&"object"==typeof e){let r={...e.observation||{},leftPulse:t.left_pulse||"",rightPulse:t.right_pulse||"",tongueQuality:t.tongue_quality||"",tongueShape:t.tongue_shape||"",tongueColor:t.tongue_color||"",tongueCoating:t.tongue_coating||""};t.client_observation=r}}catch(e){console.warn("解析 observation JSON 字串失敗:",e)}}catch(e){console.warn("處理 observation 欄位時出錯:",e)}if(t.diagnoses&&t.diagnoses.length>0){let e=t.diagnoses[0];e.modern_diseases&&null!==e.modern_diseases||(e.modern_diseases=[]),e.cm_syndromes&&null!==e.cm_syndromes||(e.cm_syndromes=[]),t.client_diagnosis={modernDiseases:e.modern_diseases.map(e=>({code:e,name:e})),cmSyndromes:e.cm_syndromes.map(e=>({code:e,name:e})),cmPrinciple:e.cm_principle?[{code:e.cm_principle,name:e.cm_principle}]:[]}}else t.diagnoses=[],t.client_diagnosis={modernDiseases:[],cmSyndromes:[],cmPrinciple:[]};if(t.prescriptions&&t.prescriptions.length>0){let e=t.prescriptions[0];e.instructions||(e.instructions=""),e.structured_data&&e.structured_data.structured_instructions||(e.structured_data={...e.structured_data,structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"}}),e.herbs&&Array.isArray(e.herbs)||(e.herbs=[]),t.client_prescription={herbs:e.herbs.map(e=>({id:Date.now().toString()+Math.random().toString(36).substring(2,9),code:e.structured_data?.code||"",name:e.herb_name||"",amount:e.amount||"",powder_amount:e.amount||"",decoction_amount:e.structured_data?.decoction_amount||"",brand:e.structured_data?.brand||"",price_per_gram:e.structured_data?.price_per_gram||0,total_price:e.structured_data?.total_price||0,unit:e.unit||"g",is_compound:e.structured_data?.is_compound||!1})),instructions:e.instructions||"",structured_instructions:e.structured_data?.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"}}}else t.prescriptions=[],t.client_prescription={herbs:[],instructions:"",structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"}};if(t.treatments&&t.treatments.length>0){let e=t.treatments[0];e.treatment_items&&Array.isArray(e.treatment_items)||(e.treatment_items=[]),t.client_treatment={treatments:e.treatment_items.map(e=>({id:Date.now().toString()+Math.random().toString(36).substring(2,9),method:e.method||"",targets:e.target?[e.target]:[]}))},t.treatmentMethods=e.treatment_items.map(e=>`${e.method||""}${e.target?`: ${e.target}`:""}`)}else t.treatments=[],t.client_treatment={treatments:[]},t.treatmentMethods=[];return t}(t);return console.log("經過強化處理的病歷記錄:",r),r}catch(t){throw console.error(`獲取病歷詳情失敗，記錄ID: ${e}:`,t),t}},createRecord:async e=>{try{console.log("收到病歷資料，準備清洗資料並轉換格式:",e);let t=function(e){if(!e)return{};let t={...e};if(["chief_complaint","present_illness","left_pulse","right_pulse","tongue_quality","tongue_shape","tongue_color","tongue_coating","prescription_instructions"].forEach(e=>{e in t&&(t[e]=nd(t[e]))}),"observation"in t){if("string"==typeof t.observation&&(t.observation.startsWith("{")||t.observation.startsWith("[")))try{let e=JSON.parse(t.observation);!e||"object"==typeof e&&0===Object.keys(e).length||Array.isArray(e)&&0===e.length?t.observation="":t.observation="string"==typeof t.observation?t.observation:JSON.stringify(e)}catch(e){console.warn("無法解析 observation JSON 字串:",e)}else if("object"==typeof t.observation&&null!==t.observation)try{0===Object.keys(t.observation).length?t.observation="":t.observation=JSON.stringify(t.observation)}catch(e){console.warn("無法將 observation 物件轉為 JSON 字串:",e),t.observation=""}else(null===t.observation||void 0===t.observation)&&(t.observation="")}if(t.diagnosis){if("object"==typeof t.diagnosis&&null!==t.diagnosis&&("modern_diseases"in t.diagnosis?t.diagnosis.modern_diseases=np(t.diagnosis.modern_diseases).filter(e=>e&&"string"==typeof e&&""!==e.trim()):"modernDiseases"in t.diagnosis?(t.diagnosis.modern_diseases=np(t.diagnosis.modernDiseases).filter(e=>e&&("string"==typeof e?""!==e.trim():e.code||e.name)),delete t.diagnosis.modernDiseases):t.diagnosis.modern_diseases=[],"cm_syndromes"in t.diagnosis?t.diagnosis.cm_syndromes=np(t.diagnosis.cm_syndromes).filter(e=>e&&"string"==typeof e&&""!==e.trim()):"cmSyndromes"in t.diagnosis?(t.diagnosis.cm_syndromes=np(t.diagnosis.cmSyndromes).filter(e=>e&&("string"==typeof e?""!==e.trim():e.code||e.name)),delete t.diagnosis.cmSyndromes):t.diagnosis.cm_syndromes=[],!("cm_principle"in t.diagnosis)&&"cmPrinciple"in t.diagnosis)){if(Array.isArray(t.diagnosis.cmPrinciple)&&t.diagnosis.cmPrinciple.length>0){let e=t.diagnosis.cmPrinciple[0];t.diagnosis.cm_principle="object"==typeof e?e.code||e.name||"":e}else t.diagnosis.cm_principle="";delete t.diagnosis.cmPrinciple}}else t.diagnosis={modern_diseases:[],cm_syndromes:[],cm_principle:""};return t.prescription?Array.isArray(t.prescription)?t.prescription=t.prescription.filter(e=>e&&(e.name||e.herb_name)).map(e=>({id:e.id||Date.now().toString()+Math.random().toString(36).substring(2,9),name:e.name||e.herb_name||"",code:e.code||"",amount:e.amount||e.powder_amount||"0",powder_amount:e.powder_amount||e.amount||"0",decoction_amount:e.decoction_amount||"",brand:e.brand||"",price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,unit:e.unit||"g",is_compound:e.is_compound||!1})):"object"==typeof t.prescription&&t.prescription.herbs&&(Array.isArray(t.prescription.herbs)?t.prescription.herbs=t.prescription.herbs.filter(e=>e&&(e.name||e.herb_name)).map(e=>({herb_name:e.name||e.herb_name||"",amount:e.amount||e.powder_amount||"0",unit:e.unit||"g",structured_data:e.structured_data||{code:e.code||"",brand:e.brand||"",price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,is_compound:e.is_compound||!1}})):t.prescription.herbs=[],t.prescription.instructions=t.prescription.instructions||"",t.prescription.structured_instructions||(t.prescription.structured_instructions={total_days:7,times_per_day:2,timing:"早晚服"})):t.prescription=[],t.treatment?"object"!=typeof t.treatment||Array.isArray(t.treatment)?Array.isArray(t.treatment)?t.treatment={treatment_items:t.treatment.map((e,t)=>{if("string"==typeof e){let r=e.split(":",2);return{method:r[0].trim(),target:r.length>1?r[1].trim():"",sequence:t}}return"object"==typeof e&&e?{method:e.method||"",target:e.target||"",description:e.description||"",sequence:t}:{method:"",target:"",sequence:t}}).filter(e=>""!==e.method.trim())}:t.treatmentMethods&&Array.isArray(t.treatmentMethods)&&(t.treatment={treatment_items:t.treatmentMethods.map((e,t)=>{if("string"!=typeof e)return{method:"",target:"",sequence:t};{let r=e.split(":",2);return{method:r[0].trim(),target:r.length>1?r[1].trim():"",sequence:t}}}).filter(e=>""!==e.method.trim())}):t.treatment.treatment_items&&Array.isArray(t.treatment.treatment_items)?t.treatment.treatment_items=t.treatment.treatment_items.filter(e=>e&&e.method).map(e=>({method:e.method,target:e.target||"",description:e.description||"",sequence:e.sequence||0})):t.treatment.treatment_items=[]:t.treatment={treatment_items:[]},t}(e);console.log("清理後的資料:",t);let r={...t};if(t.diagnosis){let e=t.diagnosis_structured||t.diagnosis;e?r.diagnosis={modern_diseases:(e.modernDiseases||e.modern_diseases||[]).filter(e=>e&&("string"==typeof e?""!==e.trim():e.code||e.name)).map(e=>"string"==typeof e?e:e.code||e.name||""),cm_syndromes:(e.cmSyndromes||e.cm_syndromes||[]).filter(e=>e&&("string"==typeof e?""!==e.trim():e.code||e.name)).map(e=>"string"==typeof e?e:e.code||e.name||""),cm_principle:e.cmPrinciple?.[0]?.code||e.cmPrinciple?.[0]?.name||e.cm_principle||""}:r.diagnosis={modern_diseases:[],cm_syndromes:[],cm_principle:""},delete r.diagnosis_structured}else r.diagnosis={modern_diseases:[],cm_syndromes:[],cm_principle:""};return t.prescription?Array.isArray(t.prescription)?r.prescription={instructions:nd(t.prescription_instructions||""),structured_instructions:t.prescription_structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"},herbs:t.prescription.map((e,t)=>({herb_name:e.name||"",amount:e.amount||e.powder_amount||"0",unit:e.unit||"g",sequence:t,source:"manual",structured_data:{price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,brand:e.brand||"",is_compound:e.is_compound||!1,code:e.code||""}}))}:t.prescription.herbs&&Array.isArray(t.prescription.herbs)?r.prescription={instructions:nd(t.prescription.instructions||""),structured_instructions:t.prescription.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"},herbs:t.prescription.herbs.map((e,t)=>({herb_name:e.herb_name||e.name||"",amount:e.amount||"0",unit:e.unit||"g",sequence:t,source:e.source||"manual",structured_data:e.structured_data||{price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,brand:e.brand||"",is_compound:e.is_compound||!1,code:e.code||""}}))}:"object"==typeof t.prescription&&(r.prescription={instructions:nd(t.prescription.instructions||t.prescription_instructions||""),structured_instructions:t.prescription.structured_instructions||t.prescription_structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"},herbs:[]}):r.prescription={instructions:"",structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"},herbs:[]},t.treatment?Array.isArray(t.treatment_methods)&&t.treatment_methods.length>0?r.treatment={treatment_items:t.treatment_methods.map((e,t)=>{let r=e.split(":",2);return{method:r[0].trim(),target:r.length>1?r[1].trim():"",description:"",sequence:t}})}:t.treatment.treatment_items&&Array.isArray(t.treatment.treatment_items)?r.treatment=t.treatment:r.treatment={treatment_items:[]}:Array.isArray(t.treatment_methods)&&t.treatment_methods.length>0?r.treatment={treatment_items:t.treatment_methods.map((e,t)=>{let r=e.split(":",2);return{method:r[0].trim(),target:r.length>1?r[1].trim():"",description:"",sequence:t}})}:r.treatment={treatment_items:[]},delete r.prescription_instructions,delete r.prescription_structured_instructions,delete r.treatment_methods,console.log("轉換後準備發送的病歷資料:",r),await nf("post","/medical-records",r)}catch(e){throw console.error("創建病歷失敗:",e),e}},updateRecord:async(e,t)=>{try{return console.log(`正在更新病歷，記錄ID: ${e}:`,t),await nf("put",`/medical-records/${e}`,t)}catch(t){throw console.error(`更新病歷失敗，記錄ID: ${e}:`,t),t}}},ng={getPatientById:async e=>{try{if(console.log("正在獲取患者資料，患者ID:",e),!e)throw Error("缺少有效的患者ID");let t=await nf("get",`/patient_registration/${e}`),r=nb(t);return console.log("清理後的患者資料:",r),r}catch(t){if(console.error(`獲取患者資料失敗，患者ID: ${e}:`,t),t.response)throw console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應數據: `,t.response.data),Error(`獲取患者資料失敗(${t.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw t}},getPatientByPhoneNumber:async e=>{try{console.log("正在獲取患者資料，電話號碼:",e);let t=e.replace(/[\s\-\(\)]/g,"");try{console.log("嘗試使用查詢參數格式 API 端點");let e=await nc.Z.get((0,nu.l9)(`/patients/by-phone-number?phone=${t}`),{timeout:5e3});console.log("成功獲取患者資料（查詢參數格式）");let r=nb(e.data);return console.log("清理後的患者資料:",r),r}catch(n){console.warn("使用新 API 端點失敗，嘗試舊式端點格式:",n?.message),console.log("嘗試使用原始路徑參數格式 API 端點（即將淘汰）");let e=await nf("get",`/patient_registration/by-phone-number/${t}/`),r=nb(e);return console.log("清理後的患者資料:",r),r}}catch(t){if(console.error(`獲取患者資料失敗，電話號碼: ${e}:`,t),t.response)throw console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應數據: `,t.response.data),Error(`獲取患者資料失敗(${t.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw t}},updatePatient:async(e,t)=>{try{return console.log(`正在更新患者資料，患者ID: ${e}:`,t),await nf("patch",`/patients/${e}`,t)}catch(t){if(console.error(`更新患者資料失敗，患者ID: ${e}:`,t),t.response)throw console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應數據: `,t.response.data),Error(`更新患者資料失敗(${t.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw t}},updatePatientMarkers:async(e,t)=>{try{let r=await fetch(`${(0,nu.l9)(`/patients/${e}`)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw console.error(`API響應狀態: ${r.status}`),console.error(`請求URL: ${(0,nu.l9)(`/patients/${e}`)}`),Error(`更新患者標記失敗(${r.status}): 可能是程式邏輯錯誤，請通知技術人員`);return await r.json()}catch(e){throw console.error("更新患者標記時出錯:",e),e}}};function nb(e){if(!e)return{};let t={...e};if(["basic_diseases","drug_allergies","food_allergies"].forEach(e=>{e in t&&null!==t[e]&&void 0!==t[e]?Array.isArray(t[e])||(t[e]=[t[e]]):t[e]=[]}),["note","chief_complaint","special_note"].forEach(e=>{e in t&&(null===t[e]||void 0===t[e])&&(t[e]="")}),"observation"in t){if(null===t.observation||void 0===t.observation||"object"==typeof t.observation&&0===Object.keys(t.observation).length)t.observation="";else if("object"==typeof t.observation)try{t.observation=JSON.stringify(t.observation)}catch(e){console.warn("將 observation 對象轉換為字符串時出錯:",e),t.observation=""}}return t.medical_records&&Array.isArray(t.medical_records)&&(t.medical_records=t.medical_records.map(e=>{if(!e)return e;if("observation"in e){if(null===e.observation||void 0===e.observation||"object"==typeof e.observation&&0===Object.keys(e.observation).length)e.observation="";else if("object"==typeof e.observation)try{e.observation=JSON.stringify(e.observation)}catch(t){console.warn("將醫療記錄中的 observation 對象轉換為字符串時出錯:",t),e.observation=""}}return e.diagnosis&&(e.diagnosis.modern_diseases&&null!==e.diagnosis.modern_diseases||(e.diagnosis.modern_diseases=[]),e.diagnosis.cm_syndromes&&null!==e.diagnosis.cm_syndromes||(e.diagnosis.cm_syndromes=[])),e})),"is_troublesome"in t&&null===t.is_troublesome&&(t.is_troublesome=0),"is_contagious"in t&&null===t.is_contagious&&(t.is_contagious=0),t}let nv={getWaitingList:async()=>{try{console.log("正在從掛號系統獲取候診名單");let e="/patient_registration/waiting-list";console.log(`使用候診清單端點: ${e}`),console.log(`完整 URL: ${(0,nu.l9)(e)}`);let t=await nf("get",e);if(console.log(`候診清單響應:`,t),!Array.isArray(t))return console.warn("候診名單響應不是數組格式:",t),[];return t}catch(e){return console.error("獲取候診名單失敗:",e),e.response&&(console.error(`API響應狀態: ${e.response.status}`),console.error(`請求URL: ${e.config?.url}`),console.error(`回應數據: `,e.response.data)),[]}},removePatientFromWaitingList:async e=>{try{console.log(`正在從候診清單中移除患者，ID: ${e}`);let t=`/patient_registration/waiting-list/${e}`;return await nf("delete",t)}catch(t){if(console.error(`從候診清單中移除患者失敗，ID: ${e}:`,t),t.response)throw console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應數據: `,t.response.data),Error(`從候診清單中移除患者失敗(${t.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw t}},updateStatus:async(e,t)=>{try{return console.log(`正在更新預約狀態：ID=${e}, 狀態=${t}`),await nf("patch",`/appointments/${e}/status`,{status:t})}catch(t){if(console.error(`更新預約狀態失敗：ID=${e}`,t),t.response)throw console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應數據: `,t.response.data),Error(`更新預約狀態失敗(${t.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw t}},createFollowUp:async e=>{try{return console.log("正在創建覆診預約:",e),await nf("post","/appointments",e)}catch(e){if(console.error("創建覆診預約失敗:",e),e.response)throw console.error(`API響應狀態: ${e.response.status}`),console.error(`請求URL: ${e.config?.url}`),console.error(`回應數據: `,e.response.data),Error(`創建覆診預約失敗(${e.response.status}): 可能是程式邏輯錯誤，請通知技術人員`);throw e}}},ny={getAllModernDiseases:async()=>{try{console.log("正在獲取所有現代病名資料");let e=await nf("get","/reference-data/modern-diseases");return e?.data||[]}catch(e){return console.error("獲取現代病名資料失敗:",e),[]}},getModernDiseaseTree:async()=>{try{return console.log("正在獲取現代病名樹狀數據"),await nf("get","/reference-data/modern-disease-tree")||[]}catch(e){return console.error("獲取現代病名樹狀數據失敗:",e),[]}},getAllCMSyndromes:async()=>{try{console.log("正在獲取所有中醫證候資料");let e=await nf("get","/reference-data/cm-syndromes");return e?.data||[]}catch(e){return console.error("獲取中醫證候資料失敗:",e),[]}},getCMSyndromeTree:async()=>{try{return console.log("正在獲取中醫證候樹狀數據"),await nf("get","/reference-data/cm-syndrome-tree")||[]}catch(e){return console.error("獲取中醫證候樹狀數據失敗:",e),[]}},getAllTreatmentPrinciples:async()=>{try{console.log("正在獲取所有中醫治則資料");let e=await nf("get","/reference-data/tcm-principles");return e?.data||[]}catch(e){return console.error("獲取中醫治則資料失敗:",e),[]}},getTreatmentPrincipleTree:async()=>{try{return console.log("正在獲取中醫治則樹狀數據"),await nf("get","/reference-data/cm-treatment-rule-tree")||[]}catch(e){return console.error("獲取中醫治則樹狀數據失敗:",e),[]}},getCMSyndromeAutocomplete:async()=>{try{return console.log("正在獲取中醫辨證自動完成數據"),await nf("get","/reference-data/cm-syndrome-autocomplete")||[]}catch(e){return console.error("獲取中醫辨證自動完成數據失敗:",e),[]}},getModernDiseaseAutocomplete:async()=>{try{return console.log("正在獲取現代病名自動完成數據"),await nf("get","/reference-data/modern-disease-autocomplete")||[]}catch(e){return console.error("獲取現代病名自動完成數據失敗:",e),[]}},getTreatmentPrincipleAutocomplete:async()=>{try{return console.log("正在獲取中醫治則自動完成數據"),await nf("get","/reference-data/cm-treatment-rule-autocomplete")||[]}catch(e){return console.error("獲取中醫治則自動完成數據失敗:",e),[]}},searchModernDiseases:async e=>{try{if(console.log(`正在搜尋現代病名: ${e}`),!e)return[];let t=await nf("get",`/reference-data/search/modern-diseases?q=${encodeURIComponent(e)}`);return t?.data||[]}catch(t){return console.error(`搜尋現代病名失敗: ${e}`,t),[]}},searchCMSyndromes:async e=>{try{if(console.log(`正在搜尋中醫證候: ${e}`),!e)return[];let t=await nf("get",`/reference-data/search/cm-syndromes?q=${encodeURIComponent(e)}`);return t?.data||[]}catch(t){return console.error(`搜尋中醫證候失敗: ${e}`,t),[]}},searchTreatmentRules:async e=>{try{if(console.log(`正在搜尋中醫治則: ${e}`),!e)return[];let t=await nf("get",`/reference-data/search/tcm-principles?q=${encodeURIComponent(e)}`);return t?.data||[]}catch(t){return console.error(`搜尋中醫治則失敗: ${e}`,t),[]}},searchMedicines:async e=>{try{if(console.log(`正在搜尋中藥: ${e}`),nm&&nm.length>0){let t=nm.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.aliases?.some(t=>t.toLowerCase().includes(e.toLowerCase())));return console.log(`從已載入的中藥資料中找到 ${t.length} 筆結果`),t}try{let t=await fetch("/data/powder_ratio_price.json");if(t.ok){let r=(await t.json()).filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.aliases?.some(t=>t.toLowerCase().includes(e.toLowerCase())));return console.log(`從本地檔案搜尋中藥結果: ${r.length} 筆`),r}}catch(e){console.error("讀取或搜尋本地中藥數據失敗:",e)}let t=`/herbs?search=${encodeURIComponent(e)}&limit=50`;console.log(`使用中藥搜尋端點: ${t}`);let r=await nf("get",t);if(r?.items&&Array.isArray(r.items))return console.log(`API返回中藥搜尋結果: ${r.items.length} 筆`),r.items||[];if(Array.isArray(r))return console.log(`API返回中藥搜尋結果: ${r.length} 筆`),r;return console.warn("API返回的中藥搜尋結果格式不正確:",r),[]}catch(t){return console.error(`搜尋中藥失敗: ${e}`,t),[]}},getPowderRatioPrice:async()=>{try{try{console.log("嘗試從本地檔案獲取中藥資料");let e=await fetch("/data/powder_ratio_price.json");if(e.ok){let t=await e.json();return console.log("成功從本地檔案獲取中藥資料，共",t.length,"筆"),t&&t.length>0&&(nm=t),t}console.error("本地檔案獲取失敗:",e.statusText)}catch(e){console.error("讀取本地中藥數據失敗:",e)}console.log("正在從API獲取中藥粉末與飲片換算資料");let e=await nf("get","/herbs/powder-ratio-price");return console.log("成功從API獲取中藥資料，共",e.length,"筆"),e&&e.length>0&&(nm=e),e||[]}catch(e){console.error("從API獲取中藥粉末與飲片換算資料失敗:",e);try{console.log("再次嘗試從本地檔案獲取中藥資料");let e=await fetch("/data/powder_ratio_price.json");if(e.ok){let t=await e.json();return console.log("成功從本地檔案獲取中藥資料，共",t.length,"筆"),t&&t.length>0&&(nm=t),t}}catch(e){console.error("讀取本地中藥數據失敗:",e)}return[]}}},nx=({placeholder:e,onChange:t,loadOptions:r,value:n,defaultValue:o=[],className:s="",multiple:a=!0,disabled:c=!1,labelExtractor:u=e=>e.name||"",valueExtractor:d=e=>e.code||""})=>{let[p,m]=(0,l.useState)([]),[f,h]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),[v,y]=(0,l.useState)(o),[x,_]=(0,l.useState)(!1),w=(0,l.useCallback)(nl()(async e=>{if(!e||e.length<1){m([]);return}b(!0);try{let t=await r(e);m(t)}catch(e){console.error("搜尋選項失敗:",e),m([])}finally{b(!1)}},300),[r]),j=e=>{if(a){if(!v.some(t=>t.value===e.value)){let r=[...v,e];y(r),t(r)}}else y([e]),t([e]);h(""),m([]),_(!1)},N=e=>{let r=v.filter(t=>t.value!==e.value);y(r),t(r)};(0,l.useEffect)(()=>{n&&y(n)},[n]),(0,l.useEffect)(()=>()=>{w.cancel()},[w]),(0,l.useEffect)(()=>{let e=e=>{e.target.closest(".async-select-container")||_(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let O=e=>{if(e.label.includes(" - ")){let t=e.label.split(" - "),r=t[0].trim(),n=t[1].trim();return(0,i.jsxs)("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-medium",children:r}),i.jsx("span",{className:"text-gray-500 text-xs mt-1",children:n})]})}if(e.data&&e.data.brand){let t=e.data.brand,r={},n=null;return t.toLowerCase().includes("漢方")?(r={color:"#2563eb"},n=i.jsx("span",{className:"ml-1 px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:"漢方"})):t.toLowerCase().includes("海天")&&(r={color:"#16a34a"},n=i.jsx("span",{className:"ml-1 px-1 py-0.5 text-xs bg-green-100 text-green-800 rounded",children:"海天"})),(0,i.jsxs)("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-medium",children:e.label}),(0,i.jsxs)("div",{className:"flex items-center mt-1",children:[i.jsx("span",{className:"text-gray-500 text-xs",style:r,children:t}),n]})]})}return i.jsx("span",{children:e.label})};return(0,i.jsxs)("div",{className:`async-select-container relative w-full ${s}`,children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center w-full p-2 border border-gray-300 rounded-md focus-within:border-blue-500",children:[v.map(e=>(0,i.jsxs)("div",{className:"flex items-center m-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-md",children:[i.jsx("span",{className:"mr-1",children:e.label}),i.jsx("button",{type:"button",onClick:()=>N(e),className:"text-blue-500 hover:text-blue-700",children:"\xd7"})]},e.value)),i.jsx("input",{type:"text",value:f,onChange:e=>{let{value:t}=e.target;h(t),w(t),t.length>0&&_(!0)},placeholder:v.length>0?"":e,className:"flex-grow min-w-[100px] outline-none",disabled:c,onFocus:()=>_(!0),readOnly:!a&&v.length>0}),g&&i.jsx("div",{className:"ml-2 h-4 w-4 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"})]}),x&&p.length>0&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:p.map(e=>i.jsx("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100",onClick:()=>j(e),children:O(e)},e.value))}),x&&f&&!g&&0===p.length&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-2 text-center text-gray-500",children:"無符合結果"})]})};!function(e){e.NORMAL="normal",e.LOW="low",e.OUT_OF_STOCK="out_of_stock",e.UNKNOWN="unknown"}(a||(a={}));let n_=(0,l.forwardRef)(({initialValues:e,onSave:t},r)=>{let n={herbs:[],instructions:"",structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"},total_price:0,per_dose_price:0},[o,s]=(0,l.useState)(e||{...n,herbs:[x()]}),[a,c]=(0,l.useState)([]),[u,d]=(0,l.useState)(!1),[p,m]=(0,l.useState)({}),[f,h]=(0,l.useState)(!0),[g,b]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1);function x(){return{id:Date.now().toString(),code:"",name:"",brand:"",powder_amount:"",decoction_amount:"",price_per_gram:0,total_price:0,unit:"g",is_compound:!1,concentration_ratio:1,decoction_equivalent_per_g:1,inventory_status:"unknown",source:"manual"}}(0,l.useEffect)(()=>{(async()=>{y(!0);try{let e=await ny.getPowderRatioPrice();b(e),console.log("載入中藥資料成功，共",e.length,"筆")}catch(e){console.error("載入中藥資料失敗:",e)}finally{y(!1)}})()},[]),(0,l.useEffect)(()=>{let e=o.herbs.reduce((e,t)=>e+t.total_price,0),t=o.structured_instructions.total_days*o.structured_instructions.times_per_day*e;s(r=>({...r,total_price:t,per_dose_price:e}))},[o.herbs,o.structured_instructions.total_days,o.structured_instructions.times_per_day]);let _=async e=>{if(!e||e.length<1)return[];d(!0);try{if(g.length>0)return g.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.aliases?.some(t=>t.toLowerCase().includes(e.toLowerCase()))).map(e=>{let t=w(e);return{label:`${e.name} - ${e.brand||"未知品牌"}`,value:e.code,data:{...e,price_per_gram:t}}});return(await ny.searchMedicines(e)).map(e=>{let t=w(e);return{label:`${e.name} - ${e.brand||"未知品牌"}`,value:e.code,data:{...e,price_per_gram:t}}})}catch(e){return console.error("搜尋中藥失敗:",e),[]}finally{d(!1)}},w=e=>"number"==typeof e.price_per_gram&&!isNaN(e.price_per_gram)&&e.price_per_gram>0?e.price_per_gram:"number"!=typeof e.price||"number"!=typeof e.quantity_per_bottle||isNaN(e.price)||isNaN(e.quantity_per_bottle)||!(e.quantity_per_bottle>0)?0:e.price/e.quantity_per_bottle,j=async(e,t)=>{try{let r=await fetch("/api/v1/herbs/inventory/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({herb_code:e,required_powder_amount:t})});if(r.ok){let t=await r.json();m(r=>({...r,[e]:t})),s(r=>({...r,herbs:r.herbs.map(r=>{if(r.code===e){let e="normal";return!1===t.has_sufficient_stock&&(e=t.available_amount>0?"low":"out_of_stock"),{...r,inventory_status:e}}return r})}))}}catch(e){console.error("Error checking inventory:",e)}},N=(0,l.useMemo)(()=>nl()((e,t)=>j(e,t),500),[]);(0,l.useEffect)(()=>(o.herbs.forEach(e=>{if(e.code&&e.powder_amount){let t=parseFloat(e.powder_amount);!isNaN(t)&&t>0&&N(e.code,t)}}),()=>{N.cancel()}),[o.herbs,N]);let O=e=>{s(t=>({...t,herbs:t.herbs.filter(t=>t.id!==e)}))},S=(e,t)=>{if(0===t.length)return;let r=t[0].data;r&&s(t=>({...t,herbs:t.herbs.map(t=>{if(t.id===e){let e=w(r),n={...t,code:r.code,name:r.name,brand:r.brand||"",is_compound:r.is_compound||!1,ingredients:r.ingredients,registration_code:r.registration_code,concentration_ratio:r.concentration_ratio||1,decoction_equivalent_per_g:r.decoction_equivalent_per_g||1,price_per_gram:e,unit:r.unit||"g",source:t.source||"manual"};if(t.decoction_amount){let o=parseFloat(t.decoction_amount);if(!isNaN(o)){let t=C(o,r.decoction_equivalent_per_g,r.concentration_ratio);n.powder_amount=t.toFixed(1),n.total_price=t*e}}if(t.powder_amount&&!t.decoction_amount){let o=parseFloat(t.powder_amount);if(!isNaN(o)){let t=P(o,r.decoction_equivalent_per_g,r.concentration_ratio);n.decoction_amount=t.toFixed(1),n.total_price=o*e}}return n}return t})}))},C=(e,t,r)=>e/t*r,P=(e,t,r)=>e/r*t,I=(e,t)=>{s(r=>({...r,herbs:r.herbs.map(r=>{if(r.id===e){let e=parseFloat(t)||0,n="",o=e*(r.price_per_gram||0);return e>0&&(n=P(e,r.decoction_equivalent_per_g,r.concentration_ratio).toFixed(1)),{...r,powder_amount:t,decoction_amount:n,total_price:o}}return r})}))},M=(e,t)=>{s(r=>({...r,herbs:r.herbs.map(r=>{if(r.id===e){let e=parseFloat(t)||0,n="",o=0;if(e>0){let t=C(e,r.decoction_equivalent_per_g,r.concentration_ratio);n=t.toFixed(1),o=t*(r.price_per_gram||0)}return{...r,decoction_amount:t,powder_amount:n,total_price:o}}return r})}))},k=e=>{s(t=>({...t,instructions:e}))},D=(e,t)=>{let r="string"==typeof t?parseInt(t)||0:t;s(t=>({...t,structured_instructions:{...t.structured_instructions,[e]:r},instructions:`共${r}天，每日${t.structured_instructions.times_per_day}次，${t.structured_instructions.timing}`}))},$=e=>{s(t=>({...t,structured_instructions:{...t.structured_instructions,timing:e},instructions:`共${t.structured_instructions.total_days}天，每日${t.structured_instructions.times_per_day}次，${e}`}))},A=()=>({herbs:o.herbs.map(e=>({id:e.id,code:e.code,name:e.name,brand:e.brand,powder_amount:e.powder_amount,decoction_amount:e.decoction_amount,price_per_gram:e.price_per_gram,total_price:e.total_price,unit:e.unit,is_compound:e.is_compound,concentration_ratio:e.concentration_ratio,decoction_equivalent_per_g:e.decoction_equivalent_per_g,inventory_status:e.inventory_status,source:e.source,ingredients:e.ingredients})),instructions:o.instructions,structured_instructions:o.structured_instructions,total_price:o.total_price,per_dose_price:o.per_dose_price});(0,l.useImperativeHandle)(r,()=>({addHerb:e=>{if(o.herbs.some(t=>t.code===e.code||t.name===e.name)){alert(`處方中已存在相同藥材：${e.name}`);return}let t={id:Date.now().toString(),code:e.code||"",name:e.name||"",brand:e.brand||"",powder_amount:e.amount||"3",decoction_amount:"",price_per_gram:e.price_per_gram||0,total_price:parseFloat(e.amount||"3")*(e.price_per_gram||0)||0,unit:"g",is_compound:!1,concentration_ratio:e.concentration_ratio||1,decoction_equivalent_per_g:e.decoction_equivalent_per_g||1,inventory_status:"unknown",source:e.source||"AI_suggested"};s(e=>({...e,herbs:[...e.herbs,t]}))},resetForm:()=>{console.log("重置中藥處方表單"),s({...n,herbs:[x()]})}}));let E=e=>e.name&&e.code?[{label:`${e.name} - ${e.brand||"未知品牌"}`,value:e.code,data:e}]:[],L=e=>{switch(e){case"normal":return"bg-green-100 text-green-800";case"low":return"bg-yellow-100 text-yellow-800";case"out_of_stock":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},V=e=>{switch(e){case"normal":return"庫存正常";case"low":return"庫存偏低";case"out_of_stock":return"庫存不足";default:return"庫存狀態未知"}};return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-md shadow",children:[i.jsx("h2",{className:"text-lg font-semibold mb-3 text-gray-800 border-b pb-2",children:"中藥處方"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(A())},className:"space-y-4",children:[(0,i.jsxs)("div",{className:"border rounded-md overflow-hidden shadow-sm",children:[(0,i.jsxs)("div",{className:"grid grid-cols-12 bg-gray-100 p-2 border-b font-medium text-sm",children:[i.jsx("div",{className:"col-span-3",children:"中藥名稱"}),i.jsx("div",{className:"col-span-2",children:"藥粉量 (g)"}),i.jsx("div",{className:"col-span-2",children:"飲片量 (g)"}),i.jsx("div",{className:"col-span-2",children:"品牌/規格"}),i.jsx("div",{className:"col-span-1 text-right pr-2",children:"單價 ($/g)"}),i.jsx("div",{className:"col-span-1 text-right pr-2",children:"小計 ($)"}),i.jsx("div",{className:"col-span-1 text-center",children:"操作"})]}),i.jsx("div",{className:"divide-y",children:o.herbs.map((e,t)=>{let r="AI_suggested"===e.source,n=L(e.inventory_status),o=V(e.inventory_status),s="";e.brand&&(e.brand.toLowerCase().includes("漢方")?s="bg-blue-50":e.brand.toLowerCase().includes("海天")?s="bg-green-50":e.brand.toLowerCase().includes("香港中文大學")&&(s="bg-yellow-50"));let a=!e.name||!e.code,l=a?"搜尋並選擇藥材":"搜尋中藥名稱";return(0,i.jsxs)("div",{className:`grid grid-cols-12 p-2 items-center text-sm ${r?"bg-green-50":s}`,children:[(0,i.jsxs)("div",{className:"col-span-3 pr-2 relative",children:[r&&i.jsx("span",{className:"absolute -left-1 -top-1 z-10 text-xs bg-green-500 text-white px-1 py-0.5 rounded-full",children:"AI"}),i.jsx(nx,{placeholder:l,loadOptions:_,onChange:t=>S(e.id,t),value:E(e),multiple:!1,className:"w-full",disabled:!1}),e.is_compound&&e.ingredients&&e.ingredients.length>0&&(0,i.jsxs)("div",{className:"mt-1 p-1 bg-gray-50 text-xs rounded-md",children:[i.jsx("div",{className:"font-medium text-gray-700",children:"複方成分:"}),i.jsx("ul",{className:"list-disc pl-3",children:e.ingredients.map((e,t)=>(0,i.jsxs)("li",{children:[e.name," ",e.amount,"g"]},t))})]})]}),i.jsx("div",{className:"col-span-2 pr-2",children:i.jsx("input",{type:"text",value:e.powder_amount,onChange:t=>I(e.id,t.target.value),placeholder:"藥粉量",className:"w-full p-2 border border-gray-300 rounded-md",disabled:a})}),i.jsx("div",{className:"col-span-2 pr-2",children:i.jsx("input",{type:"text",value:e.decoction_amount,onChange:t=>M(e.id,t.target.value),placeholder:"飲片量",className:"w-full p-2 border border-gray-300 rounded-md",disabled:a})}),i.jsx("div",{className:"col-span-2 pr-2 text-xs",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[e.brand?(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium",children:e.brand}),e.brand.toLowerCase().includes("漢方")&&i.jsx("span",{className:"ml-1 px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:"漢方"}),e.brand.toLowerCase().includes("海天")&&i.jsx("span",{className:"ml-1 px-1 py-0.5 text-xs bg-green-100 text-green-800 rounded",children:"海天"})]}):i.jsx("span",{className:"font-medium text-gray-500",children:"未知品牌"}),!a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"text-gray-500",children:["濃縮比: ",e.concentration_ratio,":1"]}),i.jsx("span",{className:`mt-1 px-1.5 py-0.5 rounded-full text-center ${n}`,children:o})]})]})}),i.jsx("div",{className:"col-span-1 pr-2 text-right font-medium",children:(e.price_per_gram||0).toFixed(2)}),i.jsx("div",{className:"col-span-1 pr-2 text-right font-medium",children:(e.total_price||0).toFixed(2)}),i.jsx("div",{className:"col-span-1 flex justify-center",children:i.jsx("button",{type:"button",onClick:()=>O(e.id),className:"text-red-500 hover:text-red-700 w-6 h-6 flex items-center justify-center rounded-full hover:bg-red-100",title:"刪除此藥材",children:"\xd7"})})]},e.id)})}),i.jsx("div",{className:"p-3 bg-gray-50 flex justify-center",children:(0,i.jsxs)("button",{type:"button",onClick:()=>{s(e=>({...e,herbs:[...e.herbs,x()]}))},className:"px-4 py-1.5 text-sm bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-md shadow-sm flex items-center",children:[i.jsx("span",{className:"mr-1 font-bold",children:"+"})," 新增藥材"]})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"服法"}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("span",{className:"mr-2",children:"共"}),i.jsx("select",{value:o.structured_instructions.total_days,onChange:e=>D("total_days",e.target.value),className:"p-1.5 border border-gray-300 rounded-md w-16 text-center",children:[1,2,3,4,5,6,7,8,9,10,14,21,28].map(e=>i.jsx("option",{value:e,children:e},e))}),i.jsx("span",{className:"ml-2",children:"天"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("span",{className:"mr-2",children:"每日"}),i.jsx("select",{value:o.structured_instructions.times_per_day,onChange:e=>D("times_per_day",e.target.value),className:"p-1.5 border border-gray-300 rounded-md w-16 text-center",children:[1,2,3,4].map(e=>i.jsx("option",{value:e,children:e},e))}),i.jsx("span",{className:"ml-2",children:"次"})]}),i.jsx("div",{className:"flex items-center",children:(0,i.jsxs)("select",{value:o.structured_instructions.timing,onChange:e=>$(e.target.value),className:"p-1.5 border border-gray-300 rounded-md",children:[i.jsx("option",{value:"早晚服",children:"早晚服"}),i.jsx("option",{value:"午晚服",children:"午晚服"}),i.jsx("option",{value:"三餐服",children:"三餐服"}),i.jsx("option",{value:"早中晚服",children:"早中晚服"}),i.jsx("option",{value:"睡前服",children:"睡前服"}),i.jsx("option",{value:"飯前服",children:"飯前服"}),i.jsx("option",{value:"飯後服",children:"飯後服"}),i.jsx("option",{value:"自行安排",children:"自行安排"})]})})]}),i.jsx("input",{type:"text",value:o.instructions,onChange:e=>k(e.target.value),placeholder:"自定義服法說明",className:"w-full p-2 border border-gray-300 rounded-md mt-2"})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"showPriceInfo",checked:f,onChange:()=>h(!f),className:"mr-2"}),i.jsx("label",{htmlFor:"showPriceInfo",className:"text-sm text-gray-700",children:"顯示價格信息"})]}),f&&(0,i.jsxs)("div",{className:"text-right p-2 bg-blue-50 rounded-md space-y-1",children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-blue-600",children:["每服處方價錢: ",(0,i.jsxs)("span",{children:[o.per_dose_price.toFixed(2)," HKD"]})]}),(0,i.jsxs)("p",{className:"text-xl font-bold text-blue-700",children:["處方總價: ",(0,i.jsxs)("span",{children:[o.total_price.toFixed(2)," HKD"]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{try{if(0===o.herbs.length){alert("處方中沒有藥材，無法儲存模板");return}let e=prompt("請輸入處方模板名稱:");if(!e)return;let t=localStorage.getItem("prescription_templates"),r=t?JSON.parse(t):[],n={id:Date.now().toString(),name:e,herbs:o.herbs,instructions:o.instructions,structured_instructions:o.structured_instructions,created_at:new Date().toISOString()};localStorage.setItem("prescription_templates",JSON.stringify([...r,n])),alert("處方模板儲存成功")}catch(e){console.error("儲存處方模板失敗:",e),alert("儲存處方模板失敗")}},className:"text-sm text-blue-600 hover:underline",children:"儲存為處方模板"}),i.jsx("button",{type:"button",onClick:()=>{try{let e=localStorage.getItem("prescription_templates");if(!e){alert("沒有儲存的處方模板");return}let t=JSON.parse(e);if(0===t.length){alert("沒有儲存的處方模板");return}let r=t.map((e,t)=>`${t+1}. ${e.name}`).join("\n"),n=parseInt(prompt(`請選擇要載入的模板號碼:
${r}`)||"0")-1;if(isNaN(n)||n<0||n>=t.length){alert("選擇無效");return}let o=t[n];s({herbs:o.herbs,instructions:o.instructions,structured_instructions:o.structured_instructions,total_price:o.herbs.reduce((e,t)=>e+t.total_price,0)*o.structured_instructions.total_days*o.structured_instructions.times_per_day,per_dose_price:o.herbs.reduce((e,t)=>e+t.total_price,0)}),alert("處方模板載入成功")}catch(e){console.error("載入處方模板失敗:",e),alert("載入處方模板失敗")}},className:"text-sm text-blue-600 hover:underline",children:"載入處方模板"})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 shadow-sm",children:"儲存處方"})})]})]})});n_.displayName="HerbalPrescriptionForm";let nw=["正常","浮","沉","遲","數","滑","澀","虛","實","長","短","洪","微","緊","緩","弦","芤","革","牢","濡","弱","散","細","伏","動","促","結","代","大"],nj=["寸","關","尺","整體"],nN=["正常","柔嫩","老嫩適中","硬","老","嫩","榮潤","枯槁","光剝","乾燥","潤澤","裂紋","紫斑","瘀斑","齒痕","重舌","瘦小","黏膩","水滑"],nO=["正常舌","胖大舌","瘦薄舌","尖細舌","短小舌","痿軟舌","齒痕舌","裂紋舌","橫裂舌","腫脹舌","短縮舌","舌中凹陷舌","舌尖翹起舌","舌尖凹","舌體偏小舌","舌根腫大舌","舌體斜裂舌","卷縮舌","歪斜舌","歪扭舌","顫動舌","強硬舌","雙舌尖舌","點狀舌頭突出舌"],nS=["正常","淡紅","紅","絳","深紅","暗紅","淡白","蒼白","枯白","青紫","紫","淡紫","紅紫","絳紫","舌尖紅","尖邊紅","瘀斑","淡紫瘀堵","底瘀絡粗","底瘀絡怒張","底瘀絡紫紅","底瘀絡紫黑","底有瘀點"],nC=["正常","無苔","薄苔","厚苔","白苔","薄白苔","薄白潤苔","薄白滑苔","厚白","白膩苔","白滑膩苔","白黏膩苔","白厚膩苔","白厚鬆苔","白膩苔化燥","黃苔","薄黃苔","黃厚膩苔","黃膩苔","黃黏膩苔","黃滑苔","黃燥苔","黃瓣苔","黃膩苔化燥","黄厚黏腻苔","灰苔","灰白膩苔","灰黃膩苔","垢腻灰苔","黑苔","黑腻苔","焦黑苔","黑燥苔","膩苔","滑苔","乾苔","燥苔","潤苔","腐苔","剝苔","無根苔","膩苔中剝","類剝苔","地圖舌","鏡面舌","舌面潰瘍","舌底潰瘍","舌邊潰瘍","根部厚膩","薄膩","厚膩"],nP={正常:["正常"],偏軟型:["柔嫩","榮潤","潤澤","嫩"],偏硬型:["硬","老","老嫩適中"],萎縮型:["枯槁","光剝","乾燥","瘦小"],其他特徵:["黏膩","水滑","裂紋","瘀斑","紫斑","重舌","齒痕"]},nI={正常:["正常舌"],腫大型:["胖大舌","舌根腫大舌","腫脹舌"],萎縮型:["瘦薄舌","短小舌","痿軟舌","尖細舌","舌體偏小舌","短縮舌"],裂紋型:["裂紋舌","橫裂舌","舌體斜裂舌","齒痕舌"],歪斜型:["歪斜舌","歪扭舌"],強硬型:["強硬舌","卷縮舌"],其他特殊型:["舌尖翹起舌","舌尖凹","舌中凹陷舌","雙舌尖舌","點狀舌頭突出舌","顫動舌"]},nM={正常色:["正常","淡紅"],紅色系:["紅","深紅","暗紅","絳"],蒼白系:["淡白","蒼白","枯白"],紫色系:["青紫","紫","淡紫","紅紫","絳紫"],舌尖變化:["舌尖紅","尖邊紅"],舌底瘀絡:["底瘀絡粗","底瘀絡怒張","底瘀絡紫紅","底瘀絡紫黑","底有瘀點"],其他:["瘀斑","淡紫瘀堵"]},nk={正常:["正常"],無苔類:["無苔"],基本厚薄:["薄苔","厚苔"],白苔類:["白苔","薄白苔","薄白潤苔","薄白滑苔","厚白","白膩苔","白滑膩苔","白黏膩苔","白厚膩苔","白厚鬆苔","白膩苔化燥"],黃苔類:["黃苔","薄黃苔","黃厚膩苔","黃膩苔","黃黏膩苔","黃滑苔","黃燥苔","黃瓣苔","黃膩苔化燥","黄厚黏腻苔"],灰黑苔類:["灰苔","灰白膩苔","灰黃膩苔","垢腻灰苔","黑苔","黑腻苔","焦黑苔","黑燥苔"],剝苔類:["剝苔","膩苔中剝","類剝苔","地圖舌","鏡面舌"],特性類:["膩苔","滑苔","乾苔","燥苔","潤苔","腐苔","無根苔"],分佈特性:["舌面潰瘍","舌底潰瘍","舌邊潰瘍","根部厚膩","薄膩","厚膩"]},nD=(e=[],t=[])=>{let r={整體:1,寸:2,關:3,尺:4},n={};return t.forEach(e=>{n[e]=[]}),t.forEach(t=>{e.forEach(e=>{n[t].push({label:`${t}${e}`,value:`${t}${e}`})})}),Object.keys(n).sort((e,t)=>(r[e]||99)-(r[t]||99)).map(e=>({label:e,options:n[e]}))},n$=(e=[],t)=>{let r=[],n=new Set;Object.entries(t).forEach(([t,o])=>{let s=[];o.forEach(t=>{e.includes(t)&&(s.push({label:t,value:t}),n.add(t))}),s.length>0&&r.push({label:t,options:s})});let o=e.filter(e=>!n.has(e)).map(e=>({label:e,value:e}));return o.length>0&&r.push({label:"其他",options:o}),r},nA=()=>nD(nw,nj),nE=()=>n$(nN,nP),nL=()=>n$(nO,nI),nV=()=>n$(nS,nM),nR=()=>n$(nC,nk),nF=({initialValues:e={observation:"",leftPulse:[],rightPulse:[],tongueQuality:[],tongueShape:[],tongueColor:[],tongueCoating:[],menstrualPeriod:{startDate:"",endDate:""}},onSave:t,showMenstrualField:r=!1})=>{let[n,o]=(0,l.useState)(e),[s]=(0,l.useState)(nA()),[a]=(0,l.useState)(nE()),[c]=(0,l.useState)(nL()),[u]=(0,l.useState)(nV()),[d]=(0,l.useState)(nR()),p=(e,t)=>{let r=t.map(e=>e.value);o(t=>({...t,[e]:r}))},m=(e,t)=>{o(r=>({...r,[e]:t}))},f=(e,t)=>{o(r=>({...r,menstrualPeriod:{...r.menstrualPeriod,[e]:t}}))};return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-md shadow",children:[i.jsx("h2",{className:"text-lg font-semibold mb-3 text-gray-800 border-b pb-2",children:"醫師觀察"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(n)},className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"望診觀察"}),i.jsx("textarea",{value:n.observation,onChange:e=>m("observation",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"請輸入望診觀察內容",rows:3})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"左手脈象（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇左手脈象",options:s,value:n.leftPulse.map(e=>({label:e,value:e})),onChange:e=>p("leftPulse",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的脈象，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"右手脈象（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇右手脈象",options:s,value:n.rightPulse.map(e=>({label:e,value:e})),onChange:e=>p("rightPulse",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的脈象，可直接輸入新增"})})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"舌質（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇舌質",options:a,value:n.tongueQuality.map(e=>({label:e,value:e})),onChange:e=>p("tongueQuality",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的舌質，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"舌型（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇舌型",options:c,value:n.tongueShape.map(e=>({label:e,value:e})),onChange:e=>p("tongueShape",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的舌型，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"舌色（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇舌色",options:u,value:n.tongueColor.map(e=>({label:e,value:e})),onChange:e=>p("tongueColor",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的舌色，可直接輸入新增"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"舌苔（多選）"}),i.jsx("div",{children:i.jsx(r9,{placeholder:"從分類選擇舌苔",options:d,value:n.tongueCoating.map(e=>({label:e,value:e})),onChange:e=>p("tongueCoating",e),isMulti:!0,allowCreation:!0,className:"w-full",noOptionsMessage:"無符合的舌苔，可直接輸入新增"})})]})]}),r&&(0,i.jsxs)("div",{className:"border p-3 rounded-md bg-gray-50",children:[i.jsx("h3",{className:"text-md font-medium mb-2",children:"上次月經"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm text-gray-600",children:"起始日"}),i.jsx("input",{type:"date",value:n.menstrualPeriod?.startDate||"",onChange:e=>f("startDate",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm text-gray-600",children:"結束日"}),i.jsx("input",{type:"date",value:n.menstrualPeriod?.endDate||"",onChange:e=>f("endDate",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),i.jsx("div",{className:"space-y-1 flex items-end",children:(0,i.jsxs)("div",{className:"p-2 bg-white border border-gray-300 rounded-md w-full",children:[i.jsx("span",{className:"font-medium",children:(()=>{if(!n.menstrualPeriod?.startDate||!n.menstrualPeriod?.endDate)return 0;let e=new Date(n.menstrualPeriod.startDate);return Math.ceil(Math.abs(new Date(n.menstrualPeriod.endDate).getTime()-e.getTime())/864e5)+1})()})," 天"]})})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"儲存"})})]})]})},nT=({onSave:e,onPrint:t,onScheduleFollowUp:r,onNextPatient:n,onCopyLastPrescription:o,isLoading:s=!1})=>i.jsx("div",{className:"bg-white p-4 rounded-md shadow",children:(0,i.jsxs)("div",{className:"flex flex-wrap gap-3 justify-end",children:[(0,i.jsxs)("button",{type:"button",onClick:e,disabled:s,className:`px-5 py-2 rounded ${s?"bg-blue-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),s?"保存中...":"保存病歷"]}),(0,i.jsxs)("button",{type:"button",onClick:t,disabled:s,className:`px-5 py-2 rounded ${s?"bg-green-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),"列印藥方"]}),(0,i.jsxs)("button",{type:"button",onClick:r,disabled:s,className:`px-5 py-2 rounded ${s?"bg-purple-300 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"} text-white`,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),"預約覆診"]}),(0,i.jsxs)("button",{type:"button",onClick:n,disabled:s,className:`px-5 py-2 rounded ${s?"bg-gray-300 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700"} text-white`,children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:[i.jsx("path",{fillRule:"evenodd",d:"M10.293 15.707a1 1 0 010-1.414L14.586 10l-4.293-4.293a1 1 0 111.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z",clipRule:"evenodd"}),i.jsx("path",{fillRule:"evenodd",d:"M4.293 15.707a1 1 0 010-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z",clipRule:"evenodd"})]}),"下一位患者"]}),o&&i.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",title:"複製上次處方",children:i.jsx("span",{className:"flex items-center",children:"複製上次處方"})})]})}),nH=({records:e,onViewRecord:t,patientName:r})=>(0,i.jsxs)("div",{className:"bg-white rounded-md shadow overflow-hidden",children:[i.jsx("div",{className:"p-3 bg-green-500 text-white font-medium",children:r?`${r} 的過往病歷`:"過往病歷"}),i.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-10rem)]",children:e.length>0?i.jsx("div",{className:"divide-y",children:e.map(e=>(0,i.jsxs)("div",{className:"p-3 hover:bg-gray-100 cursor-pointer",onClick:()=>t(e.id),children:[i.jsx("div",{className:"font-medium mb-1 text-gray-800",children:e.date}),(0,i.jsxs)("div",{className:"text-sm text-gray-600 mb-1",children:[i.jsx("span",{className:"font-medium",children:"診斷: "}),e.diagnosis]}),(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"處方: "}),i.jsx("span",{className:"text-gray-500",children:e.prescription})]})]},e.id))}):i.jsx("div",{className:"p-4 text-center text-gray-500 italic",children:r?"此患者無過往病歷":"請先選擇患者"})})]}),nU=["頸椎","胸椎","腰椎","薦椎","尾椎","肩關節","肩胛骨","鎖骨","胸骨","肘關節","腕關節","指關節","髖關節","膝關節","踝關節","趾關節","骶髂關節","顳顎關節","枕骨","枕環關節","齒狀突","脊柱整體","骨盆整體","四肢整體","上肢","下肢","骶椎","椎體旋轉","側彎","關節錯位"],nz=["一重穴","三叉一穴","三叉三穴","三叉二穴","三叉神經點","三河穴","三焦俞","三神穴","三聖穴","三角灸穴","三重穴","三間","三陰交","三陽絡","上九里穴","上巨虛","上廉","上星","上曲穴","上泉穴","上瘤穴","上白穴","上脘","上里穴","上關","上髎","上高穴","下九里穴","下巨虛","下廉","下曲穴","下泉穴","下白穴","下脘","下關","下髎","下高穴","不容","丘墟","中九里穴","中力穴","中封","中府","中庭","中極","中樞","中泉穴","中注","中渚","中瀆","中白穴","中脘","中膂俞","中衝","中都","中間穴","中髎","乳中","乳根","二角明穴","二重穴","二間","五樞","五處","交信","京門","京骨","人士穴","人宗穴","人皇穴","人迎","伏兔","俞府","俠溪","俠白","偏歷","偏肩穴","側三里穴","側下三里","側間穴","僕參","光明","光明穴","兌端","內庭","內白穴","內通天穴","內通山穴","內通關穴","內金穴","內關","公孫","六完穴","其正穴","其角穴","其門穴","其黃穴","分枝上穴","分枝下穴","分枝中穴","分水穴","分白穴","分金穴","列缺","制污穴","前會穴","前谷","前頂","勞宮","厥陰俞","合谷","合金穴","合陽","周榮","命門","商丘","商曲","商陽","啞門","喉中穴","喉靈穴","四滿","四瀆","四白","四神聰穴","四縫穴","四腑一穴","四腑二穴","四花上穴","四花下穴","四花中穴","四花副穴","四花外穴","囟會","土昌穴","土水穴","土耳穴","土靈穴","地五會","地倉","地士穴","地宗穴","地機","地皇穴","外三關穴","外丘","外白穴","外耳穴","外關","外陵","大包","大巨","大敦","大杼","大椎","大橫","大白穴","大腸俞","大赫","大迎","大都","大鐘","大間穴","大陵","天井","天士穴","天宗","天宗穴","天容","天府","天柱","天樞","天池","天泉","天溪","天牖","天皇副穴","天皇穴","天突","天窗","天耳穴","天衝","天髎","天黃穴","天鼎","太乙","太淵","太溪","太白","太衝","太陽穴","失枕穴","失音穴","姐妹一穴","姐妹三穴","姐妹二穴","委中","委陽","婦科五穴","婦靈一穴","婦靈二穴","子宮穴","孔最","安眠穴","安脊穴","完骨","定喘穴","小海","小腸俞","小間穴","少商","少府","少海","少澤","少白穴","少衝","尺澤","居髎","屋翳","崑崙","州圓穴","州天穴","州崙穴","州昆穴","州銀穴","州靈穴","巨闕","巨骨","巨髎","帶脈","幽門","府舍","庫房","廉泉","建中穴","建力穴","建里","強間","彧中","後會穴","後溪","後頂","復原一穴","復原三穴","復原二穴","復溜","心俞","心常一穴","心常三穴","心常二穴","心膝穴","心門穴","心靈一穴","心靈三穴","心靈二穴","志室","急脈","意舍","感冒一穴","感冒二穴","懸樞","懸釐","懸鐘","懸顱","手三里","手五里","手五金穴","手千金穴","手解穴","扶突","承光","承山","承扶","承泣","承滿","承漿","承筋","承靈","指三重穴","指腎穴","指駟馬穴","攢竹","支正","支溝","日月","明黃穴","曲垣","曲差","曲池","曲泉","曲澤","曲陵穴","曲骨","曲鬢","會宗","會陰","會陽","期門","木一穴","木三穴","木二穴","木婦穴","木府穴","木斗穴","木昌穴","木梁穴","木火四穴","木炎一穴","木炎三穴","木炎二穴","木留穴","木硬穴","木耳穴","木關穴","本神","李白穴","束骨","梁丘","梁門","條口","極泉","橫骨","次髎","止涎五穴","正士穴","正宗穴","正會穴","正本穴","正營","正筋穴","正脊一穴","正脊三穴","正脊二穴","步廊","歷兌","歸來","殷門","氣戶","氣海","氣海俞","氣穴","氣舍","氣衝","水仙穴","水分","水曲穴","水泉","水海穴","水清穴","水源穴","水溝","水相穴","水突","水耳穴","水腰穴","水通穴","水道","水金穴","浮白","浮郄","海豹穴","消濼","液門","淵腋","清冷淵","湧泉","溫溜","滑肉門","漏谷","火串穴","火主穴","火包穴","火山穴","火府穴","火散穴","火昌穴","火星上穴","火星下穴","火梁穴","火硬穴","火耳穴","火腑海穴","火菊穴","火連穴","火陵穴","然谷","照海","牽正穴","犢鼻","狹心點","率谷","玉堂","玉枕","珠圓穴","璇璣","環跳","甲狀腺腫穴","申脈","瘛脈","白環俞","百會","皮膚穴","目窗","眉衝","睛明","督俞","瞳子髎","石門","石關","神堂","神封","神庭","神耳上穴","神耳下穴","神耳中穴","神肩穴","神藏","神道","神門","神闕","禾髎","秉風","秩邊","章門","筋縮","箕門","築賓","素髎","紫宮","結核穴","絕陽","絡卻","絲竹空","經渠","維道","總樞穴","缺盆","翳風","耳三穴","耳和髎","耳尖穴","耳門","聽宮","聽會","肓俞","肓門","肘髎","肝俞","肝門穴","肝靈穴","肩中俞","肩中穴","肩井","肩外俞","肩峰穴","肩貞","肩髃","肩髎","肺俞","肺心穴","肺氣腫點","肺金穴","胃俞","胃倉","背面穴","胞肓","胸鄉","脊中","脾俞","脾腫一穴","脾腫二穴","腎俞","腑快穴","腑腸穴","腕順一穴","腕順二穴","腕骨","腦戶","腦空","腫瘤穴","腰俞","腰痛點穴","腰陽關","腸門穴","腹哀","腹結","腹通谷","膀胱俞","膈俞","膈關","膏肓","膝眼穴","膝關","膝陽關","膺窗","膻中","膽俞","膽囊穴","膽穴","臂臑","臑俞","臑會","至陰","至陽","興奮穴","花骨一穴","花骨三穴","花骨四穴","華蓋","落枕穴","蠡溝","血海","行間","衝門","衝陽","角孫","解溪","解穴","譩譆","豐隆","足三里","足五里","足五金穴","足千金穴","足竅陰","足臨泣","足通骨","跗陽","踝靈穴","身柱","輒筋","迎香","通天","通天穴","通山穴","通心穴","通胃穴","通背穴","通腎穴","通里","通關穴","通靈穴","還巢穴","郄門","重仙穴","重子穴","重魁穴","金前上穴","金前下穴","金府穴","金昌穴","金梁穴","金津玉液穴","金耳穴","金門","鎮靜穴","長強","門金穴","開脾穴","間使","關元","關元俞","關衝","關門","阿是穴","附分","降壓穴","陰交","陰包","陰市","陰廉","陰谷","陰郄","陰都","陰陵泉","陶道","陷谷","陽交","陽池","陽溪","陽白","陽綱","陽谷","陽輔","陽陵泉","隱白","雙龍一穴","雙龍二穴","雲白穴","雲門","靈台","靈墟","靈道","靈骨穴","青靈","項緊穴","頭竅陰","頭維","頭臨泣","頰車","頷厭","顱息","顴髎","風市","風府","風池","風門","飛揚","食竇","養老","馬快水穴","馬金水穴","駟馬上穴","駟馬下穴","駟馬中穴","骨關穴","髀關","魂門","魄戶","魚際","鳩尾","鼻翼穴","齦交"],nq=["針灸","正骨","艾灸","天灸","穴位埋線","耳穴","其他手法"],nB=({initialValues:e={treatments:[{method:"",targets:[],id:"0"}]},onSave:t})=>{let[r,n]=(0,l.useState)(e),o=e=>{n(t=>({...t,treatments:t.treatments.filter(t=>t.id!==e)}))},s=(e,t)=>{n(r=>({...r,treatments:r.treatments.map(r=>r.id===e?{...r,method:t,targets:[]}:r)}))},a=(e,t)=>{n(r=>({...r,treatments:r.treatments.map(r=>r.id===e?{...r,targets:[...r.targets,t]}:r)}))},c=(e,t)=>{n(r=>({...r,treatments:r.treatments.map(r=>r.id===e?{...r,targets:r.targets.filter(e=>e!==t)}:r)}))},u=(e,t)=>{n(r=>({...r,treatments:r.treatments.map(r=>r.id===e?{...r,targets:[t]}:r)}))},d=e=>{switch(e){case"正骨":return nU;case"針灸":case"艾灸":case"天灸":case"穴位埋線":case"耳穴":return nz;default:return[]}};return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-md shadow",children:[i.jsx("h2",{className:"text-lg font-semibold mb-3 text-gray-800 border-b pb-2",children:"中醫治療方法"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(r)},className:"space-y-4",children:[i.jsx("div",{className:"space-y-4",children:r.treatments.map((e,t)=>(0,i.jsxs)("div",{className:"border rounded-md p-3 bg-gray-50",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsxs)("h3",{className:"font-medium",children:["治療方法 ",t+1]}),r.treatments.length>1&&i.jsx("button",{type:"button",onClick:()=>o(e.id),className:"text-red-500 hover:text-red-700",children:"移除"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm text-gray-600",children:"方法類別"}),i.jsx(ns,{options:nq,placeholder:"請選擇治療方法",value:e.method,onSelect:t=>s(e.id,t),className:"border-gray-300"})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm text-gray-600",children:"正骨"===e.method?"部位（多選）":"穴位（多選）"}),"其他手法"===e.method?i.jsx("input",{type:"text",value:e.targets[0]||"",onChange:t=>u(e.id,t.target.value),placeholder:"請輸入治療部位或方法描述",className:"w-full p-2 border border-gray-300 rounded-md"}):e.method?i.jsx(ns,{options:d(e.method),placeholder:`請選擇${"正骨"===e.method?"部位":"穴位"}`,onSelect:t=>a(e.id,t),multiple:!0,selectedItems:e.targets,onRemove:t=>c(e.id,t),className:"border-gray-300"}):i.jsx("div",{className:"p-2 border border-gray-200 bg-gray-100 rounded-md text-gray-500",children:"請先選擇治療方法"})]})]})]},e.id))}),i.jsx("div",{className:"flex justify-center",children:i.jsx("button",{type:"button",onClick:()=>{n(e=>({...e,treatments:[...e.treatments,{method:"",targets:[],id:Date.now().toString()}]}))},className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-md",children:"+ 新增治療方法"})}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"儲存"})})]})]})},nW=({patients:e,onSelectPatient:t,currentPatientId:r,onRefresh:n})=>{let o=!e||0===e.length,s=e=>{if(!e)return"未知";try{let t=new Date(e),r=new Date;if(isNaN(t.getTime()))return"時間格式錯誤";let n=r.getTime()-t.getTime(),o=Math.floor(n/6e4);if(o<1)return"剛剛";if(o<60)return`${o} 分鐘`;return`${Math.floor(o/60)} 小時 ${o%60} 分鐘`}catch(e){return console.error("計算等候時間出錯:",e),"計算錯誤"}};return(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,i.jsxs)("div",{className:"bg-blue-600 text-white px-4 py-2 font-bold flex justify-between items-center",children:[i.jsx("span",{children:"候診名單"}),n&&i.jsx("button",{onClick:n,className:"text-white text-sm bg-blue-500 hover:bg-blue-700 rounded px-2 py-1",title:"刷新候診名單",children:"刷新"})]}),o?(0,i.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[i.jsx("p",{className:"mb-2",children:"目前沒有候診患者"}),i.jsx("p",{className:"text-sm",children:"請確認是否有今日掛號患者"}),n&&i.jsx("button",{onClick:n,className:"mt-2 text-blue-500 hover:text-blue-700 text-sm underline",children:"點擊刷新候診名單"})]}):i.jsx("ul",{className:"divide-y divide-gray-200",children:e.map(e=>i.jsx("li",{className:`cursor-pointer transition-colors duration-150 ${r===e.id?"bg-blue-100":e.is_contagious?"bg-yellow-50 hover:bg-yellow-100":e.is_troublesome?"bg-red-50 hover:bg-red-100":"hover:bg-blue-50"}`,onClick:()=>t(e.id),children:i.jsx("div",{className:"px-4 py-3",children:(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center",children:[i.jsx("span",{className:"text-lg font-medium text-gray-800",children:e.chinese_name||e.name}),e.doctor_name&&i.jsx("span",{className:"ml-2 text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded-full",children:e.doctor_name})]}),(0,i.jsxs)("span",{className:"text-gray-500 text-sm block",children:["等候時間: ",e.waiting_since_timestamp?s(e.waiting_since_timestamp):e.waitingSince]}),e.chief_complaint&&(0,i.jsxs)("span",{className:"text-xs text-gray-600 block mt-1 line-clamp-1",children:["主訴: ",e.chief_complaint]}),e.special_note&&(0,i.jsxs)("span",{className:"text-xs font-semibold text-orange-600 block mt-1 line-clamp-1",children:["註記: ",e.special_note]})]}),(0,i.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[e.isFirstVisit?i.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 border border-green-200 whitespace-nowrap",children:"初診"}):i.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 border border-blue-200 whitespace-nowrap",children:"覆診"}),1===e.is_contagious&&(0,i.jsxs)("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800 border border-yellow-200 whitespace-nowrap flex items-center",children:[i.jsx("svg",{className:"h-3 w-3 mr-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01M12 19A7 7 0 1 0 12 5a7 7 0 0 0 0 14Z"})}),"傳染病"]}),1===e.is_troublesome&&(0,i.jsxs)("span",{className:"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800 border border-red-200 whitespace-nowrap flex items-center",children:[i.jsx("svg",{className:"h-3 w-3 mr-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"麻煩症"]})]})]})})},e.id))})]})},nJ={getRecommendations:async(e,t)=>{try{console.log("正在獲取 AI 用藥建議",{modernDiagnosis:e,cmSyndrome:t});let r=new URLSearchParams;e&&r.append("modern_diagnosis",e),t&&r.append("cm_syndrome",t);let n=`/ai/recommendations?${r.toString()}`,o=(0,nu.l9)(n);console.log(`AI 建議 API 請求 URL: ${o}`);let s=await nc.Z.get(o,{timeout:1e4});return console.log("AI 用藥建議響應:",s.data),s.data}catch(e){return console.error("獲取 AI 用藥建議失敗:",e),{suggestions:[]}}}},nG=({modernDiagnosis:e=[],cmSyndrome:t=[],onAddHerb:r})=>{let[n,o]=(0,l.useState)([]),[s,a]=(0,l.useState)(!1),[c,u]=(0,l.useState)("suggestions");(0,l.useEffect)(()=>{(e.length>0||t.length>0)&&r&&d()},[e,t]);let d=async()=>{if(r){a(!0);try{let r=e.join(","),n=t.join(","),s=await nJ.getRecommendations(r,n);o(s.suggestions||[])}catch(e){console.error("獲取 AI 用藥建議失敗:",e),o([])}finally{a(!1)}}},p=e=>{r&&r(e)};return(0,i.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-300 rounded-md",id:"ai-suggestions",children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[i.jsx("span",{className:"text-gray-700 font-medium",children:"\uD83C\uDF3F AI 用藥建議"}),i.jsx("span",{className:"ml-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"即將推出 \uD83D\uDE80"})]}),i.jsx("div",{className:"text-gray-500 text-sm italic",children:i.jsx("p",{children:"未來將根據患者診斷資料，智能推薦適合的中藥處方。"})}),(0,i.jsxs)("div",{className:"flex border-b mb-2",children:[i.jsx("button",{className:`px-3 py-1 ${"suggestions"===c?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"}`,onClick:()=>u("suggestions"),children:"藥材建議"}),i.jsx("button",{className:`px-3 py-1 ${"analysis"===c?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"}`,onClick:()=>u("analysis"),children:"處方分析"})]}),s?(0,i.jsxs)("div",{className:"mt-2 flex items-center justify-center py-2",children:[i.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 rounded-full border-t-transparent"}),i.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"正在獲取建議..."})]}):n.length>0?(0,i.jsxs)("div",{className:"mt-2",children:[i.jsx("div",{className:"text-sm font-medium mb-1",children:"推薦用藥:"}),i.jsx("div",{className:"space-y-1",children:n.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:[(0,i.jsxs)("div",{children:[i.jsx("span",{className:"font-medium",children:e.name}),(0,i.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["(",e.recommended_amount,"g)"]}),e.reason&&i.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:e.reason})]}),i.jsx("button",{type:"button",onClick:()=>p(e),className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded hover:bg-green-200",children:"加入處方"})]},t))})]}):null]})},nY=e=>e.toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),nZ=e=>{if(!e)return"不詳";let t=new Date(e),r=new Date,n=r.getFullYear()-t.getFullYear();return(r.getMonth()<t.getMonth()||r.getMonth()===t.getMonth()&&r.getDate()<t.getDate())&&n--,`${n}歲`};function nX(){let[e,t]=(0,l.useState)(null),[r,n]=(0,l.useState)(!1),[o,s]=(0,l.useState)(!1),[a,u]=(0,l.useState)([]),[d,p]=(0,l.useState)(null),[m,f]=(0,l.useState)([]),[h,g]=(0,l.useState)(null),[b,v]=(0,l.useState)(!1),[y,x]=(0,l.useState)({chiefComplaint:"",presentIllness:"",observation:{},diagnosis:{modernDiseases:[],cmSyndromes:[],cmPrinciple:""},prescription:[],treatmentMethods:[],prescription_instructions:"",prescription_structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"}}),[_,w]=(0,l.useState)({modernDiseases:[],cmSyndromes:[],cmPrinciple:[]}),j=c().useRef(null),N=e=>{let t={chiefComplaint:e?.chief_complaint||"",presentIllness:"",observation:{},diagnosis:{modernDiseases:[],cmSyndromes:[],cmPrinciple:""},prescription:[],treatmentMethods:[],prescription_instructions:"",prescription_structured_instructions:{total_days:7,times_per_day:2,timing:"早晚服"}};w({modernDiseases:[],cmSyndromes:[],cmPrinciple:[]}),x(t),j.current&&"function"==typeof j.current.resetForm&&j.current.resetForm(),console.log("已重置所有表單資料",t)};(0,l.useEffect)(()=>{d&&(N(d),S(d.id))},[d?.id]),(0,l.useEffect)(()=>{let e=async()=>{try{s(!0),g(null);let e=await nv.getWaitingList();console.log("獲取到候診名單:",e),e&&0!==e.length?(u(e),g(null)):(console.warn("候診名單為空或未獲取到數據"),u([]),g("目前沒有已掛號的病人在候診"))}catch(e){console.error("獲取候診名單失敗:",e),g("無法連接掛號系統，請確認網絡連接或聯繫技術支持"),u([])}finally{s(!1)}let t=setInterval(e,3e5);return()=>clearInterval(t)};e()},[]);let O=async()=>{try{s(!0),g(null);let e=await nv.getWaitingList();console.log("手動刷新獲取到候診名單:",e),e&&0!==e.length?(u(e),g(null)):(console.warn("候診名單為空或未獲取到數據"),g("目前沒有已掛號的病人在候診區"),u([]))}catch(e){console.error("手動刷新候診名單失敗:",e),g("刷新候診名單失敗，請確認掛號系統是否正常運作")}finally{s(!1)}};(0,l.useEffect)(()=>{let e=setInterval(()=>{if(d&&y)try{localStorage.setItem(`draft_${d.id}`,JSON.stringify({formData:y,rawDiagnosisData:_,timestamp:new Date().toISOString()})),console.log("表單數據已自動保存")}catch(e){console.error("自動保存表單數據失敗:",e)}},6e4);return()=>clearInterval(e)},[d,y,_]);let S=e=>{try{let t=localStorage.getItem(`draft_${e}`);if(!t)return console.log(`無草稿資料，患者 ID: ${e}`),!1;let r=JSON.parse(t);if(!r||!r.formData||!r.timestamp)return console.error("草稿資料格式不正確"),!1;let n=new Date(r.timestamp);if(isNaN(n.getTime()))return console.error("草稿時間戳格式不正確"),!1;if(new Date().getTime()-n.getTime()<864e5&&window.confirm(`發現${nY(n)}的未完成記錄，是否恢復？`))return console.log("載入草稿資料",r.formData),x(r.formData),r.rawDiagnosisData&&w(r.rawDiagnosisData),!0;return console.log("草稿未載入：用戶拒絕或草稿過期"),!1}catch(e){return console.error("載入草稿失敗:",e),!1}},C=async e=>{try{s(!0),g(null);let t=a.find(t=>t.patient_id===e);if(!t)throw Error(`候診名單中找不到對應患者，ID: ${e}`);console.log("獲取患者詳細資料，患者ID:",e);try{let r=await ng.getPatientById(e);console.log("獲取到患者資料:",r);let o=1===t.is_contagious,s=1===t.is_troublesome,a=t.special_note||r.special_note||"";p({...r,isContagious:o,isTroublesome:s,isFirstVisit:t.isFirstVisit||!1,special_note:a}),n("女"===r.gender);try{let t=await nh.getPatientRecords(e);console.log("獲取到過往病歷:",t);let r=t.map(e=>({id:e.id.toString(),date:new Date(e.created_at).toLocaleDateString("zh-TW"),diagnosis:e.diagnoses&&e.diagnoses.length>0&&`${e.diagnoses[0].modern_diseases?.join("、")||""} ${e.diagnoses[0].cm_syndromes?.join("、")||""}`.trim()||"無診斷",prescription:e.prescriptions&&e.prescriptions.length>0&&e.prescriptions[0].herbs&&e.prescriptions[0].herbs.length>0?e.prescriptions[0].herbs.map(e=>e.herb_name).join("、"):"無處方"}));f(r)}catch(e){console.error("獲取過往病歷失敗:",e),f([])}S(e)||N(r)}catch(t){console.error("獲取患者詳細資料API錯誤:",t),t.response&&(console.error(`API響應狀態: ${t.response.status}`),console.error(`請求URL: ${t.config?.url}`),console.error(`回應資料: `,t.response.data)),g(`無法載入患者詳細資料 (ID: ${e})：${t.message||"系統錯誤"}
          可能是程式邏輯錯誤，請聯繫技術人員並提供上述錯誤訊息。`),p(null),f([])}}catch(e){console.error("獲取患者詳細資料邏輯錯誤:",e),g("無法載入患者詳細資料，請刷新頁面或聯繫技術支持"),p(null),f([])}finally{s(!1)}},P=e=>{x(t=>({...t,prescription:e.herbs.map(e=>({id:e.id,name:e.name,code:e.code||"",amount:e.amount,powder_amount:e.powder_amount,decoction_amount:e.decoction_amount,brand:e.brand,price_per_gram:e.price_per_gram,total_price:e.total_price,unit:e.unit||"g",is_compound:e.is_compound})),prescription_instructions:e.instructions,prescription_structured_instructions:e.structured_instructions})),console.log("已更新中藥處方:",e)},I=async()=>{if(!d){L.error("請先選擇患者");return}try{s(!0),[y.diagnosis.modernDiseases.length>0?`現代病名: ${y.diagnosis.modernDiseases.join("、")}`:"",y.diagnosis.cmSyndromes.length>0?`中醫辨證: ${y.diagnosis.cmSyndromes.join("、")}`:"",y.diagnosis.cmPrinciple?`中醫治則: ${y.diagnosis.cmPrinciple}`:""].filter(Boolean).join("；");let e={patient_id:d.id,doctor_id:d.doctor_id||1,chief_complaint:nd(y.chiefComplaint),present_illness:nd(y.presentIllness),observation:nd(JSON.stringify(y.observation)),left_pulse:nd(y.observation.leftPulseStr||y.observation.leftPulse),right_pulse:nd(y.observation.rightPulseStr||y.observation.rightPulse),tongue_quality:nd(y.observation.tongueQualityStr||y.observation.tongueQuality),tongue_shape:nd(y.observation.tongueShapeStr||y.observation.tongueShape),tongue_color:nd(y.observation.tongueColorStr||y.observation.tongueColor),tongue_coating:nd(y.observation.tongueCoatingStr||y.observation.tongueCoating)};e.diagnosis={modern_diseases:y.diagnosis.modernDiseases||[],cm_syndromes:y.diagnosis.cmSyndromes||[],cm_principle:y.diagnosis.cmPrinciple||""},_&&Object.keys(_).length>0&&(e.diagnosis_structured={modernDiseases:_.modernDiseases||[],cmSyndromes:_.cmSyndromes||[],cmPrinciple:_.cmPrinciple||[]}),e.prescription={herbs:y.prescription&&y.prescription.length>0?y.prescription.map(e=>({herb_name:e.name,code:e.code,amount:e.powder_amount||"0",unit:nd(e.unit)||"g",structured_data:{price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,brand:nd(e.brand)||"",is_compound:e.is_compound||!1,code:e.code||""}})):[],instructions:y.prescription_instructions||"",structured_instructions:y.prescription_structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"}},e.treatment={treatment_items:y.treatmentMethods&&y.treatmentMethods.length>0?y.treatmentMethods.map((e,t)=>{let r=e.split(":",2);return{method:r[0].trim(),target:r.length>1?r[1].trim():"",description:"",sequence:t}}):[]},console.log("提交完整病歷數據:",e);let t=await nh.createRecord(e);console.log("病歷保存成功:",t);try{console.log(`嘗試從候診清單中移除患者 ID: ${d.id}`),await nv.removePatientFromWaitingList(d.id),console.log(`已從候診清單中移除患者 ID: ${d.id}`),O()}catch(e){console.error("從候診清單中移除患者失敗:",e)}let r=t.diagnoses&&t.diagnoses.length>0,n=t.prescriptions&&t.prescriptions.length>0,o=t.treatments&&t.treatments.length>0;if(r&&n&&o)L.success("病歷已成功完整保存，所有資料已寫入");else if(L.error("病歷已保存，但部分資料可能未完整寫入。請確認診斷、處方和治療方法是否正確顯示。"),console.warn("病歷儲存異常：",{診斷資料寫入:r?"成功":"失敗",處方資料寫入:n?"成功":"失敗",治療方法寫入:o?"成功":"失敗",診斷資料:t.diagnoses,處方資料:t.prescriptions,治療資料:t.treatments}),!r||!n||!o)try{let e=await nh.getRecordById(t.id);console.log("嘗試重新加載病歷記錄:",e);let r=e.diagnoses&&e.diagnoses.length>0,n=e.prescriptions&&e.prescriptions.length>0,o=e.treatments&&e.treatments.length>0;r&&n&&o?L.success("重新檢查後確認所有資料已正確保存"):console.warn("重新加載後仍有資料缺失:",{診斷資料:r?"存在":"缺失",處方資料:n?"存在":"缺失",治療資料:o?"存在":"缺失"})}catch(e){console.error("重新加載病歷失敗:",e)}}catch(e){console.error("保存病歷失敗:",e),alert("保存病歷失敗，請重試")}finally{s(!1)}},M=e=>{N(),t(e);let r=a.find(t=>t.id===e);r?C(r.patient_id):(console.error(`無法在候診名單中找到患者 ID: ${e}`),g("無法找到選定的患者，請刷新頁面重試"))},k=async e=>{try{s(!0);let t=await nh.getRecordById(e);if(console.log("病歷詳情:",t),t.client_diagnosis)w(t.client_diagnosis),x(e=>({...e,diagnosis:{modernDiseases:t.client_diagnosis.modernDiseases.map(e=>e.name||""),cmSyndromes:t.client_diagnosis.cmSyndromes.map(e=>e.name||""),cmPrinciple:t.client_diagnosis.cmPrinciple.map(e=>e.name||"").join("、")||""}}));else if(t.diagnoses&&t.diagnoses.length>0){let e=t.diagnoses[0],r={modernDiseases:e.modern_diseases?.map(e=>({code:"string"==typeof e?e:"",name:"string"==typeof e?e:""}))||[],cmSyndromes:e.cm_syndromes?.map(e=>({code:"string"==typeof e?e:"",name:"string"==typeof e?e:""}))||[],cmPrinciple:e.cm_principle?[{code:e.cm_principle,name:e.cm_principle}]:[]};w(r),x(e=>({...e,diagnosis:{modernDiseases:r.modernDiseases.map(e=>e.name||""),cmSyndromes:r.cmSyndromes.map(e=>e.name||""),cmPrinciple:r.cmPrinciple.map(e=>e.name||"").join("、")||""}}))}if(t.client_prescription&&t.client_prescription.herbs)x(e=>({...e,prescription:t.client_prescription.herbs,prescription_instructions:t.client_prescription.instructions||"",prescription_structured_instructions:t.client_prescription.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"}})),j.current&&"function"==typeof j.current.resetForm&&setTimeout(()=>{if(j.current){let{herbs:e}=t.client_prescription,r=e.reduce((e,t)=>e+(t.total_price||0),0),n=t.client_prescription.structured_instructions,o=n.total_days*n.times_per_day,s={herbs:e,instructions:t.client_prescription.instructions||"",structured_instructions:n,total_price:r*o,per_dose_price:r};j.current.resetForm(),P(s)}},100);else if(t.prescriptions&&t.prescriptions.length>0&&t.prescriptions[0].herbs){let e=t.prescriptions[0],r=e.herbs.map(e=>({id:Date.now().toString()+Math.random().toString(36).substring(2,9),code:e.structured_data?.code||"",name:e.herb_name,brand:e.structured_data?.brand||"",amount:e.amount,powder_amount:e.amount,decoction_amount:"",price_per_gram:e.structured_data?.price_per_gram||0,total_price:e.structured_data?.total_price||0,unit:e.unit||"g",is_compound:e.structured_data?.is_compound||!1}));x(t=>({...t,prescription:r,prescription_instructions:e.instructions||"",prescription_structured_instructions:e.structured_data?.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"}})),j.current&&"function"==typeof j.current.resetForm&&setTimeout(()=>{if(j.current){let t=r.reduce((e,t)=>e+(t.total_price||0),0),n={herbs:r,instructions:e.instructions||"",structured_instructions:e.structured_data?.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"},total_price:14*t,per_dose_price:t};j.current.resetForm(),P(n)}},100)}if(t.client_observation?x(e=>({...e,observation:t.client_observation})):(t.observation||t.left_pulse||t.right_pulse||t.tongue_quality)&&(t.left_pulse?.split("、"),t.right_pulse?.split("、"),t.tongue_quality?.split("、"),t.tongue_shape?.split("、"),t.tongue_color?.split("、"),t.tongue_coating?.split("、"),x(e=>({...e,observation:{...e.observation,leftPulse:t.left_pulse||"",rightPulse:t.right_pulse||"",tongueQuality:t.tongue_quality||"",tongueShape:t.tongue_shape||"",tongueColor:t.tongue_color||"",tongueCoating:t.tongue_coating||""}}))),t.client_treatment&&t.client_treatment.treatments)x(e=>({...e,treatmentMethods:t.treatmentMethods||[]}));else if(t.treatments&&t.treatments.length>0){let e=t.treatments[0];if(e.treatment_items&&e.treatment_items.length>0){let t=e.treatment_items.map(e=>`${e.method}${e.target?`: ${e.target}`:""}`);x(e=>({...e,treatmentMethods:t}))}}(t.chief_complaint||t.present_illness)&&x(e=>({...e,chiefComplaint:t.chief_complaint||"",presentIllness:t.present_illness||""})),L.success(`已載入 ${new Date(t.created_at).toLocaleDateString("zh-TW")} 的診療記錄`)}catch(t){console.error(`獲取病歷詳情失敗，ID: ${e}:`,t),L.error("獲取病歷詳情失敗")}finally{s(!1)}},D=async e=>{try{if(!d?.id){console.error("患者資料不存在");return}await ng.updatePatientMarkers(d.id,e),d&&p({...d,...e}),v(!1),L.success("患者特殊標記已更新")}catch(e){console.error("更新患者標記時出錯:",e),L.error("更新患者標記失敗")}};return i.jsx("div",{className:"min-h-screen bg-gray-100",children:(0,i.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[i.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-800",children:"中醫病歷系統"}),h&&(0,i.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",role:"alert",children:[i.jsx("p",{children:h}),!a.length&&i.jsx("div",{className:"mt-2",children:i.jsx("button",{onClick:O,className:"bg-red-200 hover:bg-red-300 text-red-800 px-3 py-1 rounded text-sm",children:"重新載入候診清單"})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,i.jsxs)("div",{className:"col-span-12 md:col-span-3",children:[i.jsx(nW,{patients:a,onSelectPatient:M,currentPatientId:e,onRefresh:O}),d&&i.jsx("div",{className:"mt-6",children:i.jsx(nH,{records:m,onViewRecord:k,patientName:d?.chinese_name})})]}),i.jsx("div",{className:"col-span-12 md:col-span-9 space-y-6",children:d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mb-6 bg-white p-4 rounded-lg shadow",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h2",{className:"text-xl font-bold",children:"患者信息"}),i.jsx("button",{onClick:()=>v(!b),className:"text-sm text-blue-600 hover:text-blue-800",children:b?"取消編輯":"編輯特殊標記"})]}),(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"姓名:"})," ",d?.chinese_name]}),(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"年齡:"})," ",nZ(d?.birth_date)]}),(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"性別:"})," ",d?.gender]}),(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"電話:"})," ",d?.phone_number]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"病歷號:"})," ",d?.id]}),(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"過敏藥物:"})," ",d?.drug_allergies?.join(", ")]}),(0,i.jsxs)("p",{className:"text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"既往疾病:"})," ",d?.basic_diseases?.join(", ")]})]})]}),i.jsx("div",{className:"mt-2",children:i.jsx(W,{isTroublesome:d?.isTroublesome?1:0,isContagious:d?.isContagious?1:0,specialNote:d?.special_note})})]}),b&&i.jsx(J,{isTroublesome:d?.isTroublesome?1:0,isContagious:d?.isContagious?1:0,specialNote:d?.special_note||"",onUpdate:D}),i.jsx(na,{initialChiefComplaint:d.chief_complaint||"",onSave:e=>{x(t=>({...t,chiefComplaint:e.chiefComplaint,presentIllness:e.presentIllness})),console.log("已更新主訴與現病史:",e)}}),i.jsx(nF,{onSave:e=>{let t={...e},r=e.leftPulse?.join("、")||"",n=e.rightPulse?.join("、")||"",o=e.tongueQuality?.join("、")||"",s=e.tongueShape?.join("、")||"",a=e.tongueColor?.join("、")||"",i=e.tongueCoating?.join("、")||"";x(l=>({...l,observation:{...t,leftPulse:e.leftPulse||[],rightPulse:e.rightPulse||[],tongueQuality:e.tongueQuality||[],tongueShape:e.tongueShape||[],tongueColor:e.tongueColor||[],tongueCoating:e.tongueCoating||[],leftPulseStr:r,rightPulseStr:n,tongueQualityStr:o,tongueShapeStr:s,tongueColorStr:a,tongueCoatingStr:i}})),console.log("已更新醫師觀察:",{...e,leftPulseStr:r,rightPulseStr:n,tongueQualityStr:o,tongueShapeStr:s,tongueColorStr:a,tongueCoatingStr:i})},showMenstrualField:r}),i.jsx(no,{initialValues:y.diagnosis,onSave:e=>{let t={modernDiseases:Array.isArray(e.modernDiseases)?e.modernDiseases:[],cmSyndromes:Array.isArray(e.cmSyndromes)?e.cmSyndromes:[],cmPrinciple:Array.isArray(e.cmPrinciple)?e.cmPrinciple:[]};w(t),x(e=>({...e,diagnosis:{modernDiseases:t.modernDiseases.map(e=>e.name||""),cmSyndromes:t.cmSyndromes.map(e=>e.name||""),cmPrinciple:t.cmPrinciple.map(e=>e.name||"").join("、")||""}})),console.log("已更新中醫診斷:",e)}}),i.jsx(nG,{modernDiagnosis:y.diagnosis.modernDiseases,cmSyndrome:y.diagnosis.cmSyndromes,onAddHerb:e=>{j.current&&"function"==typeof j.current.addHerb?j.current.addHerb({...e,source:"AI_suggested"}):console.warn("無法添加 AI 建議藥材：處方表單引用不可用")}}),i.jsx(n_,{initialValues:{herbs:y.prescription.map(e=>({id:e.id||Date.now().toString(),code:e.code||"",name:e.name||"",brand:e.brand||"",powder_amount:e.amount||"",decoction_amount:e.decoction_amount||"",price_per_gram:e.price_per_gram||0,total_price:e.total_price||0,unit:"g",is_compound:e.is_compound||!1,concentration_ratio:1,decoction_equivalent_per_g:1,inventory_status:"normal"})),instructions:y.prescription_instructions||"",structured_instructions:y.prescription_structured_instructions,per_dose_price:y.prescription.reduce((e,t)=>e+(t.total_price||0),0),total_price:y.prescription.reduce((e,t)=>e+(t.total_price||0),0)*(y.prescription_structured_instructions.total_days*y.prescription_structured_instructions.times_per_day)},onSave:P,ref:j}),i.jsx(nB,{onSave:e=>{x(t=>({...t,treatmentMethods:e.treatments.map(e=>`${e.method}${e.targets?.length>0?`: ${e.targets.join("、")}`:""}`)})),console.log("已更新治療方法:",e)}}),i.jsx(nT,{onSave:I,onPrint:()=>{if(!d){alert("請先選擇患者");return}alert("藥方已送出列印")},onScheduleFollowUp:()=>{if(!d){alert("請先選擇患者");return}alert("開啟預約覆診表單")},onNextPatient:()=>{if(0===a.length){alert("候診名單已空");return}if(e&&d)try{nv.removePatientFromWaitingList(d.id).then(()=>{console.log(`已從候診清單中移除患者 ID: ${d.id}`)}).catch(e=>{console.error("從候診清單中移除患者失敗:",e)})}catch(e){console.error("移至下一位患者時出錯:",e)}if(N(),e){let t=a.findIndex(t=>t.id===e);if(-1!==t&&t<a.length-1){M(a[t+1].id),setTimeout(()=>{O()},500);return}}a.length>0&&(M(a[0].id),setTimeout(()=>{O()},500))},onCopyLastPrescription:()=>{if(!d||0===m.length){alert("沒有可複製的處方");return}let e=m[0].id;s(!0),nh.getRecordById(e).then(e=>{if(e.prescription&&e.prescription.herbs){let t=e.prescription.herbs.map(e=>({id:Date.now().toString()+Math.random().toString(36).substring(2,9),code:e.structured_data?.code||"",name:e.herb_name,brand:e.structured_data?.brand||"",amount:e.amount,powder_amount:e.amount,decoction_amount:"",price_per_gram:e.structured_data?.price_per_gram||0,total_price:e.structured_data?.total_price||0,unit:e.unit||"g",is_compound:e.structured_data?.is_compound||!1})),r=e.prescription.structured_data?.structured_instructions||{total_days:7,times_per_day:2,timing:"早晚服"};t.reduce((e,t)=>e+(t.total_price||0),0),r.total_days,r.times_per_day,x(n=>({...n,prescription:t,prescription_instructions:e.prescription.instructions||"",prescription_structured_instructions:r})),alert("已成功複製上次處方")}else alert("無法複製上次處方，因為缺少結構化資料")}).catch(e=>{console.error("複製上次處方失敗:",e),alert("複製上次處方失敗")}).finally(()=>{s(!1)})},isLoading:o})]}):(0,i.jsxs)("div",{className:"bg-white p-6 rounded-md shadow text-center",children:[i.jsx("p",{className:"text-gray-500 mb-4",children:"請從候診名單中選擇患者"}),0===a.length&&!o&&(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"候診名單為空"}),i.jsx("button",{onClick:O,className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-md text-sm",children:"重新載入候診清單"})]}),o&&(0,i.jsxs)("div",{className:"flex justify-center items-center mt-4",children:[i.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{className:"ml-2 text-blue-600",children:"載入中..."})]})]})})]})]})})}},20984:(e,t,r)=>{"use strict";r.d(t,{l9:()=>o});var n=r(47665);let o=(e="")=>{let t=e.startsWith("/")?e:`/${e}`;return`https://clinic.aspiratcm.com/api/v1${t}`},s=n.Z.create({baseURL:o(),headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3});s.interceptors.request.use(e=>{if(console.log(`[API請求] ${e.method?.toUpperCase()} ${e.url}`),e.params&&console.log(`[請求參數] ${JSON.stringify(e.params)}`),e.data&&"string"!=typeof e.data)try{console.log(`[請求數據] ${JSON.stringify(e.data)}`)}catch{console.log("[請求數據] 無法序列化")}return e},e=>(console.error("[API請求錯誤]",e),Promise.reject(e))),s.interceptors.response.use(e=>(console.log(`[API響應] ${e.status} ${e.config.url}`),e),e=>{let t=e?.response?.status,r=e?.config?.url,n=e?.config?.method?.toUpperCase();return t?console.error(`[${n} ${r}] 錯誤 ${t}`,e.response.data):console.error("[API錯誤]",e.message),Promise.reject(e)})},61334:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>l});var n=r(25036);r(5023);let o=(0,r(86843).createProxy)(String.raw`/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/components/Navbar.tsx`),{__esModule:s,$$typeof:a}=o,i=o.default,l={title:"中醫診所管理系統",description:"診所預約管理系統"};function c({children:e}){return n.jsx("html",{lang:"zh-TW",children:(0,n.jsxs)("body",{suppressHydrationWarning:!0,className:"bg-gray-100 min-h-screen antialiased text-slate-800 font-sans",children:[n.jsx(i,{}),n.jsx("div",{className:"pt-16",children:e})]})})}},3794:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(25036);function o({children:e}){return n.jsx("section",{children:e})}r(40002)},37244:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>o,default:()=>a});let n=(0,r(86843).createProxy)(String.raw`/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/medical_record/page.tsx`),{__esModule:o,$$typeof:s}=n,a=n.default},5023:()=>{},71661:e=>{"use strict";e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},29894:e=>{"use strict";e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},38363:(e,t,r)=>{"use strict";var n=r(71661);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9529:e=>{"use strict";e.exports=function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},78513:e=>{"use strict";e.exports=function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},53388:(e,t,r)=>{"use strict";var n=r(71817);function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}e.exports=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},59335:(e,t,r)=>{"use strict";var n=r(82066),o=r(34471),s=r(39627);e.exports=function(e){var t=o();return function(){var r,o=n(e);if(t){var a=n(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return s(this,r)}},e.exports.__esModule=!0,e.exports.default=e.exports},97307:(e,t,r)=>{"use strict";var n=r(71817);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},47821:e=>{"use strict";function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},82066:e=>{"use strict";function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},82522:(e,t,r)=>{"use strict";var n=r(12070);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},34471:e=>{"use strict";function t(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(e.exports=t=function(){return!!r},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},81006:e=>{"use strict";e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},82784:e=>{"use strict";e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,s,a,i=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},27867:e=>{"use strict";e.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},44233:e=>{"use strict";e.exports=function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},45455:(e,t,r)=>{"use strict";var n=r(97307);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},67738:(e,t,r)=>{"use strict";var n=r(21815);e.exports=function(e,t){if(null==e)return{};var r,o,s=n(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s},e.exports.__esModule=!0,e.exports.default=e.exports},21815:e=>{"use strict";e.exports=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r},e.exports.__esModule=!0,e.exports.default=e.exports},39627:(e,t,r)=>{"use strict";var n=r(16347).default,o=r(9529);e.exports=function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports.default=e.exports},12070:e=>{"use strict";function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},13279:(e,t,r)=>{"use strict";var n=r(29894),o=r(82784),s=r(27979),a=r(27867);e.exports=function(e,t){return n(e)||o(e,t)||s(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},8238:e=>{"use strict";e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.__esModule=!0,e.exports.default=e.exports},81586:(e,t,r)=>{"use strict";var n=r(38363),o=r(81006),s=r(27979),a=r(44233);e.exports=function(e){return n(e)||o(e)||s(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},67872:(e,t,r)=>{"use strict";var n=r(16347).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},71817:(e,t,r)=>{"use strict";var n=r(16347).default,o=r(67872);e.exports=function(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},16347:e=>{"use strict";function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},27979:(e,t,r)=>{"use strict";var n=r(71661);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1638,7173,7665,8951],()=>r(98201));module.exports=n})();