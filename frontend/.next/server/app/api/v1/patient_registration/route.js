"use strict";(()=>{var e={};e.id=548,e.ids=[548],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},7529:(e,t,o)=>{o.r(t),o.d(t,{headerHooks:()=>h,originalPathname:()=>x,patchFetch:()=>q,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>f,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>j});var r={};o.r(r),o.d(r,{GET:()=>u,POST:()=>c});var s=o(5419),a=o(9108),n=o(9678),i=o(8070),l=o(3949),p=o(5638);async function u(e){try{let{searchParams:t}=new URL(e.url),o={};t.forEach((e,t)=>{o[t]=e});let r=(0,p.l9)("/patient_registration");console.log("患者登記代理GET請求到:",r),console.log("查詢參數:",o);let s={};e.headers.forEach((e,t)=>{"host"!==t&&(s[t]=e)}),s.Accept="application/json",console.log("請求頭:",s);let a=await l.Z.get(r,{params:o,headers:s,timeout:1e4});return console.log("後端回應:",a.status,typeof a.data),i.Z.json(a.data,{status:a.status})}catch(e){if(console.error("患者登記代理GET請求錯誤:",e.message),e.response)return console.error("錯誤狀態碼:",e.response.status),console.error("錯誤數據:",e.response.data),i.Z.json({detail:e.response.data?.detail||"請求處理失敗",message:e.message},{status:e.response.status});if(e.request)return console.error("沒有收到響應，請求發送失敗"),i.Z.json({detail:"無法連接到後端服務",message:e.message},{status:503});return i.Z.json({detail:"請求處理失敗",message:e.message},{status:500})}}async function c(e){try{let t=await e.json();console.log("患者登記 POST 請求數據:",t),t&&"object"==typeof t&&(!t.email||""===t.email||"undefined"===t.email||"string"==typeof t.email&&""===t.email.trim())&&(console.log("API 代理層處理: email 欄位為空，設置為 no@no.com"),t.email="no@no.com");let o=(0,p.l9)("/patient_registration/");console.log("患者登記代理 POST 請求到:",o),console.log("處理後的請求數據:",JSON.stringify(t));let r={};e.headers.forEach((e,t)=>{"host"!==t&&(r[t]=e)}),r["Content-Type"]="application/json",r.Accept="application/json",console.log("請求頭:",r);let s=await l.Z.post(o,t,{headers:r,timeout:15e3});return console.log("後端回應狀態:",s.status),console.log("後端回應數據:",s.data),i.Z.json(s.data,{status:s.status})}catch(e){if(console.error("處理患者登記 POST 請求錯誤:",e),e.response){let{status:t,data:o}=e.response;if(console.error(`後端回應錯誤 ${t}:`,o),422===t)return console.log("檢測到 422 驗證錯誤，完整錯誤數據:",o),i.Z.json(o,{status:t});return i.Z.json({detail:o.detail||"處理請求時發生錯誤",message:o.message||"後端服務錯誤"},{status:t})}return i.Z.json({detail:e.message||"無法連接到後端服務"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v1/patient_registration/route",pathname:"/api/v1/patient_registration",filename:"route",bundlePath:"app/api/v1/patient_registration/route"},resolvedPagePath:"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/api/v1/patient_registration/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:d,serverHooks:f,headerHooks:h,staticGenerationBailout:j}=g,x="/api/v1/patient_registration/route";function q(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:d})}},5638:(e,t,o)=>{o.d(t,{l9:()=>s});var r=o(3949);let s=(e="")=>{let t=e.startsWith("/")?e:`/${e}`;return`https://clinic.aspiratcm.com/api/v1${t}`},a=r.Z.create({baseURL:s(),headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3});a.interceptors.request.use(e=>{if(console.log(`[API請求] ${e.method?.toUpperCase()} ${e.url}`),e.params&&console.log(`[請求參數] ${JSON.stringify(e.params)}`),e.data&&"string"!=typeof e.data)try{console.log(`[請求數據] ${JSON.stringify(e.data)}`)}catch{console.log("[請求數據] 無法序列化")}return e},e=>(console.error("[API請求錯誤]",e),Promise.reject(e))),a.interceptors.response.use(e=>(console.log(`[API響應] ${e.status} ${e.config.url}`),e),e=>{let t=e?.response?.status,o=e?.config?.url,r=e?.config?.method?.toUpperCase();return t?console.error(`[${r} ${o}] 錯誤 ${t}`,e.response.data):console.error("[API錯誤]",e.message),Promise.reject(e)})}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[638,823],()=>o(7529));module.exports=r})();