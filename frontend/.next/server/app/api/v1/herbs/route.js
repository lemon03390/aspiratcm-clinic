"use strict";(()=>{var e={};e.id=3986,e.ids=[3986],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},74687:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>b,originalPathname:()=>y,patchFetch:()=>j,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>$});var o={};t.r(o),t.d(o,{GET:()=>d});var s=t(95419),a=t(69108),n=t(99678),i=t(57147),l=t.n(i),c=t(78070),p=t(71017),u=t.n(p),h=t(85638);async function d(e){let{searchParams:r}=e.nextUrl,t=r.get("search")||"",o=r.get("is_compound"),s=r.get("skip")||"0",a=r.get("limit")||"100",n=(0,h.l9)(`/herbs?skip=${s}&limit=${a}`);t&&(n+=`&search=${encodeURIComponent(t)}`),null!==o&&(n+=`&is_compound=${o}`),console.log("Fetching herbs from backend:",n);try{let e=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){console.error("Error fetching herbs:",e.statusText),console.log("Falling back to local file...");try{let e=u().join(process.cwd(),"public/data/powder_ratio_price.json");if(l().existsSync(e)){let r=JSON.parse(l().readFileSync(e,"utf8"));console.log(`Found ${r.length} herbs in local file`);let o=r;t&&(o=r.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.aliases?.some(e=>e.toLowerCase().includes(t.toLowerCase()))),console.log(`Filtered to ${o.length} herbs matching "${t}"`));let n=parseInt(s),i=parseInt(a),p=o.slice(n,n+i);return c.Z.json({items:p,total:o.length,page:Math.floor(n/i)+1,size:i})}}catch(e){console.error("Error reading local file:",e)}return c.Z.json({error:`Failed to fetch herbs: ${e.statusText}`},{status:e.status})}let r=await e.json();return c.Z.json(r)}catch(e){console.error("Error fetching herbs:",e);try{let e=u().join(process.cwd(),"public/data/powder_ratio_price.json");if(l().existsSync(e)){let r=JSON.parse(l().readFileSync(e,"utf8"));console.log(`Found ${r.length} herbs in local file`);let o=r;t&&(o=r.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.aliases?.some(e=>e.toLowerCase().includes(t.toLowerCase()))),console.log(`Filtered to ${o.length} herbs matching "${t}"`));let n=parseInt(s),i=parseInt(a),p=o.slice(n,n+i);return c.Z.json({items:p,total:o.length,page:Math.floor(n/i)+1,size:i})}}catch(e){console.error("Error reading local file:",e)}return c.Z.json({error:"Failed to fetch herbs"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v1/herbs/route",pathname:"/api/v1/herbs",filename:"route",bundlePath:"app/api/v1/herbs/route"},resolvedPagePath:"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/api/v1/herbs/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:x,headerHooks:b,staticGenerationBailout:$}=g,y="/api/v1/herbs/route";function j(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:f})}},85638:(e,r,t)=>{t.d(r,{l9:()=>s});var o=t(83949);let s=(e="")=>{let r=e.startsWith("/")?e:`/${e}`;return`https://clinic.aspiratcm.com/api/v1${r}`},a=o.Z.create({baseURL:s(),headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3});a.interceptors.request.use(e=>{if(console.log(`[API請求] ${e.method?.toUpperCase()} ${e.url}`),e.params&&console.log(`[請求參數] ${JSON.stringify(e.params)}`),e.data&&"string"!=typeof e.data)try{console.log(`[請求數據] ${JSON.stringify(e.data)}`)}catch{console.log("[請求數據] 無法序列化")}return e},e=>(console.error("[API請求錯誤]",e),Promise.reject(e))),a.interceptors.response.use(e=>(console.log(`[API響應] ${e.status} ${e.config.url}`),e),e=>{let r=e?.response?.status,t=e?.config?.url,o=e?.config?.method?.toUpperCase();return r?console.error(`[${o} ${t}] 錯誤 ${r}`,e.response.data):console.error("[API錯誤]",e.message),Promise.reject(e)})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,6206,3949],()=>t(74687));module.exports=o})();