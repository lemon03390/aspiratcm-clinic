"use strict";(()=>{var e={};e.id=502,e.ids=[502],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},9825:(e,t,o)=>{o.r(t),o.d(t,{headerHooks:()=>f,originalPathname:()=>P,patchFetch:()=>q,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>A});var s={};o.r(s),o.d(s,{GET:()=>c,POST:()=>u});var r=o(5419),n=o(9108),a=o(9678),i=o(8070),l=o(3949),p=o(5638);async function u(e){try{console.log("開始處理 /api/v1/appointments 的 POST 請求");let t=await e.json(),o=(0,p.l9)("/appointments/");console.log("代理POST請求到:",o),console.log("請求資料:",JSON.stringify(t,null,2));let s={};e.headers.forEach((e,t)=>{"host"!==t&&(s[t]=e)}),s["Content-Type"]="application/json",console.log("請求頭:",s);let r=await l.Z.post(o,t,{headers:s,timeout:1e4});return console.log("後端回應狀態:",r.status),console.log("後端回應數據:",r.data),i.Z.json(r.data,{status:r.status})}catch(e){if(console.error("代理POST請求錯誤詳細信息:",e),e.response){if(console.error("錯誤狀態碼:",e.response.status),console.error("錯誤數據:",e.response.data),422===e.response.status){console.error("驗證錯誤詳情:",e.response.data.detail);let t=(e.response.data.detail||[]).map(e=>`${e.loc.join(".")} - ${e.msg}`).join("; ");return i.Z.json({detail:"資料驗證失敗，請檢查所有欄位",validationErrors:t,message:e.message,rawErrors:e.response.data.detail,debugInfo:{status:e.response.status,url:e.config?.url,method:e.config?.method,requestData:e.config?.data}},{status:e.response.status})}return i.Z.json({detail:e.response.data?.detail||"請求處理失敗",message:e.message,debugInfo:{status:e.response.status,url:e.config?.url,method:e.config?.method,requestData:e.config?.data}},{status:e.response.status})}if(e.request)return console.error("未收到回應的請求:",e.request),i.Z.json({detail:"無法連接到後端服務器",message:e.message,debugInfo:{isConnectionError:!0,url:e.config?.url,method:e.config?.method}},{status:503});return console.error("其他錯誤:",e.message),i.Z.json({detail:"請求處理失敗",message:e.message},{status:500})}}async function c(e){try{console.log("開始處理 /api/v1/appointments 的 GET 請求");let{searchParams:t}=new URL(e.url),o={};t.forEach((e,t)=>{o[t]=e});let s=(0,p.l9)("/appointments/");console.log("代理GET請求到:",s);let r={};e.headers.forEach((e,t)=>{"host"!==t&&(r[t]=e)}),r.Accept="application/json",console.log("請求頭:",r);let n=await l.Z.get(s,{params:o,headers:r,timeout:1e4});return console.log("後端回應狀態:",n.status),console.log("後端回應數據長度:",n.data?.length||"無數據"),i.Z.json(n.data,{status:n.status})}catch(r){console.error("代理GET請求錯誤詳細信息:",r);let t="未知錯誤",o=r.message||"未知錯誤信息",s=500;return r.response?(s=r.response.status,t=r.response.data?.detail||"請求處理失敗",console.error("錯誤狀態碼:",s),console.error("錯誤數據:",r.response.data),console.error("請求配置:",{url:r.config?.url,method:r.config?.method,params:r.config?.params})):r.request?(s=503,t="無法連接到後端服務器",console.error("未收到回應的請求:",r.request),console.error("請求URL:",r.config?.url)):(t="請求處理失敗",console.error("其他錯誤:",o),console.error("環境信息:",{NODE_ENV:"production",API_BASE_URL:"https://clinic.aspiratcm.com/api/v1"})),i.Z.json({detail:t,message:o,timestamp:new Date().toISOString(),debugInfo:{status:s,url:r.config?.url,method:r.config?.method,requestId:e.headers.get("x-request-id")||"unknown"}},{status:s})}}let d=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/v1/appointments/route",pathname:"/api/v1/appointments",filename:"route",bundlePath:"app/api/v1/appointments/route"},resolvedPagePath:"/Users/mountainfung/Desktop/AWS-Aspiratcm_local/frontend/src/app/api/v1/appointments/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:f,staticGenerationBailout:A}=d,P="/api/v1/appointments/route";function q(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},5638:(e,t,o)=>{function s(e=""){let t=process.env.API_BASE_URL;if(!t)throw console.error("\uD83D\uDD34 嚴重錯誤: 缺少基礎 API URL 環境變數"),Error("❌ 無法取得 API base URL，請確認 .env.production 已設置 API_BASE_URL 與 NEXT_PUBLIC_API_BASE_URL。");let o=`${t}${e.startsWith("/")?e:"/"+e}`;return console.log("\uD83E\uDDEA [Server] 使用 API_BASE_URL:",process.env.API_BASE_URL),o.startsWith("http:")&&(console.warn("⚠️ 警告: 發現不安全的 HTTP URL:",o),console.log("✅ 已修正為 HTTPS URL:",o=o.replace("http:","https:"))),o.startsWith("http")||o.startsWith("/")||(console.warn("⚠️ 警告: URL 缺少協議前綴:",o),console.log("✅ 已修正為完整 URL:",o="https://"+o)),o}o.d(t,{l9:()=>s});let r=o(3949).Z.create({baseURL:s(),headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3});r.interceptors.request.use(e=>{if(console.log(`[API請求] ${e.method?.toUpperCase()} ${e.url}`),e.params&&console.log(`[請求參數] ${JSON.stringify(e.params)}`),e.data&&"string"!=typeof e.data)try{console.log(`[請求數據] ${JSON.stringify(e.data)}`)}catch{console.log("[請求數據] 無法序列化")}return e},e=>(console.error("[API請求錯誤]",e),Promise.reject(e))),r.interceptors.response.use(e=>(console.log(`[API響應] ${e.status} ${e.config.url}`),e),e=>{let t=e?.response?.status,o=e?.config?.url,s=e?.config?.method?.toUpperCase();return t?console.error(`[${s} ${o}] 錯誤 ${t}`,e.response.data):console.error("[API錯誤]",e.message),Promise.reject(e)})}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),s=t.X(0,[638,823],()=>o(9825));module.exports=s})();